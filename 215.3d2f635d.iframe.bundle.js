/*! For license information please see 215.3d2f635d.iframe.bundle.js.LICENSE.txt */
(self.webpackChunkremark_slate_transformer=self.webpackChunkremark_slate_transformer||[]).push([[215],{"./node_modules/esrever/esrever.js":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;module=__webpack_require__.nmd(module),function(root){var freeExports=exports,freeGlobal=(module&&module.exports,"object"==typeof __webpack_require__.g&&__webpack_require__.g);freeGlobal.global!==freeGlobal&&freeGlobal.window;var regexSymbolWithCombiningMarks=/([\0-\u02FF\u0370-\u1AAF\u1B00-\u1DBF\u1E00-\u20CF\u2100-\uD7FF\uE000-\uFE1F\uFE30-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])([\u0300-\u036F\u1AB0-\u1AFF\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]+)/g,regexSurrogatePair=/([\uD800-\uDBFF])([\uDC00-\uDFFF])/g,reverse=function(string){for(var result="",index=(string=string.replace(regexSymbolWithCombiningMarks,(function($0,$1,$2){return reverse($2)+$1})).replace(regexSurrogatePair,"$2$1")).length;index--;)result+=string.charAt(index);return result},esrever={version:"0.2.0",reverse};void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return esrever}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},"./node_modules/immutable/dist/immutable.js":function(module){module.exports=function(){"use strict";var SLICE$0=Array.prototype.slice;function createClass(ctor,superClass){superClass&&(ctor.prototype=Object.create(superClass.prototype)),ctor.prototype.constructor=ctor}function Iterable(value){return isIterable(value)?value:Seq(value)}function KeyedIterable(value){return isKeyed(value)?value:KeyedSeq(value)}function IndexedIterable(value){return isIndexed(value)?value:IndexedSeq(value)}function SetIterable(value){return isIterable(value)&&!isAssociative(value)?value:SetSeq(value)}function isIterable(maybeIterable){return!(!maybeIterable||!maybeIterable[IS_ITERABLE_SENTINEL])}function isKeyed(maybeKeyed){return!(!maybeKeyed||!maybeKeyed[IS_KEYED_SENTINEL])}function isIndexed(maybeIndexed){return!(!maybeIndexed||!maybeIndexed[IS_INDEXED_SENTINEL])}function isAssociative(maybeAssociative){return isKeyed(maybeAssociative)||isIndexed(maybeAssociative)}function isOrdered(maybeOrdered){return!(!maybeOrdered||!maybeOrdered[IS_ORDERED_SENTINEL])}createClass(KeyedIterable,Iterable),createClass(IndexedIterable,Iterable),createClass(SetIterable,Iterable),Iterable.isIterable=isIterable,Iterable.isKeyed=isKeyed,Iterable.isIndexed=isIndexed,Iterable.isAssociative=isAssociative,Iterable.isOrdered=isOrdered,Iterable.Keyed=KeyedIterable,Iterable.Indexed=IndexedIterable,Iterable.Set=SetIterable;var IS_ITERABLE_SENTINEL="@@__IMMUTABLE_ITERABLE__@@",IS_KEYED_SENTINEL="@@__IMMUTABLE_KEYED__@@",IS_INDEXED_SENTINEL="@@__IMMUTABLE_INDEXED__@@",IS_ORDERED_SENTINEL="@@__IMMUTABLE_ORDERED__@@",DELETE="delete",SHIFT=5,SIZE=1<<SHIFT,MASK=SIZE-1,NOT_SET={},CHANGE_LENGTH={value:!1},DID_ALTER={value:!1};function MakeRef(ref){return ref.value=!1,ref}function SetRef(ref){ref&&(ref.value=!0)}function OwnerID(){}function arrCopy(arr,offset){offset=offset||0;for(var len=Math.max(0,arr.length-offset),newArr=new Array(len),ii=0;ii<len;ii++)newArr[ii]=arr[ii+offset];return newArr}function ensureSize(iter){return void 0===iter.size&&(iter.size=iter.__iterate(returnTrue)),iter.size}function wrapIndex(iter,index){if("number"!=typeof index){var uint32Index=index>>>0;if(""+uint32Index!==index||4294967295===uint32Index)return NaN;index=uint32Index}return index<0?ensureSize(iter)+index:index}function returnTrue(){return!0}function wholeSlice(begin,end,size){return(0===begin||void 0!==size&&begin<=-size)&&(void 0===end||void 0!==size&&end>=size)}function resolveBegin(begin,size){return resolveIndex(begin,size,0)}function resolveEnd(end,size){return resolveIndex(end,size,size)}function resolveIndex(index,size,defaultIndex){return void 0===index?defaultIndex:index<0?Math.max(0,size+index):void 0===size?index:Math.min(size,index)}var ITERATE_KEYS=0,ITERATE_VALUES=1,ITERATE_ENTRIES=2,REAL_ITERATOR_SYMBOL="function"==typeof Symbol&&Symbol.iterator,FAUX_ITERATOR_SYMBOL="@@iterator",ITERATOR_SYMBOL=REAL_ITERATOR_SYMBOL||FAUX_ITERATOR_SYMBOL;function Iterator(next){this.next=next}function iteratorValue(type,k,v,iteratorResult){var value=0===type?k:1===type?v:[k,v];return iteratorResult?iteratorResult.value=value:iteratorResult={value,done:!1},iteratorResult}function iteratorDone(){return{value:void 0,done:!0}}function hasIterator(maybeIterable){return!!getIteratorFn(maybeIterable)}function isIterator(maybeIterator){return maybeIterator&&"function"==typeof maybeIterator.next}function getIterator(iterable){var iteratorFn=getIteratorFn(iterable);return iteratorFn&&iteratorFn.call(iterable)}function getIteratorFn(iterable){var iteratorFn=iterable&&(REAL_ITERATOR_SYMBOL&&iterable[REAL_ITERATOR_SYMBOL]||iterable[FAUX_ITERATOR_SYMBOL]);if("function"==typeof iteratorFn)return iteratorFn}function isArrayLike(value){return value&&"number"==typeof value.length}function Seq(value){return null==value?emptySequence():isIterable(value)?value.toSeq():seqFromValue(value)}function KeyedSeq(value){return null==value?emptySequence().toKeyedSeq():isIterable(value)?isKeyed(value)?value.toSeq():value.fromEntrySeq():keyedSeqFromValue(value)}function IndexedSeq(value){return null==value?emptySequence():isIterable(value)?isKeyed(value)?value.entrySeq():value.toIndexedSeq():indexedSeqFromValue(value)}function SetSeq(value){return(null==value?emptySequence():isIterable(value)?isKeyed(value)?value.entrySeq():value:indexedSeqFromValue(value)).toSetSeq()}Iterator.prototype.toString=function(){return"[Iterator]"},Iterator.KEYS=ITERATE_KEYS,Iterator.VALUES=ITERATE_VALUES,Iterator.ENTRIES=ITERATE_ENTRIES,Iterator.prototype.inspect=Iterator.prototype.toSource=function(){return this.toString()},Iterator.prototype[ITERATOR_SYMBOL]=function(){return this},createClass(Seq,Iterable),Seq.of=function(){return Seq(arguments)},Seq.prototype.toSeq=function(){return this},Seq.prototype.toString=function(){return this.__toString("Seq {","}")},Seq.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},Seq.prototype.__iterate=function(fn,reverse){return seqIterate(this,fn,reverse,!0)},Seq.prototype.__iterator=function(type,reverse){return seqIterator(this,type,reverse,!0)},createClass(KeyedSeq,Seq),KeyedSeq.prototype.toKeyedSeq=function(){return this},createClass(IndexedSeq,Seq),IndexedSeq.of=function(){return IndexedSeq(arguments)},IndexedSeq.prototype.toIndexedSeq=function(){return this},IndexedSeq.prototype.toString=function(){return this.__toString("Seq [","]")},IndexedSeq.prototype.__iterate=function(fn,reverse){return seqIterate(this,fn,reverse,!1)},IndexedSeq.prototype.__iterator=function(type,reverse){return seqIterator(this,type,reverse,!1)},createClass(SetSeq,Seq),SetSeq.of=function(){return SetSeq(arguments)},SetSeq.prototype.toSetSeq=function(){return this},Seq.isSeq=isSeq,Seq.Keyed=KeyedSeq,Seq.Set=SetSeq,Seq.Indexed=IndexedSeq;var EMPTY_SEQ,EMPTY_REPEAT,EMPTY_RANGE,IS_SEQ_SENTINEL="@@__IMMUTABLE_SEQ__@@";function ArraySeq(array){this._array=array,this.size=array.length}function ObjectSeq(object){var keys=Object.keys(object);this._object=object,this._keys=keys,this.size=keys.length}function IterableSeq(iterable){this._iterable=iterable,this.size=iterable.length||iterable.size}function IteratorSeq(iterator){this._iterator=iterator,this._iteratorCache=[]}function isSeq(maybeSeq){return!(!maybeSeq||!maybeSeq[IS_SEQ_SENTINEL])}function emptySequence(){return EMPTY_SEQ||(EMPTY_SEQ=new ArraySeq([]))}function keyedSeqFromValue(value){var seq=Array.isArray(value)?new ArraySeq(value).fromEntrySeq():isIterator(value)?new IteratorSeq(value).fromEntrySeq():hasIterator(value)?new IterableSeq(value).fromEntrySeq():"object"==typeof value?new ObjectSeq(value):void 0;if(!seq)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+value);return seq}function indexedSeqFromValue(value){var seq=maybeIndexedSeqFromValue(value);if(!seq)throw new TypeError("Expected Array or iterable object of values: "+value);return seq}function seqFromValue(value){var seq=maybeIndexedSeqFromValue(value)||"object"==typeof value&&new ObjectSeq(value);if(!seq)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+value);return seq}function maybeIndexedSeqFromValue(value){return isArrayLike(value)?new ArraySeq(value):isIterator(value)?new IteratorSeq(value):hasIterator(value)?new IterableSeq(value):void 0}function seqIterate(seq,fn,reverse,useKeys){var cache=seq._cache;if(cache){for(var maxIndex=cache.length-1,ii=0;ii<=maxIndex;ii++){var entry=cache[reverse?maxIndex-ii:ii];if(!1===fn(entry[1],useKeys?entry[0]:ii,seq))return ii+1}return ii}return seq.__iterateUncached(fn,reverse)}function seqIterator(seq,type,reverse,useKeys){var cache=seq._cache;if(cache){var maxIndex=cache.length-1,ii=0;return new Iterator((function(){var entry=cache[reverse?maxIndex-ii:ii];return ii++>maxIndex?iteratorDone():iteratorValue(type,useKeys?entry[0]:ii-1,entry[1])}))}return seq.__iteratorUncached(type,reverse)}function fromJS(json,converter){return converter?fromJSWith(converter,json,"",{"":json}):fromJSDefault(json)}function fromJSWith(converter,json,key,parentJSON){return Array.isArray(json)?converter.call(parentJSON,key,IndexedSeq(json).map((function(v,k){return fromJSWith(converter,v,k,json)}))):isPlainObj(json)?converter.call(parentJSON,key,KeyedSeq(json).map((function(v,k){return fromJSWith(converter,v,k,json)}))):json}function fromJSDefault(json){return Array.isArray(json)?IndexedSeq(json).map(fromJSDefault).toList():isPlainObj(json)?KeyedSeq(json).map(fromJSDefault).toMap():json}function isPlainObj(value){return value&&(value.constructor===Object||void 0===value.constructor)}function is(valueA,valueB){if(valueA===valueB||valueA!=valueA&&valueB!=valueB)return!0;if(!valueA||!valueB)return!1;if("function"==typeof valueA.valueOf&&"function"==typeof valueB.valueOf){if((valueA=valueA.valueOf())===(valueB=valueB.valueOf())||valueA!=valueA&&valueB!=valueB)return!0;if(!valueA||!valueB)return!1}return!("function"!=typeof valueA.equals||"function"!=typeof valueB.equals||!valueA.equals(valueB))}function deepEqual(a,b){if(a===b)return!0;if(!isIterable(b)||void 0!==a.size&&void 0!==b.size&&a.size!==b.size||void 0!==a.__hash&&void 0!==b.__hash&&a.__hash!==b.__hash||isKeyed(a)!==isKeyed(b)||isIndexed(a)!==isIndexed(b)||isOrdered(a)!==isOrdered(b))return!1;if(0===a.size&&0===b.size)return!0;var notAssociative=!isAssociative(a);if(isOrdered(a)){var entries=a.entries();return b.every((function(v,k){var entry=entries.next().value;return entry&&is(entry[1],v)&&(notAssociative||is(entry[0],k))}))&&entries.next().done}var flipped=!1;if(void 0===a.size)if(void 0===b.size)"function"==typeof a.cacheResult&&a.cacheResult();else{flipped=!0;var _=a;a=b,b=_}var allEqual=!0,bSize=b.__iterate((function(v,k){if(notAssociative?!a.has(v):flipped?!is(v,a.get(k,NOT_SET)):!is(a.get(k,NOT_SET),v))return allEqual=!1,!1}));return allEqual&&a.size===bSize}function Repeat(value,times){if(!(this instanceof Repeat))return new Repeat(value,times);if(this._value=value,this.size=void 0===times?1/0:Math.max(0,times),0===this.size){if(EMPTY_REPEAT)return EMPTY_REPEAT;EMPTY_REPEAT=this}}function invariant(condition,error){if(!condition)throw new Error(error)}function Range(start,end,step){if(!(this instanceof Range))return new Range(start,end,step);if(invariant(0!==step,"Cannot step a Range by 0"),start=start||0,void 0===end&&(end=1/0),step=void 0===step?1:Math.abs(step),end<start&&(step=-step),this._start=start,this._end=end,this._step=step,this.size=Math.max(0,Math.ceil((end-start)/step-1)+1),0===this.size){if(EMPTY_RANGE)return EMPTY_RANGE;EMPTY_RANGE=this}}function Collection(){throw TypeError("Abstract")}function KeyedCollection(){}function IndexedCollection(){}function SetCollection(){}Seq.prototype[IS_SEQ_SENTINEL]=!0,createClass(ArraySeq,IndexedSeq),ArraySeq.prototype.get=function(index,notSetValue){return this.has(index)?this._array[wrapIndex(this,index)]:notSetValue},ArraySeq.prototype.__iterate=function(fn,reverse){for(var array=this._array,maxIndex=array.length-1,ii=0;ii<=maxIndex;ii++)if(!1===fn(array[reverse?maxIndex-ii:ii],ii,this))return ii+1;return ii},ArraySeq.prototype.__iterator=function(type,reverse){var array=this._array,maxIndex=array.length-1,ii=0;return new Iterator((function(){return ii>maxIndex?iteratorDone():iteratorValue(type,ii,array[reverse?maxIndex-ii++:ii++])}))},createClass(ObjectSeq,KeyedSeq),ObjectSeq.prototype.get=function(key,notSetValue){return void 0===notSetValue||this.has(key)?this._object[key]:notSetValue},ObjectSeq.prototype.has=function(key){return this._object.hasOwnProperty(key)},ObjectSeq.prototype.__iterate=function(fn,reverse){for(var object=this._object,keys=this._keys,maxIndex=keys.length-1,ii=0;ii<=maxIndex;ii++){var key=keys[reverse?maxIndex-ii:ii];if(!1===fn(object[key],key,this))return ii+1}return ii},ObjectSeq.prototype.__iterator=function(type,reverse){var object=this._object,keys=this._keys,maxIndex=keys.length-1,ii=0;return new Iterator((function(){var key=keys[reverse?maxIndex-ii:ii];return ii++>maxIndex?iteratorDone():iteratorValue(type,key,object[key])}))},ObjectSeq.prototype[IS_ORDERED_SENTINEL]=!0,createClass(IterableSeq,IndexedSeq),IterableSeq.prototype.__iterateUncached=function(fn,reverse){if(reverse)return this.cacheResult().__iterate(fn,reverse);var iterator=getIterator(this._iterable),iterations=0;if(isIterator(iterator))for(var step;!(step=iterator.next()).done&&!1!==fn(step.value,iterations++,this););return iterations},IterableSeq.prototype.__iteratorUncached=function(type,reverse){if(reverse)return this.cacheResult().__iterator(type,reverse);var iterator=getIterator(this._iterable);if(!isIterator(iterator))return new Iterator(iteratorDone);var iterations=0;return new Iterator((function(){var step=iterator.next();return step.done?step:iteratorValue(type,iterations++,step.value)}))},createClass(IteratorSeq,IndexedSeq),IteratorSeq.prototype.__iterateUncached=function(fn,reverse){if(reverse)return this.cacheResult().__iterate(fn,reverse);for(var step,iterator=this._iterator,cache=this._iteratorCache,iterations=0;iterations<cache.length;)if(!1===fn(cache[iterations],iterations++,this))return iterations;for(;!(step=iterator.next()).done;){var val=step.value;if(cache[iterations]=val,!1===fn(val,iterations++,this))break}return iterations},IteratorSeq.prototype.__iteratorUncached=function(type,reverse){if(reverse)return this.cacheResult().__iterator(type,reverse);var iterator=this._iterator,cache=this._iteratorCache,iterations=0;return new Iterator((function(){if(iterations>=cache.length){var step=iterator.next();if(step.done)return step;cache[iterations]=step.value}return iteratorValue(type,iterations,cache[iterations++])}))},createClass(Repeat,IndexedSeq),Repeat.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},Repeat.prototype.get=function(index,notSetValue){return this.has(index)?this._value:notSetValue},Repeat.prototype.includes=function(searchValue){return is(this._value,searchValue)},Repeat.prototype.slice=function(begin,end){var size=this.size;return wholeSlice(begin,end,size)?this:new Repeat(this._value,resolveEnd(end,size)-resolveBegin(begin,size))},Repeat.prototype.reverse=function(){return this},Repeat.prototype.indexOf=function(searchValue){return is(this._value,searchValue)?0:-1},Repeat.prototype.lastIndexOf=function(searchValue){return is(this._value,searchValue)?this.size:-1},Repeat.prototype.__iterate=function(fn,reverse){for(var ii=0;ii<this.size;ii++)if(!1===fn(this._value,ii,this))return ii+1;return ii},Repeat.prototype.__iterator=function(type,reverse){var this$0=this,ii=0;return new Iterator((function(){return ii<this$0.size?iteratorValue(type,ii++,this$0._value):iteratorDone()}))},Repeat.prototype.equals=function(other){return other instanceof Repeat?is(this._value,other._value):deepEqual(other)},createClass(Range,IndexedSeq),Range.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},Range.prototype.get=function(index,notSetValue){return this.has(index)?this._start+wrapIndex(this,index)*this._step:notSetValue},Range.prototype.includes=function(searchValue){var possibleIndex=(searchValue-this._start)/this._step;return possibleIndex>=0&&possibleIndex<this.size&&possibleIndex===Math.floor(possibleIndex)},Range.prototype.slice=function(begin,end){return wholeSlice(begin,end,this.size)?this:(begin=resolveBegin(begin,this.size),(end=resolveEnd(end,this.size))<=begin?new Range(0,0):new Range(this.get(begin,this._end),this.get(end,this._end),this._step))},Range.prototype.indexOf=function(searchValue){var offsetValue=searchValue-this._start;if(offsetValue%this._step==0){var index=offsetValue/this._step;if(index>=0&&index<this.size)return index}return-1},Range.prototype.lastIndexOf=function(searchValue){return this.indexOf(searchValue)},Range.prototype.__iterate=function(fn,reverse){for(var maxIndex=this.size-1,step=this._step,value=reverse?this._start+maxIndex*step:this._start,ii=0;ii<=maxIndex;ii++){if(!1===fn(value,ii,this))return ii+1;value+=reverse?-step:step}return ii},Range.prototype.__iterator=function(type,reverse){var maxIndex=this.size-1,step=this._step,value=reverse?this._start+maxIndex*step:this._start,ii=0;return new Iterator((function(){var v=value;return value+=reverse?-step:step,ii>maxIndex?iteratorDone():iteratorValue(type,ii++,v)}))},Range.prototype.equals=function(other){return other instanceof Range?this._start===other._start&&this._end===other._end&&this._step===other._step:deepEqual(this,other)},createClass(Collection,Iterable),createClass(KeyedCollection,Collection),createClass(IndexedCollection,Collection),createClass(SetCollection,Collection),Collection.Keyed=KeyedCollection,Collection.Indexed=IndexedCollection,Collection.Set=SetCollection;var imul="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function imul(a,b){var c=65535&(a|=0),d=65535&(b|=0);return c*d+((a>>>16)*d+c*(b>>>16)<<16>>>0)|0};function smi(i32){return i32>>>1&1073741824|3221225471&i32}function hash(o){if(!1===o||null==o)return 0;if("function"==typeof o.valueOf&&(!1===(o=o.valueOf())||null==o))return 0;if(!0===o)return 1;var type=typeof o;if("number"===type){if(o!=o||o===1/0)return 0;var h=0|o;for(h!==o&&(h^=4294967295*o);o>4294967295;)h^=o/=4294967295;return smi(h)}if("string"===type)return o.length>STRING_HASH_CACHE_MIN_STRLEN?cachedHashString(o):hashString(o);if("function"==typeof o.hashCode)return o.hashCode();if("object"===type)return hashJSObj(o);if("function"==typeof o.toString)return hashString(o.toString());throw new Error("Value type "+type+" cannot be hashed.")}function cachedHashString(string){var hash=stringHashCache[string];return void 0===hash&&(hash=hashString(string),STRING_HASH_CACHE_SIZE===STRING_HASH_CACHE_MAX_SIZE&&(STRING_HASH_CACHE_SIZE=0,stringHashCache={}),STRING_HASH_CACHE_SIZE++,stringHashCache[string]=hash),hash}function hashString(string){for(var hash=0,ii=0;ii<string.length;ii++)hash=31*hash+string.charCodeAt(ii)|0;return smi(hash)}function hashJSObj(obj){var hash;if(usingWeakMap&&void 0!==(hash=weakMap.get(obj)))return hash;if(void 0!==(hash=obj[UID_HASH_KEY]))return hash;if(!canDefineProperty){if(void 0!==(hash=obj.propertyIsEnumerable&&obj.propertyIsEnumerable[UID_HASH_KEY]))return hash;if(void 0!==(hash=getIENodeHash(obj)))return hash}if(hash=++objHashUID,1073741824&objHashUID&&(objHashUID=0),usingWeakMap)weakMap.set(obj,hash);else{if(void 0!==isExtensible&&!1===isExtensible(obj))throw new Error("Non-extensible objects are not allowed as keys.");if(canDefineProperty)Object.defineProperty(obj,UID_HASH_KEY,{enumerable:!1,configurable:!1,writable:!1,value:hash});else if(void 0!==obj.propertyIsEnumerable&&obj.propertyIsEnumerable===obj.constructor.prototype.propertyIsEnumerable)obj.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},obj.propertyIsEnumerable[UID_HASH_KEY]=hash;else{if(void 0===obj.nodeType)throw new Error("Unable to set a non-enumerable property on object.");obj[UID_HASH_KEY]=hash}}return hash}var isExtensible=Object.isExtensible,canDefineProperty=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}();function getIENodeHash(node){if(node&&node.nodeType>0)switch(node.nodeType){case 1:return node.uniqueID;case 9:return node.documentElement&&node.documentElement.uniqueID}}var weakMap,usingWeakMap="function"==typeof WeakMap;usingWeakMap&&(weakMap=new WeakMap);var objHashUID=0,UID_HASH_KEY="__immutablehash__";"function"==typeof Symbol&&(UID_HASH_KEY=Symbol(UID_HASH_KEY));var STRING_HASH_CACHE_MIN_STRLEN=16,STRING_HASH_CACHE_MAX_SIZE=255,STRING_HASH_CACHE_SIZE=0,stringHashCache={};function assertNotInfinite(size){invariant(size!==1/0,"Cannot perform this action with an infinite size.")}function Map(value){return null==value?emptyMap():isMap(value)&&!isOrdered(value)?value:emptyMap().withMutations((function(map){var iter=KeyedIterable(value);assertNotInfinite(iter.size),iter.forEach((function(v,k){return map.set(k,v)}))}))}function isMap(maybeMap){return!(!maybeMap||!maybeMap[IS_MAP_SENTINEL])}createClass(Map,KeyedCollection),Map.of=function(){var keyValues=SLICE$0.call(arguments,0);return emptyMap().withMutations((function(map){for(var i=0;i<keyValues.length;i+=2){if(i+1>=keyValues.length)throw new Error("Missing value for key: "+keyValues[i]);map.set(keyValues[i],keyValues[i+1])}}))},Map.prototype.toString=function(){return this.__toString("Map {","}")},Map.prototype.get=function(k,notSetValue){return this._root?this._root.get(0,void 0,k,notSetValue):notSetValue},Map.prototype.set=function(k,v){return updateMap(this,k,v)},Map.prototype.setIn=function(keyPath,v){return this.updateIn(keyPath,NOT_SET,(function(){return v}))},Map.prototype.remove=function(k){return updateMap(this,k,NOT_SET)},Map.prototype.deleteIn=function(keyPath){return this.updateIn(keyPath,(function(){return NOT_SET}))},Map.prototype.update=function(k,notSetValue,updater){return 1===arguments.length?k(this):this.updateIn([k],notSetValue,updater)},Map.prototype.updateIn=function(keyPath,notSetValue,updater){updater||(updater=notSetValue,notSetValue=void 0);var updatedValue=updateInDeepMap(this,forceIterator(keyPath),notSetValue,updater);return updatedValue===NOT_SET?void 0:updatedValue},Map.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):emptyMap()},Map.prototype.merge=function(){return mergeIntoMapWith(this,void 0,arguments)},Map.prototype.mergeWith=function(merger){return mergeIntoMapWith(this,merger,SLICE$0.call(arguments,1))},Map.prototype.mergeIn=function(keyPath){var iters=SLICE$0.call(arguments,1);return this.updateIn(keyPath,emptyMap(),(function(m){return"function"==typeof m.merge?m.merge.apply(m,iters):iters[iters.length-1]}))},Map.prototype.mergeDeep=function(){return mergeIntoMapWith(this,deepMerger,arguments)},Map.prototype.mergeDeepWith=function(merger){var iters=SLICE$0.call(arguments,1);return mergeIntoMapWith(this,deepMergerWith(merger),iters)},Map.prototype.mergeDeepIn=function(keyPath){var iters=SLICE$0.call(arguments,1);return this.updateIn(keyPath,emptyMap(),(function(m){return"function"==typeof m.mergeDeep?m.mergeDeep.apply(m,iters):iters[iters.length-1]}))},Map.prototype.sort=function(comparator){return OrderedMap(sortFactory(this,comparator))},Map.prototype.sortBy=function(mapper,comparator){return OrderedMap(sortFactory(this,comparator,mapper))},Map.prototype.withMutations=function(fn){var mutable=this.asMutable();return fn(mutable),mutable.wasAltered()?mutable.__ensureOwner(this.__ownerID):this},Map.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new OwnerID)},Map.prototype.asImmutable=function(){return this.__ensureOwner()},Map.prototype.wasAltered=function(){return this.__altered},Map.prototype.__iterator=function(type,reverse){return new MapIterator(this,type,reverse)},Map.prototype.__iterate=function(fn,reverse){var this$0=this,iterations=0;return this._root&&this._root.iterate((function(entry){return iterations++,fn(entry[1],entry[0],this$0)}),reverse),iterations},Map.prototype.__ensureOwner=function(ownerID){return ownerID===this.__ownerID?this:ownerID?makeMap(this.size,this._root,ownerID,this.__hash):(this.__ownerID=ownerID,this.__altered=!1,this)},Map.isMap=isMap;var EMPTY_MAP,IS_MAP_SENTINEL="@@__IMMUTABLE_MAP__@@",MapPrototype=Map.prototype;function ArrayMapNode(ownerID,entries){this.ownerID=ownerID,this.entries=entries}function BitmapIndexedNode(ownerID,bitmap,nodes){this.ownerID=ownerID,this.bitmap=bitmap,this.nodes=nodes}function HashArrayMapNode(ownerID,count,nodes){this.ownerID=ownerID,this.count=count,this.nodes=nodes}function HashCollisionNode(ownerID,keyHash,entries){this.ownerID=ownerID,this.keyHash=keyHash,this.entries=entries}function ValueNode(ownerID,keyHash,entry){this.ownerID=ownerID,this.keyHash=keyHash,this.entry=entry}function MapIterator(map,type,reverse){this._type=type,this._reverse=reverse,this._stack=map._root&&mapIteratorFrame(map._root)}function mapIteratorValue(type,entry){return iteratorValue(type,entry[0],entry[1])}function mapIteratorFrame(node,prev){return{node,index:0,__prev:prev}}function makeMap(size,root,ownerID,hash){var map=Object.create(MapPrototype);return map.size=size,map._root=root,map.__ownerID=ownerID,map.__hash=hash,map.__altered=!1,map}function emptyMap(){return EMPTY_MAP||(EMPTY_MAP=makeMap(0))}function updateMap(map,k,v){var newRoot,newSize;if(map._root){var didChangeSize=MakeRef(CHANGE_LENGTH),didAlter=MakeRef(DID_ALTER);if(newRoot=updateNode(map._root,map.__ownerID,0,void 0,k,v,didChangeSize,didAlter),!didAlter.value)return map;newSize=map.size+(didChangeSize.value?v===NOT_SET?-1:1:0)}else{if(v===NOT_SET)return map;newSize=1,newRoot=new ArrayMapNode(map.__ownerID,[[k,v]])}return map.__ownerID?(map.size=newSize,map._root=newRoot,map.__hash=void 0,map.__altered=!0,map):newRoot?makeMap(newSize,newRoot):emptyMap()}function updateNode(node,ownerID,shift,keyHash,key,value,didChangeSize,didAlter){return node?node.update(ownerID,shift,keyHash,key,value,didChangeSize,didAlter):value===NOT_SET?node:(SetRef(didAlter),SetRef(didChangeSize),new ValueNode(ownerID,keyHash,[key,value]))}function isLeafNode(node){return node.constructor===ValueNode||node.constructor===HashCollisionNode}function mergeIntoNode(node,ownerID,shift,keyHash,entry){if(node.keyHash===keyHash)return new HashCollisionNode(ownerID,keyHash,[node.entry,entry]);var newNode,idx1=(0===shift?node.keyHash:node.keyHash>>>shift)&MASK,idx2=(0===shift?keyHash:keyHash>>>shift)&MASK;return new BitmapIndexedNode(ownerID,1<<idx1|1<<idx2,idx1===idx2?[mergeIntoNode(node,ownerID,shift+SHIFT,keyHash,entry)]:(newNode=new ValueNode(ownerID,keyHash,entry),idx1<idx2?[node,newNode]:[newNode,node]))}function createNodes(ownerID,entries,key,value){ownerID||(ownerID=new OwnerID);for(var node=new ValueNode(ownerID,hash(key),[key,value]),ii=0;ii<entries.length;ii++){var entry=entries[ii];node=node.update(ownerID,0,void 0,entry[0],entry[1])}return node}function packNodes(ownerID,nodes,count,excluding){for(var bitmap=0,packedII=0,packedNodes=new Array(count),ii=0,bit=1,len=nodes.length;ii<len;ii++,bit<<=1){var node=nodes[ii];void 0!==node&&ii!==excluding&&(bitmap|=bit,packedNodes[packedII++]=node)}return new BitmapIndexedNode(ownerID,bitmap,packedNodes)}function expandNodes(ownerID,nodes,bitmap,including,node){for(var count=0,expandedNodes=new Array(SIZE),ii=0;0!==bitmap;ii++,bitmap>>>=1)expandedNodes[ii]=1&bitmap?nodes[count++]:void 0;return expandedNodes[including]=node,new HashArrayMapNode(ownerID,count+1,expandedNodes)}function mergeIntoMapWith(map,merger,iterables){for(var iters=[],ii=0;ii<iterables.length;ii++){var value=iterables[ii],iter=KeyedIterable(value);isIterable(value)||(iter=iter.map((function(v){return fromJS(v)}))),iters.push(iter)}return mergeIntoCollectionWith(map,merger,iters)}function deepMerger(existing,value,key){return existing&&existing.mergeDeep&&isIterable(value)?existing.mergeDeep(value):is(existing,value)?existing:value}function deepMergerWith(merger){return function(existing,value,key){if(existing&&existing.mergeDeepWith&&isIterable(value))return existing.mergeDeepWith(merger,value);var nextValue=merger(existing,value,key);return is(existing,nextValue)?existing:nextValue}}function mergeIntoCollectionWith(collection,merger,iters){return 0===(iters=iters.filter((function(x){return 0!==x.size}))).length?collection:0!==collection.size||collection.__ownerID||1!==iters.length?collection.withMutations((function(collection){for(var mergeIntoMap=merger?function(value,key){collection.update(key,NOT_SET,(function(existing){return existing===NOT_SET?value:merger(existing,value,key)}))}:function(value,key){collection.set(key,value)},ii=0;ii<iters.length;ii++)iters[ii].forEach(mergeIntoMap)})):collection.constructor(iters[0])}function updateInDeepMap(existing,keyPathIter,notSetValue,updater){var isNotSet=existing===NOT_SET,step=keyPathIter.next();if(step.done){var existingValue=isNotSet?notSetValue:existing,newValue=updater(existingValue);return newValue===existingValue?existing:newValue}invariant(isNotSet||existing&&existing.set,"invalid keyPath");var key=step.value,nextExisting=isNotSet?NOT_SET:existing.get(key,NOT_SET),nextUpdated=updateInDeepMap(nextExisting,keyPathIter,notSetValue,updater);return nextUpdated===nextExisting?existing:nextUpdated===NOT_SET?existing.remove(key):(isNotSet?emptyMap():existing).set(key,nextUpdated)}function popCount(x){return x=(x=(858993459&(x-=x>>1&1431655765))+(x>>2&858993459))+(x>>4)&252645135,x+=x>>8,127&(x+=x>>16)}function setIn(array,idx,val,canEdit){var newArray=canEdit?array:arrCopy(array);return newArray[idx]=val,newArray}function spliceIn(array,idx,val,canEdit){var newLen=array.length+1;if(canEdit&&idx+1===newLen)return array[idx]=val,array;for(var newArray=new Array(newLen),after=0,ii=0;ii<newLen;ii++)ii===idx?(newArray[ii]=val,after=-1):newArray[ii]=array[ii+after];return newArray}function spliceOut(array,idx,canEdit){var newLen=array.length-1;if(canEdit&&idx===newLen)return array.pop(),array;for(var newArray=new Array(newLen),after=0,ii=0;ii<newLen;ii++)ii===idx&&(after=1),newArray[ii]=array[ii+after];return newArray}MapPrototype[IS_MAP_SENTINEL]=!0,MapPrototype[DELETE]=MapPrototype.remove,MapPrototype.removeIn=MapPrototype.deleteIn,ArrayMapNode.prototype.get=function(shift,keyHash,key,notSetValue){for(var entries=this.entries,ii=0,len=entries.length;ii<len;ii++)if(is(key,entries[ii][0]))return entries[ii][1];return notSetValue},ArrayMapNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){for(var removed=value===NOT_SET,entries=this.entries,idx=0,len=entries.length;idx<len&&!is(key,entries[idx][0]);idx++);var exists=idx<len;if(exists?entries[idx][1]===value:removed)return this;if(SetRef(didAlter),(removed||!exists)&&SetRef(didChangeSize),!removed||1!==entries.length){if(!exists&&!removed&&entries.length>=MAX_ARRAY_MAP_SIZE)return createNodes(ownerID,entries,key,value);var isEditable=ownerID&&ownerID===this.ownerID,newEntries=isEditable?entries:arrCopy(entries);return exists?removed?idx===len-1?newEntries.pop():newEntries[idx]=newEntries.pop():newEntries[idx]=[key,value]:newEntries.push([key,value]),isEditable?(this.entries=newEntries,this):new ArrayMapNode(ownerID,newEntries)}},BitmapIndexedNode.prototype.get=function(shift,keyHash,key,notSetValue){void 0===keyHash&&(keyHash=hash(key));var bit=1<<((0===shift?keyHash:keyHash>>>shift)&MASK),bitmap=this.bitmap;return 0==(bitmap&bit)?notSetValue:this.nodes[popCount(bitmap&bit-1)].get(shift+SHIFT,keyHash,key,notSetValue)},BitmapIndexedNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){void 0===keyHash&&(keyHash=hash(key));var keyHashFrag=(0===shift?keyHash:keyHash>>>shift)&MASK,bit=1<<keyHashFrag,bitmap=this.bitmap,exists=0!=(bitmap&bit);if(!exists&&value===NOT_SET)return this;var idx=popCount(bitmap&bit-1),nodes=this.nodes,node=exists?nodes[idx]:void 0,newNode=updateNode(node,ownerID,shift+SHIFT,keyHash,key,value,didChangeSize,didAlter);if(newNode===node)return this;if(!exists&&newNode&&nodes.length>=MAX_BITMAP_INDEXED_SIZE)return expandNodes(ownerID,nodes,bitmap,keyHashFrag,newNode);if(exists&&!newNode&&2===nodes.length&&isLeafNode(nodes[1^idx]))return nodes[1^idx];if(exists&&newNode&&1===nodes.length&&isLeafNode(newNode))return newNode;var isEditable=ownerID&&ownerID===this.ownerID,newBitmap=exists?newNode?bitmap:bitmap^bit:bitmap|bit,newNodes=exists?newNode?setIn(nodes,idx,newNode,isEditable):spliceOut(nodes,idx,isEditable):spliceIn(nodes,idx,newNode,isEditable);return isEditable?(this.bitmap=newBitmap,this.nodes=newNodes,this):new BitmapIndexedNode(ownerID,newBitmap,newNodes)},HashArrayMapNode.prototype.get=function(shift,keyHash,key,notSetValue){void 0===keyHash&&(keyHash=hash(key));var idx=(0===shift?keyHash:keyHash>>>shift)&MASK,node=this.nodes[idx];return node?node.get(shift+SHIFT,keyHash,key,notSetValue):notSetValue},HashArrayMapNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){void 0===keyHash&&(keyHash=hash(key));var idx=(0===shift?keyHash:keyHash>>>shift)&MASK,removed=value===NOT_SET,nodes=this.nodes,node=nodes[idx];if(removed&&!node)return this;var newNode=updateNode(node,ownerID,shift+SHIFT,keyHash,key,value,didChangeSize,didAlter);if(newNode===node)return this;var newCount=this.count;if(node){if(!newNode&&--newCount<MIN_HASH_ARRAY_MAP_SIZE)return packNodes(ownerID,nodes,newCount,idx)}else newCount++;var isEditable=ownerID&&ownerID===this.ownerID,newNodes=setIn(nodes,idx,newNode,isEditable);return isEditable?(this.count=newCount,this.nodes=newNodes,this):new HashArrayMapNode(ownerID,newCount,newNodes)},HashCollisionNode.prototype.get=function(shift,keyHash,key,notSetValue){for(var entries=this.entries,ii=0,len=entries.length;ii<len;ii++)if(is(key,entries[ii][0]))return entries[ii][1];return notSetValue},HashCollisionNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){void 0===keyHash&&(keyHash=hash(key));var removed=value===NOT_SET;if(keyHash!==this.keyHash)return removed?this:(SetRef(didAlter),SetRef(didChangeSize),mergeIntoNode(this,ownerID,shift,keyHash,[key,value]));for(var entries=this.entries,idx=0,len=entries.length;idx<len&&!is(key,entries[idx][0]);idx++);var exists=idx<len;if(exists?entries[idx][1]===value:removed)return this;if(SetRef(didAlter),(removed||!exists)&&SetRef(didChangeSize),removed&&2===len)return new ValueNode(ownerID,this.keyHash,entries[1^idx]);var isEditable=ownerID&&ownerID===this.ownerID,newEntries=isEditable?entries:arrCopy(entries);return exists?removed?idx===len-1?newEntries.pop():newEntries[idx]=newEntries.pop():newEntries[idx]=[key,value]:newEntries.push([key,value]),isEditable?(this.entries=newEntries,this):new HashCollisionNode(ownerID,this.keyHash,newEntries)},ValueNode.prototype.get=function(shift,keyHash,key,notSetValue){return is(key,this.entry[0])?this.entry[1]:notSetValue},ValueNode.prototype.update=function(ownerID,shift,keyHash,key,value,didChangeSize,didAlter){var removed=value===NOT_SET,keyMatch=is(key,this.entry[0]);return(keyMatch?value===this.entry[1]:removed)?this:(SetRef(didAlter),removed?void SetRef(didChangeSize):keyMatch?ownerID&&ownerID===this.ownerID?(this.entry[1]=value,this):new ValueNode(ownerID,this.keyHash,[key,value]):(SetRef(didChangeSize),mergeIntoNode(this,ownerID,shift,hash(key),[key,value])))},ArrayMapNode.prototype.iterate=HashCollisionNode.prototype.iterate=function(fn,reverse){for(var entries=this.entries,ii=0,maxIndex=entries.length-1;ii<=maxIndex;ii++)if(!1===fn(entries[reverse?maxIndex-ii:ii]))return!1},BitmapIndexedNode.prototype.iterate=HashArrayMapNode.prototype.iterate=function(fn,reverse){for(var nodes=this.nodes,ii=0,maxIndex=nodes.length-1;ii<=maxIndex;ii++){var node=nodes[reverse?maxIndex-ii:ii];if(node&&!1===node.iterate(fn,reverse))return!1}},ValueNode.prototype.iterate=function(fn,reverse){return fn(this.entry)},createClass(MapIterator,Iterator),MapIterator.prototype.next=function(){for(var type=this._type,stack=this._stack;stack;){var maxIndex,node=stack.node,index=stack.index++;if(node.entry){if(0===index)return mapIteratorValue(type,node.entry)}else if(node.entries){if(index<=(maxIndex=node.entries.length-1))return mapIteratorValue(type,node.entries[this._reverse?maxIndex-index:index])}else if(index<=(maxIndex=node.nodes.length-1)){var subNode=node.nodes[this._reverse?maxIndex-index:index];if(subNode){if(subNode.entry)return mapIteratorValue(type,subNode.entry);stack=this._stack=mapIteratorFrame(subNode,stack)}continue}stack=this._stack=this._stack.__prev}return iteratorDone()};var MAX_ARRAY_MAP_SIZE=SIZE/4,MAX_BITMAP_INDEXED_SIZE=SIZE/2,MIN_HASH_ARRAY_MAP_SIZE=SIZE/4;function List(value){var empty=emptyList();if(null==value)return empty;if(isList(value))return value;var iter=IndexedIterable(value),size=iter.size;return 0===size?empty:(assertNotInfinite(size),size>0&&size<SIZE?makeList(0,size,SHIFT,null,new VNode(iter.toArray())):empty.withMutations((function(list){list.setSize(size),iter.forEach((function(v,i){return list.set(i,v)}))})))}function isList(maybeList){return!(!maybeList||!maybeList[IS_LIST_SENTINEL])}createClass(List,IndexedCollection),List.of=function(){return this(arguments)},List.prototype.toString=function(){return this.__toString("List [","]")},List.prototype.get=function(index,notSetValue){if((index=wrapIndex(this,index))>=0&&index<this.size){var node=listNodeFor(this,index+=this._origin);return node&&node.array[index&MASK]}return notSetValue},List.prototype.set=function(index,value){return updateList(this,index,value)},List.prototype.remove=function(index){return this.has(index)?0===index?this.shift():index===this.size-1?this.pop():this.splice(index,1):this},List.prototype.insert=function(index,value){return this.splice(index,0,value)},List.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=SHIFT,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):emptyList()},List.prototype.push=function(){var values=arguments,oldSize=this.size;return this.withMutations((function(list){setListBounds(list,0,oldSize+values.length);for(var ii=0;ii<values.length;ii++)list.set(oldSize+ii,values[ii])}))},List.prototype.pop=function(){return setListBounds(this,0,-1)},List.prototype.unshift=function(){var values=arguments;return this.withMutations((function(list){setListBounds(list,-values.length);for(var ii=0;ii<values.length;ii++)list.set(ii,values[ii])}))},List.prototype.shift=function(){return setListBounds(this,1)},List.prototype.merge=function(){return mergeIntoListWith(this,void 0,arguments)},List.prototype.mergeWith=function(merger){return mergeIntoListWith(this,merger,SLICE$0.call(arguments,1))},List.prototype.mergeDeep=function(){return mergeIntoListWith(this,deepMerger,arguments)},List.prototype.mergeDeepWith=function(merger){var iters=SLICE$0.call(arguments,1);return mergeIntoListWith(this,deepMergerWith(merger),iters)},List.prototype.setSize=function(size){return setListBounds(this,0,size)},List.prototype.slice=function(begin,end){var size=this.size;return wholeSlice(begin,end,size)?this:setListBounds(this,resolveBegin(begin,size),resolveEnd(end,size))},List.prototype.__iterator=function(type,reverse){var index=0,values=iterateList(this,reverse);return new Iterator((function(){var value=values();return value===DONE?iteratorDone():iteratorValue(type,index++,value)}))},List.prototype.__iterate=function(fn,reverse){for(var value,index=0,values=iterateList(this,reverse);(value=values())!==DONE&&!1!==fn(value,index++,this););return index},List.prototype.__ensureOwner=function(ownerID){return ownerID===this.__ownerID?this:ownerID?makeList(this._origin,this._capacity,this._level,this._root,this._tail,ownerID,this.__hash):(this.__ownerID=ownerID,this)},List.isList=isList;var IS_LIST_SENTINEL="@@__IMMUTABLE_LIST__@@",ListPrototype=List.prototype;function VNode(array,ownerID){this.array=array,this.ownerID=ownerID}ListPrototype[IS_LIST_SENTINEL]=!0,ListPrototype[DELETE]=ListPrototype.remove,ListPrototype.setIn=MapPrototype.setIn,ListPrototype.deleteIn=ListPrototype.removeIn=MapPrototype.removeIn,ListPrototype.update=MapPrototype.update,ListPrototype.updateIn=MapPrototype.updateIn,ListPrototype.mergeIn=MapPrototype.mergeIn,ListPrototype.mergeDeepIn=MapPrototype.mergeDeepIn,ListPrototype.withMutations=MapPrototype.withMutations,ListPrototype.asMutable=MapPrototype.asMutable,ListPrototype.asImmutable=MapPrototype.asImmutable,ListPrototype.wasAltered=MapPrototype.wasAltered,VNode.prototype.removeBefore=function(ownerID,level,index){if(index===level?1<<level:0===this.array.length)return this;var originIndex=index>>>level&MASK;if(originIndex>=this.array.length)return new VNode([],ownerID);var newChild,removingFirst=0===originIndex;if(level>0){var oldChild=this.array[originIndex];if((newChild=oldChild&&oldChild.removeBefore(ownerID,level-SHIFT,index))===oldChild&&removingFirst)return this}if(removingFirst&&!newChild)return this;var editable=editableVNode(this,ownerID);if(!removingFirst)for(var ii=0;ii<originIndex;ii++)editable.array[ii]=void 0;return newChild&&(editable.array[originIndex]=newChild),editable},VNode.prototype.removeAfter=function(ownerID,level,index){if(index===(level?1<<level:0)||0===this.array.length)return this;var newChild,sizeIndex=index-1>>>level&MASK;if(sizeIndex>=this.array.length)return this;if(level>0){var oldChild=this.array[sizeIndex];if((newChild=oldChild&&oldChild.removeAfter(ownerID,level-SHIFT,index))===oldChild&&sizeIndex===this.array.length-1)return this}var editable=editableVNode(this,ownerID);return editable.array.splice(sizeIndex+1),newChild&&(editable.array[sizeIndex]=newChild),editable};var EMPTY_LIST,EMPTY_ORDERED_MAP,DONE={};function iterateList(list,reverse){var left=list._origin,right=list._capacity,tailPos=getTailOffset(right),tail=list._tail;return iterateNodeOrLeaf(list._root,list._level,0);function iterateNodeOrLeaf(node,level,offset){return 0===level?iterateLeaf(node,offset):iterateNode(node,level,offset)}function iterateLeaf(node,offset){var array=offset===tailPos?tail&&tail.array:node&&node.array,from=offset>left?0:left-offset,to=right-offset;return to>SIZE&&(to=SIZE),function(){if(from===to)return DONE;var idx=reverse?--to:from++;return array&&array[idx]}}function iterateNode(node,level,offset){var values,array=node&&node.array,from=offset>left?0:left-offset>>level,to=1+(right-offset>>level);return to>SIZE&&(to=SIZE),function(){for(;;){if(values){var value=values();if(value!==DONE)return value;values=null}if(from===to)return DONE;var idx=reverse?--to:from++;values=iterateNodeOrLeaf(array&&array[idx],level-SHIFT,offset+(idx<<level))}}}}function makeList(origin,capacity,level,root,tail,ownerID,hash){var list=Object.create(ListPrototype);return list.size=capacity-origin,list._origin=origin,list._capacity=capacity,list._level=level,list._root=root,list._tail=tail,list.__ownerID=ownerID,list.__hash=hash,list.__altered=!1,list}function emptyList(){return EMPTY_LIST||(EMPTY_LIST=makeList(0,0,SHIFT))}function updateList(list,index,value){if((index=wrapIndex(list,index))!=index)return list;if(index>=list.size||index<0)return list.withMutations((function(list){index<0?setListBounds(list,index).set(0,value):setListBounds(list,0,index+1).set(index,value)}));index+=list._origin;var newTail=list._tail,newRoot=list._root,didAlter=MakeRef(DID_ALTER);return index>=getTailOffset(list._capacity)?newTail=updateVNode(newTail,list.__ownerID,0,index,value,didAlter):newRoot=updateVNode(newRoot,list.__ownerID,list._level,index,value,didAlter),didAlter.value?list.__ownerID?(list._root=newRoot,list._tail=newTail,list.__hash=void 0,list.__altered=!0,list):makeList(list._origin,list._capacity,list._level,newRoot,newTail):list}function updateVNode(node,ownerID,level,index,value,didAlter){var newNode,idx=index>>>level&MASK,nodeHas=node&&idx<node.array.length;if(!nodeHas&&void 0===value)return node;if(level>0){var lowerNode=node&&node.array[idx],newLowerNode=updateVNode(lowerNode,ownerID,level-SHIFT,index,value,didAlter);return newLowerNode===lowerNode?node:((newNode=editableVNode(node,ownerID)).array[idx]=newLowerNode,newNode)}return nodeHas&&node.array[idx]===value?node:(SetRef(didAlter),newNode=editableVNode(node,ownerID),void 0===value&&idx===newNode.array.length-1?newNode.array.pop():newNode.array[idx]=value,newNode)}function editableVNode(node,ownerID){return ownerID&&node&&ownerID===node.ownerID?node:new VNode(node?node.array.slice():[],ownerID)}function listNodeFor(list,rawIndex){if(rawIndex>=getTailOffset(list._capacity))return list._tail;if(rawIndex<1<<list._level+SHIFT){for(var node=list._root,level=list._level;node&&level>0;)node=node.array[rawIndex>>>level&MASK],level-=SHIFT;return node}}function setListBounds(list,begin,end){void 0!==begin&&(begin|=0),void 0!==end&&(end|=0);var owner=list.__ownerID||new OwnerID,oldOrigin=list._origin,oldCapacity=list._capacity,newOrigin=oldOrigin+begin,newCapacity=void 0===end?oldCapacity:end<0?oldCapacity+end:oldOrigin+end;if(newOrigin===oldOrigin&&newCapacity===oldCapacity)return list;if(newOrigin>=newCapacity)return list.clear();for(var newLevel=list._level,newRoot=list._root,offsetShift=0;newOrigin+offsetShift<0;)newRoot=new VNode(newRoot&&newRoot.array.length?[void 0,newRoot]:[],owner),offsetShift+=1<<(newLevel+=SHIFT);offsetShift&&(newOrigin+=offsetShift,oldOrigin+=offsetShift,newCapacity+=offsetShift,oldCapacity+=offsetShift);for(var oldTailOffset=getTailOffset(oldCapacity),newTailOffset=getTailOffset(newCapacity);newTailOffset>=1<<newLevel+SHIFT;)newRoot=new VNode(newRoot&&newRoot.array.length?[newRoot]:[],owner),newLevel+=SHIFT;var oldTail=list._tail,newTail=newTailOffset<oldTailOffset?listNodeFor(list,newCapacity-1):newTailOffset>oldTailOffset?new VNode([],owner):oldTail;if(oldTail&&newTailOffset>oldTailOffset&&newOrigin<oldCapacity&&oldTail.array.length){for(var node=newRoot=editableVNode(newRoot,owner),level=newLevel;level>SHIFT;level-=SHIFT){var idx=oldTailOffset>>>level&MASK;node=node.array[idx]=editableVNode(node.array[idx],owner)}node.array[oldTailOffset>>>SHIFT&MASK]=oldTail}if(newCapacity<oldCapacity&&(newTail=newTail&&newTail.removeAfter(owner,0,newCapacity)),newOrigin>=newTailOffset)newOrigin-=newTailOffset,newCapacity-=newTailOffset,newLevel=SHIFT,newRoot=null,newTail=newTail&&newTail.removeBefore(owner,0,newOrigin);else if(newOrigin>oldOrigin||newTailOffset<oldTailOffset){for(offsetShift=0;newRoot;){var beginIndex=newOrigin>>>newLevel&MASK;if(beginIndex!==newTailOffset>>>newLevel&MASK)break;beginIndex&&(offsetShift+=(1<<newLevel)*beginIndex),newLevel-=SHIFT,newRoot=newRoot.array[beginIndex]}newRoot&&newOrigin>oldOrigin&&(newRoot=newRoot.removeBefore(owner,newLevel,newOrigin-offsetShift)),newRoot&&newTailOffset<oldTailOffset&&(newRoot=newRoot.removeAfter(owner,newLevel,newTailOffset-offsetShift)),offsetShift&&(newOrigin-=offsetShift,newCapacity-=offsetShift)}return list.__ownerID?(list.size=newCapacity-newOrigin,list._origin=newOrigin,list._capacity=newCapacity,list._level=newLevel,list._root=newRoot,list._tail=newTail,list.__hash=void 0,list.__altered=!0,list):makeList(newOrigin,newCapacity,newLevel,newRoot,newTail)}function mergeIntoListWith(list,merger,iterables){for(var iters=[],maxSize=0,ii=0;ii<iterables.length;ii++){var value=iterables[ii],iter=IndexedIterable(value);iter.size>maxSize&&(maxSize=iter.size),isIterable(value)||(iter=iter.map((function(v){return fromJS(v)}))),iters.push(iter)}return maxSize>list.size&&(list=list.setSize(maxSize)),mergeIntoCollectionWith(list,merger,iters)}function getTailOffset(size){return size<SIZE?0:size-1>>>SHIFT<<SHIFT}function OrderedMap(value){return null==value?emptyOrderedMap():isOrderedMap(value)?value:emptyOrderedMap().withMutations((function(map){var iter=KeyedIterable(value);assertNotInfinite(iter.size),iter.forEach((function(v,k){return map.set(k,v)}))}))}function isOrderedMap(maybeOrderedMap){return isMap(maybeOrderedMap)&&isOrdered(maybeOrderedMap)}function makeOrderedMap(map,list,ownerID,hash){var omap=Object.create(OrderedMap.prototype);return omap.size=map?map.size:0,omap._map=map,omap._list=list,omap.__ownerID=ownerID,omap.__hash=hash,omap}function emptyOrderedMap(){return EMPTY_ORDERED_MAP||(EMPTY_ORDERED_MAP=makeOrderedMap(emptyMap(),emptyList()))}function updateOrderedMap(omap,k,v){var newMap,newList,map=omap._map,list=omap._list,i=map.get(k),has=void 0!==i;if(v===NOT_SET){if(!has)return omap;list.size>=SIZE&&list.size>=2*map.size?(newMap=(newList=list.filter((function(entry,idx){return void 0!==entry&&i!==idx}))).toKeyedSeq().map((function(entry){return entry[0]})).flip().toMap(),omap.__ownerID&&(newMap.__ownerID=newList.__ownerID=omap.__ownerID)):(newMap=map.remove(k),newList=i===list.size-1?list.pop():list.set(i,void 0))}else if(has){if(v===list.get(i)[1])return omap;newMap=map,newList=list.set(i,[k,v])}else newMap=map.set(k,list.size),newList=list.set(list.size,[k,v]);return omap.__ownerID?(omap.size=newMap.size,omap._map=newMap,omap._list=newList,omap.__hash=void 0,omap):makeOrderedMap(newMap,newList)}function ToKeyedSequence(indexed,useKeys){this._iter=indexed,this._useKeys=useKeys,this.size=indexed.size}function ToIndexedSequence(iter){this._iter=iter,this.size=iter.size}function ToSetSequence(iter){this._iter=iter,this.size=iter.size}function FromEntriesSequence(entries){this._iter=entries,this.size=entries.size}function flipFactory(iterable){var flipSequence=makeSequence(iterable);return flipSequence._iter=iterable,flipSequence.size=iterable.size,flipSequence.flip=function(){return iterable},flipSequence.reverse=function(){var reversedSequence=iterable.reverse.apply(this);return reversedSequence.flip=function(){return iterable.reverse()},reversedSequence},flipSequence.has=function(key){return iterable.includes(key)},flipSequence.includes=function(key){return iterable.has(key)},flipSequence.cacheResult=cacheResultThrough,flipSequence.__iterateUncached=function(fn,reverse){var this$0=this;return iterable.__iterate((function(v,k){return!1!==fn(k,v,this$0)}),reverse)},flipSequence.__iteratorUncached=function(type,reverse){if(type===ITERATE_ENTRIES){var iterator=iterable.__iterator(type,reverse);return new Iterator((function(){var step=iterator.next();if(!step.done){var k=step.value[0];step.value[0]=step.value[1],step.value[1]=k}return step}))}return iterable.__iterator(type===ITERATE_VALUES?ITERATE_KEYS:ITERATE_VALUES,reverse)},flipSequence}function mapFactory(iterable,mapper,context){var mappedSequence=makeSequence(iterable);return mappedSequence.size=iterable.size,mappedSequence.has=function(key){return iterable.has(key)},mappedSequence.get=function(key,notSetValue){var v=iterable.get(key,NOT_SET);return v===NOT_SET?notSetValue:mapper.call(context,v,key,iterable)},mappedSequence.__iterateUncached=function(fn,reverse){var this$0=this;return iterable.__iterate((function(v,k,c){return!1!==fn(mapper.call(context,v,k,c),k,this$0)}),reverse)},mappedSequence.__iteratorUncached=function(type,reverse){var iterator=iterable.__iterator(ITERATE_ENTRIES,reverse);return new Iterator((function(){var step=iterator.next();if(step.done)return step;var entry=step.value,key=entry[0];return iteratorValue(type,key,mapper.call(context,entry[1],key,iterable),step)}))},mappedSequence}function reverseFactory(iterable,useKeys){var reversedSequence=makeSequence(iterable);return reversedSequence._iter=iterable,reversedSequence.size=iterable.size,reversedSequence.reverse=function(){return iterable},iterable.flip&&(reversedSequence.flip=function(){var flipSequence=flipFactory(iterable);return flipSequence.reverse=function(){return iterable.flip()},flipSequence}),reversedSequence.get=function(key,notSetValue){return iterable.get(useKeys?key:-1-key,notSetValue)},reversedSequence.has=function(key){return iterable.has(useKeys?key:-1-key)},reversedSequence.includes=function(value){return iterable.includes(value)},reversedSequence.cacheResult=cacheResultThrough,reversedSequence.__iterate=function(fn,reverse){var this$0=this;return iterable.__iterate((function(v,k){return fn(v,k,this$0)}),!reverse)},reversedSequence.__iterator=function(type,reverse){return iterable.__iterator(type,!reverse)},reversedSequence}function filterFactory(iterable,predicate,context,useKeys){var filterSequence=makeSequence(iterable);return useKeys&&(filterSequence.has=function(key){var v=iterable.get(key,NOT_SET);return v!==NOT_SET&&!!predicate.call(context,v,key,iterable)},filterSequence.get=function(key,notSetValue){var v=iterable.get(key,NOT_SET);return v!==NOT_SET&&predicate.call(context,v,key,iterable)?v:notSetValue}),filterSequence.__iterateUncached=function(fn,reverse){var this$0=this,iterations=0;return iterable.__iterate((function(v,k,c){if(predicate.call(context,v,k,c))return iterations++,fn(v,useKeys?k:iterations-1,this$0)}),reverse),iterations},filterSequence.__iteratorUncached=function(type,reverse){var iterator=iterable.__iterator(ITERATE_ENTRIES,reverse),iterations=0;return new Iterator((function(){for(;;){var step=iterator.next();if(step.done)return step;var entry=step.value,key=entry[0],value=entry[1];if(predicate.call(context,value,key,iterable))return iteratorValue(type,useKeys?key:iterations++,value,step)}}))},filterSequence}function countByFactory(iterable,grouper,context){var groups=Map().asMutable();return iterable.__iterate((function(v,k){groups.update(grouper.call(context,v,k,iterable),0,(function(a){return a+1}))})),groups.asImmutable()}function groupByFactory(iterable,grouper,context){var isKeyedIter=isKeyed(iterable),groups=(isOrdered(iterable)?OrderedMap():Map()).asMutable();iterable.__iterate((function(v,k){groups.update(grouper.call(context,v,k,iterable),(function(a){return(a=a||[]).push(isKeyedIter?[k,v]:v),a}))}));var coerce=iterableClass(iterable);return groups.map((function(arr){return reify(iterable,coerce(arr))}))}function sliceFactory(iterable,begin,end,useKeys){var originalSize=iterable.size;if(void 0!==begin&&(begin|=0),void 0!==end&&(end===1/0?end=originalSize:end|=0),wholeSlice(begin,end,originalSize))return iterable;var resolvedBegin=resolveBegin(begin,originalSize),resolvedEnd=resolveEnd(end,originalSize);if(resolvedBegin!=resolvedBegin||resolvedEnd!=resolvedEnd)return sliceFactory(iterable.toSeq().cacheResult(),begin,end,useKeys);var sliceSize,resolvedSize=resolvedEnd-resolvedBegin;resolvedSize==resolvedSize&&(sliceSize=resolvedSize<0?0:resolvedSize);var sliceSeq=makeSequence(iterable);return sliceSeq.size=0===sliceSize?sliceSize:iterable.size&&sliceSize||void 0,!useKeys&&isSeq(iterable)&&sliceSize>=0&&(sliceSeq.get=function(index,notSetValue){return(index=wrapIndex(this,index))>=0&&index<sliceSize?iterable.get(index+resolvedBegin,notSetValue):notSetValue}),sliceSeq.__iterateUncached=function(fn,reverse){var this$0=this;if(0===sliceSize)return 0;if(reverse)return this.cacheResult().__iterate(fn,reverse);var skipped=0,isSkipping=!0,iterations=0;return iterable.__iterate((function(v,k){if(!isSkipping||!(isSkipping=skipped++<resolvedBegin))return iterations++,!1!==fn(v,useKeys?k:iterations-1,this$0)&&iterations!==sliceSize})),iterations},sliceSeq.__iteratorUncached=function(type,reverse){if(0!==sliceSize&&reverse)return this.cacheResult().__iterator(type,reverse);var iterator=0!==sliceSize&&iterable.__iterator(type,reverse),skipped=0,iterations=0;return new Iterator((function(){for(;skipped++<resolvedBegin;)iterator.next();if(++iterations>sliceSize)return iteratorDone();var step=iterator.next();return useKeys||type===ITERATE_VALUES?step:iteratorValue(type,iterations-1,type===ITERATE_KEYS?void 0:step.value[1],step)}))},sliceSeq}function takeWhileFactory(iterable,predicate,context){var takeSequence=makeSequence(iterable);return takeSequence.__iterateUncached=function(fn,reverse){var this$0=this;if(reverse)return this.cacheResult().__iterate(fn,reverse);var iterations=0;return iterable.__iterate((function(v,k,c){return predicate.call(context,v,k,c)&&++iterations&&fn(v,k,this$0)})),iterations},takeSequence.__iteratorUncached=function(type,reverse){var this$0=this;if(reverse)return this.cacheResult().__iterator(type,reverse);var iterator=iterable.__iterator(ITERATE_ENTRIES,reverse),iterating=!0;return new Iterator((function(){if(!iterating)return iteratorDone();var step=iterator.next();if(step.done)return step;var entry=step.value,k=entry[0],v=entry[1];return predicate.call(context,v,k,this$0)?type===ITERATE_ENTRIES?step:iteratorValue(type,k,v,step):(iterating=!1,iteratorDone())}))},takeSequence}function skipWhileFactory(iterable,predicate,context,useKeys){var skipSequence=makeSequence(iterable);return skipSequence.__iterateUncached=function(fn,reverse){var this$0=this;if(reverse)return this.cacheResult().__iterate(fn,reverse);var isSkipping=!0,iterations=0;return iterable.__iterate((function(v,k,c){if(!isSkipping||!(isSkipping=predicate.call(context,v,k,c)))return iterations++,fn(v,useKeys?k:iterations-1,this$0)})),iterations},skipSequence.__iteratorUncached=function(type,reverse){var this$0=this;if(reverse)return this.cacheResult().__iterator(type,reverse);var iterator=iterable.__iterator(ITERATE_ENTRIES,reverse),skipping=!0,iterations=0;return new Iterator((function(){var step,k,v;do{if((step=iterator.next()).done)return useKeys||type===ITERATE_VALUES?step:iteratorValue(type,iterations++,type===ITERATE_KEYS?void 0:step.value[1],step);var entry=step.value;k=entry[0],v=entry[1],skipping&&(skipping=predicate.call(context,v,k,this$0))}while(skipping);return type===ITERATE_ENTRIES?step:iteratorValue(type,k,v,step)}))},skipSequence}function concatFactory(iterable,values){var isKeyedIterable=isKeyed(iterable),iters=[iterable].concat(values).map((function(v){return isIterable(v)?isKeyedIterable&&(v=KeyedIterable(v)):v=isKeyedIterable?keyedSeqFromValue(v):indexedSeqFromValue(Array.isArray(v)?v:[v]),v})).filter((function(v){return 0!==v.size}));if(0===iters.length)return iterable;if(1===iters.length){var singleton=iters[0];if(singleton===iterable||isKeyedIterable&&isKeyed(singleton)||isIndexed(iterable)&&isIndexed(singleton))return singleton}var concatSeq=new ArraySeq(iters);return isKeyedIterable?concatSeq=concatSeq.toKeyedSeq():isIndexed(iterable)||(concatSeq=concatSeq.toSetSeq()),(concatSeq=concatSeq.flatten(!0)).size=iters.reduce((function(sum,seq){if(void 0!==sum){var size=seq.size;if(void 0!==size)return sum+size}}),0),concatSeq}function flattenFactory(iterable,depth,useKeys){var flatSequence=makeSequence(iterable);return flatSequence.__iterateUncached=function(fn,reverse){var iterations=0,stopped=!1;function flatDeep(iter,currentDepth){var this$0=this;iter.__iterate((function(v,k){return(!depth||currentDepth<depth)&&isIterable(v)?flatDeep(v,currentDepth+1):!1===fn(v,useKeys?k:iterations++,this$0)&&(stopped=!0),!stopped}),reverse)}return flatDeep(iterable,0),iterations},flatSequence.__iteratorUncached=function(type,reverse){var iterator=iterable.__iterator(type,reverse),stack=[],iterations=0;return new Iterator((function(){for(;iterator;){var step=iterator.next();if(!1===step.done){var v=step.value;if(type===ITERATE_ENTRIES&&(v=v[1]),depth&&!(stack.length<depth)||!isIterable(v))return useKeys?step:iteratorValue(type,iterations++,v,step);stack.push(iterator),iterator=v.__iterator(type,reverse)}else iterator=stack.pop()}return iteratorDone()}))},flatSequence}function flatMapFactory(iterable,mapper,context){var coerce=iterableClass(iterable);return iterable.toSeq().map((function(v,k){return coerce(mapper.call(context,v,k,iterable))})).flatten(!0)}function interposeFactory(iterable,separator){var interposedSequence=makeSequence(iterable);return interposedSequence.size=iterable.size&&2*iterable.size-1,interposedSequence.__iterateUncached=function(fn,reverse){var this$0=this,iterations=0;return iterable.__iterate((function(v,k){return(!iterations||!1!==fn(separator,iterations++,this$0))&&!1!==fn(v,iterations++,this$0)}),reverse),iterations},interposedSequence.__iteratorUncached=function(type,reverse){var step,iterator=iterable.__iterator(ITERATE_VALUES,reverse),iterations=0;return new Iterator((function(){return(!step||iterations%2)&&(step=iterator.next()).done?step:iterations%2?iteratorValue(type,iterations++,separator):iteratorValue(type,iterations++,step.value,step)}))},interposedSequence}function sortFactory(iterable,comparator,mapper){comparator||(comparator=defaultComparator);var isKeyedIterable=isKeyed(iterable),index=0,entries=iterable.toSeq().map((function(v,k){return[k,v,index++,mapper?mapper(v,k,iterable):v]})).toArray();return entries.sort((function(a,b){return comparator(a[3],b[3])||a[2]-b[2]})).forEach(isKeyedIterable?function(v,i){entries[i].length=2}:function(v,i){entries[i]=v[1]}),isKeyedIterable?KeyedSeq(entries):isIndexed(iterable)?IndexedSeq(entries):SetSeq(entries)}function maxFactory(iterable,comparator,mapper){if(comparator||(comparator=defaultComparator),mapper){var entry=iterable.toSeq().map((function(v,k){return[v,mapper(v,k,iterable)]})).reduce((function(a,b){return maxCompare(comparator,a[1],b[1])?b:a}));return entry&&entry[0]}return iterable.reduce((function(a,b){return maxCompare(comparator,a,b)?b:a}))}function maxCompare(comparator,a,b){var comp=comparator(b,a);return 0===comp&&b!==a&&(null==b||b!=b)||comp>0}function zipWithFactory(keyIter,zipper,iters){var zipSequence=makeSequence(keyIter);return zipSequence.size=new ArraySeq(iters).map((function(i){return i.size})).min(),zipSequence.__iterate=function(fn,reverse){for(var step,iterator=this.__iterator(ITERATE_VALUES,reverse),iterations=0;!(step=iterator.next()).done&&!1!==fn(step.value,iterations++,this););return iterations},zipSequence.__iteratorUncached=function(type,reverse){var iterators=iters.map((function(i){return i=Iterable(i),getIterator(reverse?i.reverse():i)})),iterations=0,isDone=!1;return new Iterator((function(){var steps;return isDone||(steps=iterators.map((function(i){return i.next()})),isDone=steps.some((function(s){return s.done}))),isDone?iteratorDone():iteratorValue(type,iterations++,zipper.apply(null,steps.map((function(s){return s.value}))))}))},zipSequence}function reify(iter,seq){return isSeq(iter)?seq:iter.constructor(seq)}function validateEntry(entry){if(entry!==Object(entry))throw new TypeError("Expected [K, V] tuple: "+entry)}function resolveSize(iter){return assertNotInfinite(iter.size),ensureSize(iter)}function iterableClass(iterable){return isKeyed(iterable)?KeyedIterable:isIndexed(iterable)?IndexedIterable:SetIterable}function makeSequence(iterable){return Object.create((isKeyed(iterable)?KeyedSeq:isIndexed(iterable)?IndexedSeq:SetSeq).prototype)}function cacheResultThrough(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Seq.prototype.cacheResult.call(this)}function defaultComparator(a,b){return a>b?1:a<b?-1:0}function forceIterator(keyPath){var iter=getIterator(keyPath);if(!iter){if(!isArrayLike(keyPath))throw new TypeError("Expected iterable or array-like: "+keyPath);iter=getIterator(Iterable(keyPath))}return iter}function Record(defaultValues,name){var hasInitialized,RecordType=function Record(values){if(values instanceof RecordType)return values;if(!(this instanceof RecordType))return new RecordType(values);if(!hasInitialized){hasInitialized=!0;var keys=Object.keys(defaultValues);setProps(RecordTypePrototype,keys),RecordTypePrototype.size=keys.length,RecordTypePrototype._name=name,RecordTypePrototype._keys=keys,RecordTypePrototype._defaultValues=defaultValues}this._map=Map(values)},RecordTypePrototype=RecordType.prototype=Object.create(RecordPrototype);return RecordTypePrototype.constructor=RecordType,RecordType}createClass(OrderedMap,Map),OrderedMap.of=function(){return this(arguments)},OrderedMap.prototype.toString=function(){return this.__toString("OrderedMap {","}")},OrderedMap.prototype.get=function(k,notSetValue){var index=this._map.get(k);return void 0!==index?this._list.get(index)[1]:notSetValue},OrderedMap.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):emptyOrderedMap()},OrderedMap.prototype.set=function(k,v){return updateOrderedMap(this,k,v)},OrderedMap.prototype.remove=function(k){return updateOrderedMap(this,k,NOT_SET)},OrderedMap.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},OrderedMap.prototype.__iterate=function(fn,reverse){var this$0=this;return this._list.__iterate((function(entry){return entry&&fn(entry[1],entry[0],this$0)}),reverse)},OrderedMap.prototype.__iterator=function(type,reverse){return this._list.fromEntrySeq().__iterator(type,reverse)},OrderedMap.prototype.__ensureOwner=function(ownerID){if(ownerID===this.__ownerID)return this;var newMap=this._map.__ensureOwner(ownerID),newList=this._list.__ensureOwner(ownerID);return ownerID?makeOrderedMap(newMap,newList,ownerID,this.__hash):(this.__ownerID=ownerID,this._map=newMap,this._list=newList,this)},OrderedMap.isOrderedMap=isOrderedMap,OrderedMap.prototype[IS_ORDERED_SENTINEL]=!0,OrderedMap.prototype[DELETE]=OrderedMap.prototype.remove,createClass(ToKeyedSequence,KeyedSeq),ToKeyedSequence.prototype.get=function(key,notSetValue){return this._iter.get(key,notSetValue)},ToKeyedSequence.prototype.has=function(key){return this._iter.has(key)},ToKeyedSequence.prototype.valueSeq=function(){return this._iter.valueSeq()},ToKeyedSequence.prototype.reverse=function(){var this$0=this,reversedSequence=reverseFactory(this,!0);return this._useKeys||(reversedSequence.valueSeq=function(){return this$0._iter.toSeq().reverse()}),reversedSequence},ToKeyedSequence.prototype.map=function(mapper,context){var this$0=this,mappedSequence=mapFactory(this,mapper,context);return this._useKeys||(mappedSequence.valueSeq=function(){return this$0._iter.toSeq().map(mapper,context)}),mappedSequence},ToKeyedSequence.prototype.__iterate=function(fn,reverse){var ii,this$0=this;return this._iter.__iterate(this._useKeys?function(v,k){return fn(v,k,this$0)}:(ii=reverse?resolveSize(this):0,function(v){return fn(v,reverse?--ii:ii++,this$0)}),reverse)},ToKeyedSequence.prototype.__iterator=function(type,reverse){if(this._useKeys)return this._iter.__iterator(type,reverse);var iterator=this._iter.__iterator(ITERATE_VALUES,reverse),ii=reverse?resolveSize(this):0;return new Iterator((function(){var step=iterator.next();return step.done?step:iteratorValue(type,reverse?--ii:ii++,step.value,step)}))},ToKeyedSequence.prototype[IS_ORDERED_SENTINEL]=!0,createClass(ToIndexedSequence,IndexedSeq),ToIndexedSequence.prototype.includes=function(value){return this._iter.includes(value)},ToIndexedSequence.prototype.__iterate=function(fn,reverse){var this$0=this,iterations=0;return this._iter.__iterate((function(v){return fn(v,iterations++,this$0)}),reverse)},ToIndexedSequence.prototype.__iterator=function(type,reverse){var iterator=this._iter.__iterator(ITERATE_VALUES,reverse),iterations=0;return new Iterator((function(){var step=iterator.next();return step.done?step:iteratorValue(type,iterations++,step.value,step)}))},createClass(ToSetSequence,SetSeq),ToSetSequence.prototype.has=function(key){return this._iter.includes(key)},ToSetSequence.prototype.__iterate=function(fn,reverse){var this$0=this;return this._iter.__iterate((function(v){return fn(v,v,this$0)}),reverse)},ToSetSequence.prototype.__iterator=function(type,reverse){var iterator=this._iter.__iterator(ITERATE_VALUES,reverse);return new Iterator((function(){var step=iterator.next();return step.done?step:iteratorValue(type,step.value,step.value,step)}))},createClass(FromEntriesSequence,KeyedSeq),FromEntriesSequence.prototype.entrySeq=function(){return this._iter.toSeq()},FromEntriesSequence.prototype.__iterate=function(fn,reverse){var this$0=this;return this._iter.__iterate((function(entry){if(entry){validateEntry(entry);var indexedIterable=isIterable(entry);return fn(indexedIterable?entry.get(1):entry[1],indexedIterable?entry.get(0):entry[0],this$0)}}),reverse)},FromEntriesSequence.prototype.__iterator=function(type,reverse){var iterator=this._iter.__iterator(ITERATE_VALUES,reverse);return new Iterator((function(){for(;;){var step=iterator.next();if(step.done)return step;var entry=step.value;if(entry){validateEntry(entry);var indexedIterable=isIterable(entry);return iteratorValue(type,indexedIterable?entry.get(0):entry[0],indexedIterable?entry.get(1):entry[1],step)}}}))},ToIndexedSequence.prototype.cacheResult=ToKeyedSequence.prototype.cacheResult=ToSetSequence.prototype.cacheResult=FromEntriesSequence.prototype.cacheResult=cacheResultThrough,createClass(Record,KeyedCollection),Record.prototype.toString=function(){return this.__toString(recordName(this)+" {","}")},Record.prototype.has=function(k){return this._defaultValues.hasOwnProperty(k)},Record.prototype.get=function(k,notSetValue){if(!this.has(k))return notSetValue;var defaultVal=this._defaultValues[k];return this._map?this._map.get(k,defaultVal):defaultVal},Record.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var RecordType=this.constructor;return RecordType._empty||(RecordType._empty=makeRecord(this,emptyMap()))},Record.prototype.set=function(k,v){if(!this.has(k))throw new Error('Cannot set unknown key "'+k+'" on '+recordName(this));if(this._map&&!this._map.has(k)&&v===this._defaultValues[k])return this;var newMap=this._map&&this._map.set(k,v);return this.__ownerID||newMap===this._map?this:makeRecord(this,newMap)},Record.prototype.remove=function(k){if(!this.has(k))return this;var newMap=this._map&&this._map.remove(k);return this.__ownerID||newMap===this._map?this:makeRecord(this,newMap)},Record.prototype.wasAltered=function(){return this._map.wasAltered()},Record.prototype.__iterator=function(type,reverse){var this$0=this;return KeyedIterable(this._defaultValues).map((function(_,k){return this$0.get(k)})).__iterator(type,reverse)},Record.prototype.__iterate=function(fn,reverse){var this$0=this;return KeyedIterable(this._defaultValues).map((function(_,k){return this$0.get(k)})).__iterate(fn,reverse)},Record.prototype.__ensureOwner=function(ownerID){if(ownerID===this.__ownerID)return this;var newMap=this._map&&this._map.__ensureOwner(ownerID);return ownerID?makeRecord(this,newMap,ownerID):(this.__ownerID=ownerID,this._map=newMap,this)};var RecordPrototype=Record.prototype;function makeRecord(likeRecord,map,ownerID){var record=Object.create(Object.getPrototypeOf(likeRecord));return record._map=map,record.__ownerID=ownerID,record}function recordName(record){return record._name||record.constructor.name||"Record"}function setProps(prototype,names){try{names.forEach(setProp.bind(void 0,prototype))}catch(error){}}function setProp(prototype,name){Object.defineProperty(prototype,name,{get:function(){return this.get(name)},set:function(value){invariant(this.__ownerID,"Cannot set on an immutable record."),this.set(name,value)}})}function Set(value){return null==value?emptySet():isSet(value)&&!isOrdered(value)?value:emptySet().withMutations((function(set){var iter=SetIterable(value);assertNotInfinite(iter.size),iter.forEach((function(v){return set.add(v)}))}))}function isSet(maybeSet){return!(!maybeSet||!maybeSet[IS_SET_SENTINEL])}RecordPrototype[DELETE]=RecordPrototype.remove,RecordPrototype.deleteIn=RecordPrototype.removeIn=MapPrototype.removeIn,RecordPrototype.merge=MapPrototype.merge,RecordPrototype.mergeWith=MapPrototype.mergeWith,RecordPrototype.mergeIn=MapPrototype.mergeIn,RecordPrototype.mergeDeep=MapPrototype.mergeDeep,RecordPrototype.mergeDeepWith=MapPrototype.mergeDeepWith,RecordPrototype.mergeDeepIn=MapPrototype.mergeDeepIn,RecordPrototype.setIn=MapPrototype.setIn,RecordPrototype.update=MapPrototype.update,RecordPrototype.updateIn=MapPrototype.updateIn,RecordPrototype.withMutations=MapPrototype.withMutations,RecordPrototype.asMutable=MapPrototype.asMutable,RecordPrototype.asImmutable=MapPrototype.asImmutable,createClass(Set,SetCollection),Set.of=function(){return this(arguments)},Set.fromKeys=function(value){return this(KeyedIterable(value).keySeq())},Set.prototype.toString=function(){return this.__toString("Set {","}")},Set.prototype.has=function(value){return this._map.has(value)},Set.prototype.add=function(value){return updateSet(this,this._map.set(value,!0))},Set.prototype.remove=function(value){return updateSet(this,this._map.remove(value))},Set.prototype.clear=function(){return updateSet(this,this._map.clear())},Set.prototype.union=function(){var iters=SLICE$0.call(arguments,0);return 0===(iters=iters.filter((function(x){return 0!==x.size}))).length?this:0!==this.size||this.__ownerID||1!==iters.length?this.withMutations((function(set){for(var ii=0;ii<iters.length;ii++)SetIterable(iters[ii]).forEach((function(value){return set.add(value)}))})):this.constructor(iters[0])},Set.prototype.intersect=function(){var iters=SLICE$0.call(arguments,0);if(0===iters.length)return this;iters=iters.map((function(iter){return SetIterable(iter)}));var originalSet=this;return this.withMutations((function(set){originalSet.forEach((function(value){iters.every((function(iter){return iter.includes(value)}))||set.remove(value)}))}))},Set.prototype.subtract=function(){var iters=SLICE$0.call(arguments,0);if(0===iters.length)return this;iters=iters.map((function(iter){return SetIterable(iter)}));var originalSet=this;return this.withMutations((function(set){originalSet.forEach((function(value){iters.some((function(iter){return iter.includes(value)}))&&set.remove(value)}))}))},Set.prototype.merge=function(){return this.union.apply(this,arguments)},Set.prototype.mergeWith=function(merger){var iters=SLICE$0.call(arguments,1);return this.union.apply(this,iters)},Set.prototype.sort=function(comparator){return OrderedSet(sortFactory(this,comparator))},Set.prototype.sortBy=function(mapper,comparator){return OrderedSet(sortFactory(this,comparator,mapper))},Set.prototype.wasAltered=function(){return this._map.wasAltered()},Set.prototype.__iterate=function(fn,reverse){var this$0=this;return this._map.__iterate((function(_,k){return fn(k,k,this$0)}),reverse)},Set.prototype.__iterator=function(type,reverse){return this._map.map((function(_,k){return k})).__iterator(type,reverse)},Set.prototype.__ensureOwner=function(ownerID){if(ownerID===this.__ownerID)return this;var newMap=this._map.__ensureOwner(ownerID);return ownerID?this.__make(newMap,ownerID):(this.__ownerID=ownerID,this._map=newMap,this)},Set.isSet=isSet;var EMPTY_SET,IS_SET_SENTINEL="@@__IMMUTABLE_SET__@@",SetPrototype=Set.prototype;function updateSet(set,newMap){return set.__ownerID?(set.size=newMap.size,set._map=newMap,set):newMap===set._map?set:0===newMap.size?set.__empty():set.__make(newMap)}function makeSet(map,ownerID){var set=Object.create(SetPrototype);return set.size=map?map.size:0,set._map=map,set.__ownerID=ownerID,set}function emptySet(){return EMPTY_SET||(EMPTY_SET=makeSet(emptyMap()))}function OrderedSet(value){return null==value?emptyOrderedSet():isOrderedSet(value)?value:emptyOrderedSet().withMutations((function(set){var iter=SetIterable(value);assertNotInfinite(iter.size),iter.forEach((function(v){return set.add(v)}))}))}function isOrderedSet(maybeOrderedSet){return isSet(maybeOrderedSet)&&isOrdered(maybeOrderedSet)}SetPrototype[IS_SET_SENTINEL]=!0,SetPrototype[DELETE]=SetPrototype.remove,SetPrototype.mergeDeep=SetPrototype.merge,SetPrototype.mergeDeepWith=SetPrototype.mergeWith,SetPrototype.withMutations=MapPrototype.withMutations,SetPrototype.asMutable=MapPrototype.asMutable,SetPrototype.asImmutable=MapPrototype.asImmutable,SetPrototype.__empty=emptySet,SetPrototype.__make=makeSet,createClass(OrderedSet,Set),OrderedSet.of=function(){return this(arguments)},OrderedSet.fromKeys=function(value){return this(KeyedIterable(value).keySeq())},OrderedSet.prototype.toString=function(){return this.__toString("OrderedSet {","}")},OrderedSet.isOrderedSet=isOrderedSet;var EMPTY_ORDERED_SET,OrderedSetPrototype=OrderedSet.prototype;function makeOrderedSet(map,ownerID){var set=Object.create(OrderedSetPrototype);return set.size=map?map.size:0,set._map=map,set.__ownerID=ownerID,set}function emptyOrderedSet(){return EMPTY_ORDERED_SET||(EMPTY_ORDERED_SET=makeOrderedSet(emptyOrderedMap()))}function Stack(value){return null==value?emptyStack():isStack(value)?value:emptyStack().unshiftAll(value)}function isStack(maybeStack){return!(!maybeStack||!maybeStack[IS_STACK_SENTINEL])}OrderedSetPrototype[IS_ORDERED_SENTINEL]=!0,OrderedSetPrototype.__empty=emptyOrderedSet,OrderedSetPrototype.__make=makeOrderedSet,createClass(Stack,IndexedCollection),Stack.of=function(){return this(arguments)},Stack.prototype.toString=function(){return this.__toString("Stack [","]")},Stack.prototype.get=function(index,notSetValue){var head=this._head;for(index=wrapIndex(this,index);head&&index--;)head=head.next;return head?head.value:notSetValue},Stack.prototype.peek=function(){return this._head&&this._head.value},Stack.prototype.push=function(){if(0===arguments.length)return this;for(var newSize=this.size+arguments.length,head=this._head,ii=arguments.length-1;ii>=0;ii--)head={value:arguments[ii],next:head};return this.__ownerID?(this.size=newSize,this._head=head,this.__hash=void 0,this.__altered=!0,this):makeStack(newSize,head)},Stack.prototype.pushAll=function(iter){if(0===(iter=IndexedIterable(iter)).size)return this;assertNotInfinite(iter.size);var newSize=this.size,head=this._head;return iter.reverse().forEach((function(value){newSize++,head={value,next:head}})),this.__ownerID?(this.size=newSize,this._head=head,this.__hash=void 0,this.__altered=!0,this):makeStack(newSize,head)},Stack.prototype.pop=function(){return this.slice(1)},Stack.prototype.unshift=function(){return this.push.apply(this,arguments)},Stack.prototype.unshiftAll=function(iter){return this.pushAll(iter)},Stack.prototype.shift=function(){return this.pop.apply(this,arguments)},Stack.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):emptyStack()},Stack.prototype.slice=function(begin,end){if(wholeSlice(begin,end,this.size))return this;var resolvedBegin=resolveBegin(begin,this.size);if(resolveEnd(end,this.size)!==this.size)return IndexedCollection.prototype.slice.call(this,begin,end);for(var newSize=this.size-resolvedBegin,head=this._head;resolvedBegin--;)head=head.next;return this.__ownerID?(this.size=newSize,this._head=head,this.__hash=void 0,this.__altered=!0,this):makeStack(newSize,head)},Stack.prototype.__ensureOwner=function(ownerID){return ownerID===this.__ownerID?this:ownerID?makeStack(this.size,this._head,ownerID,this.__hash):(this.__ownerID=ownerID,this.__altered=!1,this)},Stack.prototype.__iterate=function(fn,reverse){if(reverse)return this.reverse().__iterate(fn);for(var iterations=0,node=this._head;node&&!1!==fn(node.value,iterations++,this);)node=node.next;return iterations},Stack.prototype.__iterator=function(type,reverse){if(reverse)return this.reverse().__iterator(type);var iterations=0,node=this._head;return new Iterator((function(){if(node){var value=node.value;return node=node.next,iteratorValue(type,iterations++,value)}return iteratorDone()}))},Stack.isStack=isStack;var EMPTY_STACK,IS_STACK_SENTINEL="@@__IMMUTABLE_STACK__@@",StackPrototype=Stack.prototype;function makeStack(size,head,ownerID,hash){var map=Object.create(StackPrototype);return map.size=size,map._head=head,map.__ownerID=ownerID,map.__hash=hash,map.__altered=!1,map}function emptyStack(){return EMPTY_STACK||(EMPTY_STACK=makeStack(0))}function mixin(ctor,methods){var keyCopier=function(key){ctor.prototype[key]=methods[key]};return Object.keys(methods).forEach(keyCopier),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(methods).forEach(keyCopier),ctor}StackPrototype[IS_STACK_SENTINEL]=!0,StackPrototype.withMutations=MapPrototype.withMutations,StackPrototype.asMutable=MapPrototype.asMutable,StackPrototype.asImmutable=MapPrototype.asImmutable,StackPrototype.wasAltered=MapPrototype.wasAltered,Iterable.Iterator=Iterator,mixin(Iterable,{toArray:function(){assertNotInfinite(this.size);var array=new Array(this.size||0);return this.valueSeq().__iterate((function(v,i){array[i]=v})),array},toIndexedSeq:function(){return new ToIndexedSequence(this)},toJS:function(){return this.toSeq().map((function(value){return value&&"function"==typeof value.toJS?value.toJS():value})).__toJS()},toJSON:function(){return this.toSeq().map((function(value){return value&&"function"==typeof value.toJSON?value.toJSON():value})).__toJS()},toKeyedSeq:function(){return new ToKeyedSequence(this,!0)},toMap:function(){return Map(this.toKeyedSeq())},toObject:function(){assertNotInfinite(this.size);var object={};return this.__iterate((function(v,k){object[k]=v})),object},toOrderedMap:function(){return OrderedMap(this.toKeyedSeq())},toOrderedSet:function(){return OrderedSet(isKeyed(this)?this.valueSeq():this)},toSet:function(){return Set(isKeyed(this)?this.valueSeq():this)},toSetSeq:function(){return new ToSetSequence(this)},toSeq:function(){return isIndexed(this)?this.toIndexedSeq():isKeyed(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Stack(isKeyed(this)?this.valueSeq():this)},toList:function(){return List(isKeyed(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(head,tail){return 0===this.size?head+tail:head+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+tail},concat:function(){return reify(this,concatFactory(this,SLICE$0.call(arguments,0)))},includes:function(searchValue){return this.some((function(value){return is(value,searchValue)}))},entries:function(){return this.__iterator(ITERATE_ENTRIES)},every:function(predicate,context){assertNotInfinite(this.size);var returnValue=!0;return this.__iterate((function(v,k,c){if(!predicate.call(context,v,k,c))return returnValue=!1,!1})),returnValue},filter:function(predicate,context){return reify(this,filterFactory(this,predicate,context,!0))},find:function(predicate,context,notSetValue){var entry=this.findEntry(predicate,context);return entry?entry[1]:notSetValue},forEach:function(sideEffect,context){return assertNotInfinite(this.size),this.__iterate(context?sideEffect.bind(context):sideEffect)},join:function(separator){assertNotInfinite(this.size),separator=void 0!==separator?""+separator:",";var joined="",isFirst=!0;return this.__iterate((function(v){isFirst?isFirst=!1:joined+=separator,joined+=null!=v?v.toString():""})),joined},keys:function(){return this.__iterator(ITERATE_KEYS)},map:function(mapper,context){return reify(this,mapFactory(this,mapper,context))},reduce:function(reducer,initialReduction,context){var reduction,useFirst;return assertNotInfinite(this.size),arguments.length<2?useFirst=!0:reduction=initialReduction,this.__iterate((function(v,k,c){useFirst?(useFirst=!1,reduction=v):reduction=reducer.call(context,reduction,v,k,c)})),reduction},reduceRight:function(reducer,initialReduction,context){var reversed=this.toKeyedSeq().reverse();return reversed.reduce.apply(reversed,arguments)},reverse:function(){return reify(this,reverseFactory(this,!0))},slice:function(begin,end){return reify(this,sliceFactory(this,begin,end,!0))},some:function(predicate,context){return!this.every(not(predicate),context)},sort:function(comparator){return reify(this,sortFactory(this,comparator))},values:function(){return this.__iterator(ITERATE_VALUES)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(predicate,context){return ensureSize(predicate?this.toSeq().filter(predicate,context):this)},countBy:function(grouper,context){return countByFactory(this,grouper,context)},equals:function(other){return deepEqual(this,other)},entrySeq:function(){var iterable=this;if(iterable._cache)return new ArraySeq(iterable._cache);var entriesSequence=iterable.toSeq().map(entryMapper).toIndexedSeq();return entriesSequence.fromEntrySeq=function(){return iterable.toSeq()},entriesSequence},filterNot:function(predicate,context){return this.filter(not(predicate),context)},findEntry:function(predicate,context,notSetValue){var found=notSetValue;return this.__iterate((function(v,k,c){if(predicate.call(context,v,k,c))return found=[k,v],!1})),found},findKey:function(predicate,context){var entry=this.findEntry(predicate,context);return entry&&entry[0]},findLast:function(predicate,context,notSetValue){return this.toKeyedSeq().reverse().find(predicate,context,notSetValue)},findLastEntry:function(predicate,context,notSetValue){return this.toKeyedSeq().reverse().findEntry(predicate,context,notSetValue)},findLastKey:function(predicate,context){return this.toKeyedSeq().reverse().findKey(predicate,context)},first:function(){return this.find(returnTrue)},flatMap:function(mapper,context){return reify(this,flatMapFactory(this,mapper,context))},flatten:function(depth){return reify(this,flattenFactory(this,depth,!0))},fromEntrySeq:function(){return new FromEntriesSequence(this)},get:function(searchKey,notSetValue){return this.find((function(_,key){return is(key,searchKey)}),void 0,notSetValue)},getIn:function(searchKeyPath,notSetValue){for(var step,nested=this,iter=forceIterator(searchKeyPath);!(step=iter.next()).done;){var key=step.value;if((nested=nested&&nested.get?nested.get(key,NOT_SET):NOT_SET)===NOT_SET)return notSetValue}return nested},groupBy:function(grouper,context){return groupByFactory(this,grouper,context)},has:function(searchKey){return this.get(searchKey,NOT_SET)!==NOT_SET},hasIn:function(searchKeyPath){return this.getIn(searchKeyPath,NOT_SET)!==NOT_SET},isSubset:function(iter){return iter="function"==typeof iter.includes?iter:Iterable(iter),this.every((function(value){return iter.includes(value)}))},isSuperset:function(iter){return(iter="function"==typeof iter.isSubset?iter:Iterable(iter)).isSubset(this)},keyOf:function(searchValue){return this.findKey((function(value){return is(value,searchValue)}))},keySeq:function(){return this.toSeq().map(keyMapper).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(searchValue){return this.toKeyedSeq().reverse().keyOf(searchValue)},max:function(comparator){return maxFactory(this,comparator)},maxBy:function(mapper,comparator){return maxFactory(this,comparator,mapper)},min:function(comparator){return maxFactory(this,comparator?neg(comparator):defaultNegComparator)},minBy:function(mapper,comparator){return maxFactory(this,comparator?neg(comparator):defaultNegComparator,mapper)},rest:function(){return this.slice(1)},skip:function(amount){return this.slice(Math.max(0,amount))},skipLast:function(amount){return reify(this,this.toSeq().reverse().skip(amount).reverse())},skipWhile:function(predicate,context){return reify(this,skipWhileFactory(this,predicate,context,!0))},skipUntil:function(predicate,context){return this.skipWhile(not(predicate),context)},sortBy:function(mapper,comparator){return reify(this,sortFactory(this,comparator,mapper))},take:function(amount){return this.slice(0,Math.max(0,amount))},takeLast:function(amount){return reify(this,this.toSeq().reverse().take(amount).reverse())},takeWhile:function(predicate,context){return reify(this,takeWhileFactory(this,predicate,context))},takeUntil:function(predicate,context){return this.takeWhile(not(predicate),context)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=hashIterable(this))}});var IterablePrototype=Iterable.prototype;IterablePrototype[IS_ITERABLE_SENTINEL]=!0,IterablePrototype[ITERATOR_SYMBOL]=IterablePrototype.values,IterablePrototype.__toJS=IterablePrototype.toArray,IterablePrototype.__toStringMapper=quoteString,IterablePrototype.inspect=IterablePrototype.toSource=function(){return this.toString()},IterablePrototype.chain=IterablePrototype.flatMap,IterablePrototype.contains=IterablePrototype.includes,mixin(KeyedIterable,{flip:function(){return reify(this,flipFactory(this))},mapEntries:function(mapper,context){var this$0=this,iterations=0;return reify(this,this.toSeq().map((function(v,k){return mapper.call(context,[k,v],iterations++,this$0)})).fromEntrySeq())},mapKeys:function(mapper,context){var this$0=this;return reify(this,this.toSeq().flip().map((function(k,v){return mapper.call(context,k,v,this$0)})).flip())}});var KeyedIterablePrototype=KeyedIterable.prototype;function keyMapper(v,k){return k}function entryMapper(v,k){return[k,v]}function not(predicate){return function(){return!predicate.apply(this,arguments)}}function neg(predicate){return function(){return-predicate.apply(this,arguments)}}function quoteString(value){return"string"==typeof value?JSON.stringify(value):String(value)}function defaultZipper(){return arrCopy(arguments)}function defaultNegComparator(a,b){return a<b?1:a>b?-1:0}function hashIterable(iterable){if(iterable.size===1/0)return 0;var ordered=isOrdered(iterable),keyed=isKeyed(iterable),h=ordered?1:0;return murmurHashOfSize(iterable.__iterate(keyed?ordered?function(v,k){h=31*h+hashMerge(hash(v),hash(k))|0}:function(v,k){h=h+hashMerge(hash(v),hash(k))|0}:ordered?function(v){h=31*h+hash(v)|0}:function(v){h=h+hash(v)|0}),h)}function murmurHashOfSize(size,h){return h=imul(h,3432918353),h=imul(h<<15|h>>>-15,461845907),h=imul(h<<13|h>>>-13,5),h=imul((h=(h+3864292196|0)^size)^h>>>16,2246822507),h=smi((h=imul(h^h>>>13,3266489909))^h>>>16)}function hashMerge(a,b){return a^b+2654435769+(a<<6)+(a>>2)|0}return KeyedIterablePrototype[IS_KEYED_SENTINEL]=!0,KeyedIterablePrototype[ITERATOR_SYMBOL]=IterablePrototype.entries,KeyedIterablePrototype.__toJS=IterablePrototype.toObject,KeyedIterablePrototype.__toStringMapper=function(v,k){return JSON.stringify(k)+": "+quoteString(v)},mixin(IndexedIterable,{toKeyedSeq:function(){return new ToKeyedSequence(this,!1)},filter:function(predicate,context){return reify(this,filterFactory(this,predicate,context,!1))},findIndex:function(predicate,context){var entry=this.findEntry(predicate,context);return entry?entry[0]:-1},indexOf:function(searchValue){var key=this.keyOf(searchValue);return void 0===key?-1:key},lastIndexOf:function(searchValue){var key=this.lastKeyOf(searchValue);return void 0===key?-1:key},reverse:function(){return reify(this,reverseFactory(this,!1))},slice:function(begin,end){return reify(this,sliceFactory(this,begin,end,!1))},splice:function(index,removeNum){var numArgs=arguments.length;if(removeNum=Math.max(0|removeNum,0),0===numArgs||2===numArgs&&!removeNum)return this;index=resolveBegin(index,index<0?this.count():this.size);var spliced=this.slice(0,index);return reify(this,1===numArgs?spliced:spliced.concat(arrCopy(arguments,2),this.slice(index+removeNum)))},findLastIndex:function(predicate,context){var entry=this.findLastEntry(predicate,context);return entry?entry[0]:-1},first:function(){return this.get(0)},flatten:function(depth){return reify(this,flattenFactory(this,depth,!1))},get:function(index,notSetValue){return(index=wrapIndex(this,index))<0||this.size===1/0||void 0!==this.size&&index>this.size?notSetValue:this.find((function(_,key){return key===index}),void 0,notSetValue)},has:function(index){return(index=wrapIndex(this,index))>=0&&(void 0!==this.size?this.size===1/0||index<this.size:-1!==this.indexOf(index))},interpose:function(separator){return reify(this,interposeFactory(this,separator))},interleave:function(){var iterables=[this].concat(arrCopy(arguments)),zipped=zipWithFactory(this.toSeq(),IndexedSeq.of,iterables),interleaved=zipped.flatten(!0);return zipped.size&&(interleaved.size=zipped.size*iterables.length),reify(this,interleaved)},keySeq:function(){return Range(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(predicate,context){return reify(this,skipWhileFactory(this,predicate,context,!1))},zip:function(){return reify(this,zipWithFactory(this,defaultZipper,[this].concat(arrCopy(arguments))))},zipWith:function(zipper){var iterables=arrCopy(arguments);return iterables[0]=this,reify(this,zipWithFactory(this,zipper,iterables))}}),IndexedIterable.prototype[IS_INDEXED_SENTINEL]=!0,IndexedIterable.prototype[IS_ORDERED_SENTINEL]=!0,mixin(SetIterable,{get:function(value,notSetValue){return this.has(value)?value:notSetValue},includes:function(value){return this.has(value)},keySeq:function(){return this.valueSeq()}}),SetIterable.prototype.has=IterablePrototype.includes,SetIterable.prototype.contains=SetIterable.prototype.includes,mixin(KeyedSeq,KeyedIterable.prototype),mixin(IndexedSeq,IndexedIterable.prototype),mixin(SetSeq,SetIterable.prototype),mixin(KeyedCollection,KeyedIterable.prototype),mixin(IndexedCollection,IndexedIterable.prototype),mixin(SetCollection,SetIterable.prototype),{Iterable,Seq,Collection,Map,OrderedMap,List,Stack,Set,OrderedSet,Record,Range,Repeat,is,fromJS}}()},"./node_modules/is-plain-object/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isObject=__webpack_require__("./node_modules/isobject/index.js");function isObjectObject(o){return!0===isObject(o)&&"[object Object]"===Object.prototype.toString.call(o)}module.exports=function isPlainObject(o){var ctor,prot;return!1!==isObjectObject(o)&&("function"==typeof(ctor=o.constructor)&&(!1!==isObjectObject(prot=ctor.prototype)&&!1!==prot.hasOwnProperty("isPrototypeOf")))}},"./node_modules/isobject/index.js":module=>{"use strict";module.exports=function isObject(val){return null!=val&&"object"==typeof val&&!1===Array.isArray(val)}},"./node_modules/lodash/_apply.js":module=>{module.exports=function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}},"./node_modules/lodash/_baseFlatten.js":(module,__unused_webpack_exports,__webpack_require__)=>{var arrayPush=__webpack_require__("./node_modules/lodash/_arrayPush.js"),isFlattenable=__webpack_require__("./node_modules/lodash/_isFlattenable.js");module.exports=function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}},"./node_modules/lodash/_basePick.js":(module,__unused_webpack_exports,__webpack_require__)=>{var basePickBy=__webpack_require__("./node_modules/lodash/_basePickBy.js"),hasIn=__webpack_require__("./node_modules/lodash/hasIn.js");module.exports=function basePick(object,paths){return basePickBy(object,paths,(function(value,path){return hasIn(object,path)}))}},"./node_modules/lodash/_baseSetToString.js":(module,__unused_webpack_exports,__webpack_require__)=>{var constant=__webpack_require__("./node_modules/lodash/constant.js"),defineProperty=__webpack_require__("./node_modules/lodash/_defineProperty.js"),identity=__webpack_require__("./node_modules/lodash/identity.js"),baseSetToString=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity;module.exports=baseSetToString},"./node_modules/lodash/_baseSlice.js":module=>{module.exports=function baseSlice(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),(end=end>length?length:end)<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}},"./node_modules/lodash/_baseUnset.js":(module,__unused_webpack_exports,__webpack_require__)=>{var castPath=__webpack_require__("./node_modules/lodash/_castPath.js"),last=__webpack_require__("./node_modules/lodash/last.js"),parent=__webpack_require__("./node_modules/lodash/_parent.js"),toKey=__webpack_require__("./node_modules/lodash/_toKey.js");module.exports=function baseUnset(object,path){return path=castPath(path,object),null==(object=parent(object,path))||delete object[toKey(last(path))]}},"./node_modules/lodash/_customOmitClone.js":(module,__unused_webpack_exports,__webpack_require__)=>{var isPlainObject=__webpack_require__("./node_modules/lodash/isPlainObject.js");module.exports=function customOmitClone(value){return isPlainObject(value)?void 0:value}},"./node_modules/lodash/_flatRest.js":(module,__unused_webpack_exports,__webpack_require__)=>{var flatten=__webpack_require__("./node_modules/lodash/flatten.js"),overRest=__webpack_require__("./node_modules/lodash/_overRest.js"),setToString=__webpack_require__("./node_modules/lodash/_setToString.js");module.exports=function flatRest(func){return setToString(overRest(func,void 0,flatten),func+"")}},"./node_modules/lodash/_isFlattenable.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Symbol=__webpack_require__("./node_modules/lodash/_Symbol.js"),isArguments=__webpack_require__("./node_modules/lodash/isArguments.js"),isArray=__webpack_require__("./node_modules/lodash/isArray.js"),spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0;module.exports=function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}},"./node_modules/lodash/_overRest.js":(module,__unused_webpack_exports,__webpack_require__)=>{var apply=__webpack_require__("./node_modules/lodash/_apply.js"),nativeMax=Math.max;module.exports=function overRest(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}},"./node_modules/lodash/_parent.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseGet=__webpack_require__("./node_modules/lodash/_baseGet.js"),baseSlice=__webpack_require__("./node_modules/lodash/_baseSlice.js");module.exports=function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}},"./node_modules/lodash/_setToString.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseSetToString=__webpack_require__("./node_modules/lodash/_baseSetToString.js"),setToString=__webpack_require__("./node_modules/lodash/_shortOut.js")(baseSetToString);module.exports=setToString},"./node_modules/lodash/_shortOut.js":module=>{var nativeNow=Date.now;module.exports=function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=800)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}},"./node_modules/lodash/constant.js":module=>{module.exports=function constant(value){return function(){return value}}},"./node_modules/lodash/flatten.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseFlatten=__webpack_require__("./node_modules/lodash/_baseFlatten.js");module.exports=function flatten(array){return(null==array?0:array.length)?baseFlatten(array,1):[]}},"./node_modules/lodash/last.js":module=>{module.exports=function last(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}},"./node_modules/lodash/omit.js":(module,__unused_webpack_exports,__webpack_require__)=>{var arrayMap=__webpack_require__("./node_modules/lodash/_arrayMap.js"),baseClone=__webpack_require__("./node_modules/lodash/_baseClone.js"),baseUnset=__webpack_require__("./node_modules/lodash/_baseUnset.js"),castPath=__webpack_require__("./node_modules/lodash/_castPath.js"),copyObject=__webpack_require__("./node_modules/lodash/_copyObject.js"),customOmitClone=__webpack_require__("./node_modules/lodash/_customOmitClone.js"),flatRest=__webpack_require__("./node_modules/lodash/_flatRest.js"),getAllKeysIn=__webpack_require__("./node_modules/lodash/_getAllKeysIn.js"),omit=flatRest((function(object,paths){var result={};if(null==object)return result;var isDeep=!1;paths=arrayMap(paths,(function(path){return path=castPath(path,object),isDeep||(isDeep=path.length>1),path})),copyObject(object,getAllKeysIn(object),result),isDeep&&(result=baseClone(result,7,customOmitClone));for(var length=paths.length;length--;)baseUnset(result,paths[length]);return result}));module.exports=omit},"./node_modules/lodash/pick.js":(module,__unused_webpack_exports,__webpack_require__)=>{var basePick=__webpack_require__("./node_modules/lodash/_basePick.js"),pick=__webpack_require__("./node_modules/lodash/_flatRest.js")((function(object,paths){return null==object?{}:basePick(object,paths)}));module.exports=pick},"./node_modules/ms/index.js":module=>{var s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d;function plural(ms,msAbs,n,name){var isPlural=msAbs>=1.5*n;return Math.round(ms/n)+" "+name+(isPlural?"s":"")}module.exports=function(val,options){options=options||{};var type=typeof val;if("string"===type&&val.length>0)return function parse(str){if((str=String(str)).length>100)return;var match=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);switch((match[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(val);if("number"===type&&isFinite(val))return options.long?function fmtLong(ms){var msAbs=Math.abs(ms);if(msAbs>=d)return plural(ms,msAbs,d,"day");if(msAbs>=h)return plural(ms,msAbs,h,"hour");if(msAbs>=m)return plural(ms,msAbs,m,"minute");if(msAbs>=s)return plural(ms,msAbs,s,"second");return ms+" ms"}(val):function fmtShort(ms){var msAbs=Math.abs(ms);if(msAbs>=d)return Math.round(ms/d)+"d";if(msAbs>=h)return Math.round(ms/h)+"h";if(msAbs>=m)return Math.round(ms/m)+"m";if(msAbs>=s)return Math.round(ms/s)+"s";return ms+"ms"}(val);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))}},"./node_modules/slate_legacy/lib/slate.es.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B4:()=>Value});var immutable=__webpack_require__("./node_modules/immutable/dist/immutable.js"),is_plain_object=__webpack_require__("./node_modules/is-plain-object/index.js"),is_plain_object_default=__webpack_require__.n(is_plain_object);const tiny_warning_esm=function(condition,message){0};const tiny_invariant_esm=function invariant(condition,message){if(!condition)throw new Error("Invariant failed")};var browser=__webpack_require__("./node_modules/slate_legacy/node_modules/debug/src/browser.js"),browser_default=__webpack_require__.n(browser),esrever=__webpack_require__("./node_modules/esrever/esrever.js"),pick=__webpack_require__("./node_modules/lodash/pick.js"),pick_default=__webpack_require__.n(pick),omit=__webpack_require__("./node_modules/lodash/omit.js"),omit_default=__webpack_require__.n(omit),direction=__webpack_require__("./node_modules/slate_legacy/node_modules/direction/index.js"),direction_default=__webpack_require__.n(direction),n=void 0,generate=void 0;function resetGenerator(){n=0,generate=function generate(){return""+n++}}resetGenerator();var KeyUtils={create:function create(key){if(null==key)return generate();if("string"==typeof key)return key;throw new Error("Keys must be strings, but you passed: "+key)},setGenerator:function setGenerator(func){generate=func},resetGenerator},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),defineProperty=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj},_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},objectWithoutProperties=function(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target},possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},slicedToArray=function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")},toConsumableArray=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)};function compare(path,target){for(var m=min(path,target),i=0;i<m;i++){var pv=path.get(i),tv=target.get(i);if(pv<tv)return-1;if(pv>tv)return 1}return path.size===target.size?0:null}function create$1(attrs){if(null==attrs)return null;if(immutable.List.isList(attrs))return attrs;if(Array.isArray(attrs))return(0,immutable.List)(attrs);throw new Error("Paths can only be created from arrays or lists, but you passed: "+attrs)}function crop(a,b){var size=arguments.length>2&&void 0!==arguments[2]?arguments[2]:min(a,b),ca=a.slice(0,size),cb=b.slice(0,size);return[ca,cb]}function decrement(path){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,index=arguments.length>2&&void 0!==arguments[2]?arguments[2]:path.size-1;return increment(path,0-n,index)}function increment(path){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,index=arguments.length>2&&void 0!==arguments[2]?arguments[2]:path.size-1,value=path.get(index),newValue=value+n,newPath=path.set(index,newValue);return newPath}function isAbove(path,target){var _crop=crop(path,target),_crop2=slicedToArray(_crop,2),p=_crop2[0],t=_crop2[1];return path.size<target.size&&0===compare(p,t)}function isEqual(path,target){return path.equals(target)}function isYounger(path,target){var index=path.size-1,_crop9=crop(path,target,index),_crop10=slicedToArray(_crop9,2),p=_crop10[0],t=_crop10[1],pl=path.get(index),tl=target.get(index);return isEqual(p,t)&&pl<tl}function min(a,b){return Math.min(a.size,b.size)}var PathUtils={compare,create:create$1,crop,decrement,getAncestors:function getAncestors(path){return(0,immutable.List)().withMutations((function(list){for(var i=0;i<path.size;i++)list.push(path.slice(0,i))}))},increment,isAbove,isAfter:function isAfter(path,target){var _crop3=crop(path,target),_crop4=slicedToArray(_crop3,2);return 1===compare(_crop4[0],_crop4[1])},isBefore:function isBefore(path,target){var _crop5=crop(path,target),_crop6=slicedToArray(_crop5,2);return-1===compare(_crop6[0],_crop6[1])},isEqual,isOlder:function isOlder(path,target){var index=path.size-1,_crop7=crop(path,target,index),_crop8=slicedToArray(_crop7,2),p=_crop8[0],t=_crop8[1],pl=path.get(index),tl=target.get(index);return isEqual(p,t)&&pl>tl},isPath:function isPath(any){return(immutable.List.isList(any)||Array.isArray(any))&&any.every((function(n){return"number"==typeof n}))},isSibling:function isSibling(path,target){if(path.size!==target.size)return!1;var p=path.butLast(),t=target.butLast();return p.equals(t)},isYounger,lift:function lift(path){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,ancestor=path.slice(0,-1*n);return ancestor},drop:function drop(path){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,relative=path.slice(n);return relative},max:function max(a,b){return Math.max(a.size,b.size)},min,relate:function relate(a,b){for(var array=[],i=0;i<a.size&&i<b.size;i++){var av=a.get(i);if(av!==b.get(i))break;array.push(av)}return create$1(array)},transform:function transform(path,operation){var type=operation.type,position=operation.position,p=operation.path;if("add_mark"===type||"insert_text"===type||"remove_mark"===type||"remove_text"===type||"set_mark"===type||"set_node"===type||"set_selection"===type||"set_value"===type||"add_annotation"===type||"remove_annotation"===type||"set_annotation"===type||0===path.size)return(0,immutable.List)([path]);var pIndex=p.size-1,pEqual=isEqual(p,path),pYounger=isYounger(p,path),pAbove=isAbove(p,path);if("insert_node"===type&&(pEqual||pYounger||pAbove)&&(path=increment(path,1,pIndex)),"remove_node"===type&&(pYounger?path=decrement(path,1,pIndex):(pEqual||pAbove)&&(path=[])),"merge_node"===type&&(pEqual||pYounger?path=decrement(path,1,pIndex):pAbove&&(path=increment(path=decrement(path,1,pIndex),position,pIndex+1))),"split_node"===type&&(pEqual?path=[path,increment(path)]:pYounger?path=increment(path,1,pIndex):pAbove&&path.get(pIndex+1)>=position&&(path=decrement(path=increment(path,1,pIndex),position,pIndex+1))),"move_node"===type){var np=operation.newPath;if(isEqual(p,np))return(0,immutable.List)([path]);pAbove||pEqual?path=isYounger(p,np)&&p.size<np.size?decrement(np,1,min(np,p)-1).concat(path.slice(p.size)):np.concat(path.slice(p.size)):(pYounger&&(path=decrement(path,1,pIndex)),(isYounger(np,path)||isEqual(np,path)||isAbove(np,path))&&(path=increment(path,1,np.size-1)))}var paths=Array.isArray(path)?path:[path];return(0,immutable.List)(paths)}},DEFAULTS={key:void 0,offset:void 0,path:void 0},Point=function(_Record){function Point(){return classCallCheck(this,Point),possibleConstructorReturn(this,(Point.__proto__||Object.getPrototypeOf(Point)).apply(this,arguments))}return inherits(Point,_Record),createClass(Point,[{key:"isAfterPoint",value:function isAfterPoint(point){return!this.isUnset&&(this.key===point.key&&this.offset>point.offset||1===PathUtils.compare(this.path,point.path))}},{key:"isAfterRange",value:function isAfterRange(range){return!this.isUnset&&this.isAfterPoint(range.end)}},{key:"isAtEndOfRange",value:function isAtEndOfRange(range){return!this.isUnset&&this.equals(range.end)}},{key:"isAtStartOfRange",value:function isAtStartOfRange(range){return!this.isUnset&&this.equals(range.start)}},{key:"isBeforePoint",value:function isBeforePoint(point){return!this.isUnset&&(this.key===point.key&&this.offset<point.offset||-1===PathUtils.compare(this.path,point.path))}},{key:"isBeforeRange",value:function isBeforeRange(range){return!this.isUnset&&this.isBeforePoint(range.start)}},{key:"isInRange",value:function isInRange(range){return!this.isUnset&&(this.equals(range.start)||this.equals(range.end)||this.isAfterPoint(range.start)&&this.isBeforePoint(range.end))}},{key:"isAtEndOfNode",value:function isAtEndOfNode(node){if(this.isUnset)return!1;var last=node.getLastText();return this.key===last.key&&this.offset===last.text.length}},{key:"isAtStartOfNode",value:function isAtStartOfNode(node){if(this.isUnset)return!1;if(0!==this.offset)return!1;var first=node.getFirstText();return this.key===first.key}},{key:"isInNode",value:function isInNode(node){return!this.isUnset&&("text"===node.object&&node.key===this.key||!!node.hasNode(this.key))}},{key:"moveBackward",value:function moveBackward(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(0===n)return this;if(n<0)return this.moveForward(-n);var point=this.setOffset(this.offset-n);return point}},{key:"moveForward",value:function moveForward(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(0===n)return this;if(n<0)return this.moveBackward(-n);var point=this.setOffset(this.offset+n);return point}},{key:"moveTo",value:function moveTo(path){var offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,key=this.key;"number"==typeof path?(offset=path,path=this.path):"string"==typeof path?path=(key=path)===this.key?this.path:null:key=path.equals(this.path)?this.key:null;var point=this.merge({key,path,offset});return point}},{key:"moveToStartOfNode",value:function moveToStartOfNode(node){var first=node.getFirstText();return this.moveTo(first.key,0)}},{key:"moveToEndOfNode",value:function moveToEndOfNode(node){var last=node.getLastText();return this.moveTo(last.key,last.text.length)}},{key:"normalize",value:function normalize(node){if(null==this.key&&null==this.path)return this.setOffset(null);var key=this.key,offset=this.offset,path=this.path,target=path&&node.getNode(path);if(!target&&(target=node.getNode(key)))return this.merge({path:node.getPath(key)});if(!target){tiny_warning_esm(!1,"A point's `path` or `key` invalid and was reset!");var text=node.getFirstText();return text?this.merge({key:text.key,offset:0,path:node.getPath(text.key)}):Point.create()}if("text"!==target.object){tiny_warning_esm(!1,"A point should not reference a non-text node!");var _text=target.getTextAtOffset(offset),before=target.getOffset(_text.key);return this.merge({offset:offset-before,key:_text.key,path:node.getPath(_text.key)})}target&&path&&key&&key!==target.key&&tiny_warning_esm(!1,"A point's `key` did not match its `path`!");var point=this.merge({key:target.key,path:null==path?node.getPath(target.key):path,offset:null==offset?0:Math.min(offset,target.text.length)});if(point.offset===target.text.length){var next=node.getClosestBlock(point.path).getNextText();next&&(point=point.merge({key:next.key,path:node.getPath(next.key),offset:0}))}return point}},{key:"setKey",value:function setKey(key){return null!=key&&(key=KeyUtils.create(key)),this.set("key",key)}},{key:"setOffset",value:function setOffset(offset){return this.set("offset",offset)}},{key:"setPath",value:function setPath(path){return null!=path&&(path=PathUtils.create(path)),this.set("path",path)}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,key:this.key,offset:this.offset,path:this.path&&this.path.toArray()};return options.preserveKeys||delete object.key,object}},{key:"unset",value:function unset(){return this.merge({key:null,offset:null,path:null})}},{key:"isSet",get:function get$$1(){return null!=this.key&&null!=this.offset&&null!=this.path}},{key:"isUnset",get:function get$$1(){return!this.isSet}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Point.isPoint(attrs))return attrs;if(is_plain_object_default()(attrs))return Point.fromJSON(attrs);throw new Error("`Point.create` only accepts objects or points, but you passed it: "+attrs)}},{key:"createProperties",value:function createProperties(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Point.isPoint(a))return{key:a.key,offset:a.offset,path:a.path};if(is_plain_object_default()(a)){var p={};return"key"in a&&(p.key=a.key),"offset"in a&&(p.offset=a.offset),"path"in a&&(p.path=PathUtils.create(a.path)),"path"in a&&!("key"in a)&&(p.key=null),"key"in a&&!("path"in a)&&(p.path=null),p}throw new Error("`Point.createProperties` only accepts objects or points, but you passed it: "+a)}},{key:"fromJSON",value:function fromJSON(object){var _object$key=object.key,key=void 0===_object$key?null:_object$key,_object$offset=object.offset,offset=void 0===_object$offset?null:_object$offset,_object$path=object.path,path=void 0===_object$path?null:_object$path;return new Point({key,offset,path:PathUtils.create(path)})}}]),Point}((0,immutable.Record)(DEFAULTS)),Data=function(){function Data(){classCallCheck(this,Data)}return createClass(Data,null,[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(immutable.Map.isMap(attrs))return attrs;if(is_plain_object_default()(attrs))return Data.fromJSON(attrs);throw new Error("`Data.create` only accepts objects or maps, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(object){return new immutable.Map(object)}}]),Data}();Data.fromJS=Data.fromJSON;var DEFAULTS$1={data:void 0,type:void 0},Mark=function(_Record){function Mark(){return classCallCheck(this,Mark),possibleConstructorReturn(this,(Mark.__proto__||Object.getPrototypeOf(Mark)).apply(this,arguments))}return inherits(Mark,_Record),createClass(Mark,[{key:"toJSON",value:function toJSON(){return{object:this.object,type:this.type,data:this.data.toJSON()}}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Mark.isMark(attrs))return attrs;if("string"==typeof attrs&&(attrs={type:attrs}),is_plain_object_default()(attrs))return Mark.fromJSON(attrs);throw new Error("`Mark.create` only accepts objects, strings or marks, but you passed it: "+attrs)}},{key:"createSet",value:function createSet(elements){if(immutable.Set.isSet(elements)||Array.isArray(elements))return new immutable.Set(elements.map(Mark.create));if(null==elements)return(0,immutable.Set)();throw new Error("`Mark.createSet` only accepts sets, arrays or null, but you passed it: "+elements)}},{key:"createProperties",value:function createProperties(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Mark.isMark(attrs))return{data:attrs.data,type:attrs.type};if("string"==typeof attrs)return{type:attrs};if(is_plain_object_default()(attrs)){var props={};return"type"in attrs&&(props.type=attrs.type),"data"in attrs&&(props.data=Data.create(attrs.data)),props}throw new Error("`Mark.createProperties` only accepts objects, strings or marks, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(object){var _object$data=object.data,data=void 0===_object$data?{}:_object$data,type=object.type;if("string"!=typeof type)throw new Error("`Mark.fromJS` requires a `type` string.");return new Mark({type,data:new immutable.Map(data)})}},{key:"isMarkSet",value:function isMarkSet(any){return immutable.Set.isSet(any)&&any.every((function(item){return Mark.isMark(item)}))}}]),Mark}((0,immutable.Record)(DEFAULTS$1)),DEFAULTS$2={type:void 0,data:void 0,anchor:void 0,focus:void 0},Decoration=function(_Record){function Decoration(){return classCallCheck(this,Decoration),possibleConstructorReturn(this,(Decoration.__proto__||Object.getPrototypeOf(Decoration)).apply(this,arguments))}return inherits(Decoration,_Record),createClass(Decoration,[{key:"setProperties",value:function setProperties(properties){return properties=Decoration.createProperties(properties),this.merge(properties)}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,type:this.type,data:this.data.toJSON(),anchor:this.anchor.toJSON(options),focus:this.focus.toJSON(options)};return object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Decoration.isDecoration(attrs))return attrs;if(Range.isRange(attrs))return Decoration.fromJSON(Range.createProperties(attrs));if(is_plain_object_default()(attrs))return Decoration.fromJSON(attrs);throw new Error("`Decoration.create` only accepts objects or decorations, but you passed it: "+attrs)}},{key:"createList",value:function createList(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(elements)||Array.isArray(elements)){var list=new immutable.List(elements.map(Decoration.create));return list}throw new Error("`Decoration.createList` only accepts arrays or lists, but you passed it: "+elements)}},{key:"createProperties",value:function createProperties(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Decoration.isDecoration(a))return{type:a.type,data:a.data,anchor:Point.createProperties(a.anchor),focus:Point.createProperties(a.focus),mark:Mark.create(a.mark)};if(is_plain_object_default()(a)){var p={};return"type"in a&&(p.type=a.type),"data"in a&&(p.data=Data.create(a.data)),"anchor"in a&&(p.anchor=Point.create(a.anchor)),"focus"in a&&(p.focus=Point.create(a.focus)),p}throw new Error("`Decoration.createProperties` only accepts objects or decorations, but you passed it: "+a)}},{key:"fromJSON",value:function fromJSON(object){var anchor=object.anchor,focus=object.focus,type=object.type,data=object.data;if(object.mark&&!type&&(tiny_warning_esm(!1,"As of slate@0.47 the `decoration.mark` property has been changed to `decoration.type` and `decoration.data` directly."),type=object.mark.type,data=object.mark.data),!type)throw new Error("Decorations must be created with a `type`, but you passed: "+JSON.stringify(object));return new Decoration({type,data:Data.create(data||{}),anchor:Point.fromJSON(anchor||{}),focus:Point.fromJSON(focus||{})})}}]),Decoration}((0,immutable.Record)(DEFAULTS$2)),DEFAULTS$3={anchor:void 0,focus:void 0,isFocused:void 0,marks:void 0},Selection=function(_Record){function Selection(){return classCallCheck(this,Selection),possibleConstructorReturn(this,(Selection.__proto__||Object.getPrototypeOf(Selection)).apply(this,arguments))}return inherits(Selection,_Record),createClass(Selection,[{key:"setIsFocused",value:function setIsFocused(value){return this.set("isFocused",value)}},{key:"setMarks",value:function setMarks(marks){return this.set("marks",marks)}},{key:"setProperties",value:function setProperties(properties){var _properties=properties=Selection.createProperties(properties),anchor=_properties.anchor,focus=_properties.focus,props=objectWithoutProperties(_properties,["anchor","focus"]);return anchor&&(props.anchor=Point.create(anchor)),focus&&(props.focus=Point.create(focus)),this.merge(props)}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,anchor:this.anchor.toJSON(options),focus:this.focus.toJSON(options),isFocused:this.isFocused,marks:null==this.marks?null:this.marks.toArray().map((function(m){return m.toJSON()}))};return object}},{key:"isBlurred",get:function get$$1(){return!this.isFocused}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Selection.isSelection(attrs))return attrs;if(Range.isRange(attrs))return Selection.fromJSON(Range.createProperties(attrs));if(is_plain_object_default()(attrs))return Selection.fromJSON(attrs);throw new Error("`Selection.create` only accepts objects, ranges or selections, but you passed it: "+attrs)}},{key:"createProperties",value:function createProperties(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Selection.isSelection(a))return{anchor:Point.createProperties(a.anchor),focus:Point.createProperties(a.focus),isFocused:a.isFocused,marks:a.marks};if(Range.isRange(a))return{anchor:Point.createProperties(a.anchor),focus:Point.createProperties(a.focus)};if(is_plain_object_default()(a)){var p={};return"anchor"in a&&(p.anchor=Point.create(a.anchor)),"focus"in a&&(p.focus=Point.create(a.focus)),"isFocused"in a&&(p.isFocused=a.isFocused),"marks"in a&&(p.marks=null==a.marks?null:Mark.createSet(a.marks)),p}throw new Error("`Selection.createProperties` only accepts objects, ranges or selections, but you passed it: "+a)}},{key:"fromJSON",value:function fromJSON(object){var anchor=object.anchor,focus=object.focus,_object$isFocused=object.isFocused,isFocused=void 0!==_object$isFocused&&_object$isFocused,_object$marks=object.marks,marks=void 0===_object$marks?null:_object$marks;return new Selection({anchor:Point.fromJSON(anchor||{}),focus:Point.fromJSON(focus||{}),isFocused,marks:null==marks?null:new immutable.Set(marks.map(Mark.fromJSON))})}}]),Selection}((0,immutable.Record)(DEFAULTS$3)),TYPES={annotation:"@@__SLATE_ANNOTATION__@@",block:"@@__SLATE_BLOCK__@@",change:"@@__SLATE_CHANGE__@@",decoration:"@@__SLATE_DECORATION__@@",document:"@@__SLATE_DOCUMENT__@@",editor:"@@__SLATE_EDITOR__@@",inline:"@@__SLATE_INLINE__@@",leaf:"@@__SLATE_LEAF__@@",mark:"@@__SLATE_MARK__@@",operation:"@@__SLATE_OPERATION__@@",point:"@@__SLATE_POINT__@@",range:"@@__SLATE_RANGE__@@",selection:"@@__SLATE_SELECTION__@@",text:"@@__SLATE_TEXT__@@",value:"@@__SLATE_VALUE__@@"};function isObject(type,value){return!(!value||!value[TYPES[type]])}var DEFAULTS$4={anchor:void 0,focus:void 0},Range=function(_Record){function Range(){return classCallCheck(this,Range),possibleConstructorReturn(this,(Range.__proto__||Object.getPrototypeOf(Range)).apply(this,arguments))}return inherits(Range,_Record),createClass(Range,[{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,anchor:this.anchor.toJSON(options),focus:this.focus.toJSON(options)};return object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Range.isRange(attrs))return"range"===attrs.object?attrs:Range.fromJSON(Range.createProperties(attrs));if(is_plain_object_default()(attrs))return Range.fromJSON(attrs);throw new Error("`Range.create` only accepts objects or ranges, but you passed it: "+attrs)}},{key:"createList",value:function createList(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(elements)||Array.isArray(elements)){var list=new immutable.List(elements.map(Range.create));return list}throw new Error("`Range.createList` only accepts arrays or lists, but you passed it: "+elements)}},{key:"createProperties",value:function createProperties(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Range.isRange(a))return{anchor:Point.createProperties(a.anchor),focus:Point.createProperties(a.focus)};if(is_plain_object_default()(a)){var p={};return"anchor"in a&&(p.anchor=Point.create(a.anchor)),"focus"in a&&(p.focus=Point.create(a.focus)),p}throw new Error("`Range.createProperties` only accepts objects, annotations, decorations, ranges or selections, but you passed it: "+a)}},{key:"fromJSON",value:function fromJSON(object){var anchor=object.anchor,focus=object.focus;return new Range({anchor:Point.fromJSON(anchor||{}),focus:Point.fromJSON(focus||{})})}},{key:"isRange",value:function isRange(value){return isObject("range",value)||Decoration.isDecoration(value)||Selection.isSelection(value)}}]),Range}((0,immutable.Record)(DEFAULTS$4)),DEFAULTS$5={key:void 0,type:void 0,data:void 0,anchor:void 0,focus:void 0},Annotation=function(_Record){function Annotation(){return classCallCheck(this,Annotation),possibleConstructorReturn(this,(Annotation.__proto__||Object.getPrototypeOf(Annotation)).apply(this,arguments))}return inherits(Annotation,_Record),createClass(Annotation,[{key:"setProperties",value:function setProperties(properties){return properties=Annotation.createProperties(properties),this.merge(properties)}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,key:this.key,type:this.type,data:this.data.toJSON(),anchor:this.anchor.toJSON(options),focus:this.focus.toJSON(options)};return object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Annotation.isAnnotation(attrs))return attrs;if(Range.isRange(attrs))return Annotation.fromJSON(Range.createProperties(attrs));if(is_plain_object_default()(attrs))return Annotation.fromJSON(attrs);throw new Error("`Annotation.create` only accepts objects or annotations, but you passed it: "+attrs)}},{key:"createMap",value:function createMap(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.Map.isMap(elements))return elements;if(is_plain_object_default()(elements)){var obj={};for(var key in elements){var value=elements[key],annotation=Annotation.create(value);obj[key]=annotation}return(0,immutable.Map)(obj)}throw new Error("`Annotation.createMap` only accepts arrays or lists, but you passed it: "+elements)}},{key:"createProperties",value:function createProperties(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Annotation.isAnnotation(a))return{key:a.key,type:a.type,data:a.data,anchor:Point.createProperties(a.anchor),focus:Point.createProperties(a.focus)};if(is_plain_object_default()(a)){var p={};return"key"in a&&(p.key=a.key),"type"in a&&(p.type=a.type),"data"in a&&(p.data=Data.create(a.data)),"anchor"in a&&(p.anchor=Point.create(a.anchor)),"focus"in a&&(p.focus=Point.create(a.focus)),p}throw new Error("`Annotation.createProperties` only accepts objects or annotations, but you passed it: "+a)}},{key:"fromJSON",value:function fromJSON(object){var key=object.key,type=object.type,data=object.data,anchor=object.anchor,focus=object.focus;if(!key)throw new Error("Annotations must be created with a `key`, but you passed: "+JSON.stringify(object));if(!type)throw new Error("Annotations must be created with a `type`, but you passed: "+JSON.stringify(object));return new Annotation({key,type,data:Data.create(data||{}),anchor:Point.fromJSON(anchor||{}),focus:Point.fromJSON(focus||{})})}}]),Annotation}((0,immutable.Record)(DEFAULTS$5)),DEFAULTS$6={data:void 0,key:void 0,nodes:void 0},Document=function(_Record){function Document(){return classCallCheck(this,Document),possibleConstructorReturn(this,(Document.__proto__||Object.getPrototypeOf(Document)).apply(this,arguments))}return inherits(Document,_Record),createClass(Document,[{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,data:this.data.toJSON(),nodes:this.nodes.toArray().map((function(n){return n.toJSON(options)}))};return options.preserveKeys&&(object.key=this.key),object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Document.isDocument(attrs))return attrs;if((immutable.List.isList(attrs)||Array.isArray(attrs))&&(attrs={nodes:attrs}),is_plain_object_default()(attrs))return Document.fromJSON(attrs);throw new Error("`Document.create` only accepts objects, arrays, lists or documents, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(object){if(Document.isDocument(object))return object;var _object$data=object.data,data=void 0===_object$data?{}:_object$data,_object$key=object.key,key=void 0===_object$key?KeyUtils.create():_object$key,_object$nodes=object.nodes,nodes=void 0===_object$nodes?[]:_object$nodes;return new Document({key,data:new immutable.Map(data),nodes:Node.createList(nodes)})}}]),Document}((0,immutable.Record)(DEFAULTS$6)),DEFAULTS$7={data:void 0,key:void 0,nodes:void 0,type:void 0},Inline=function(_Record){function Inline(){return classCallCheck(this,Inline),possibleConstructorReturn(this,(Inline.__proto__||Object.getPrototypeOf(Inline)).apply(this,arguments))}return inherits(Inline,_Record),createClass(Inline,[{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,type:this.type,data:this.data.toJSON(),nodes:this.nodes.toArray().map((function(n){return n.toJSON(options)}))};return options.preserveKeys&&(object.key=this.key),object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Inline.isInline(attrs))return attrs;if("string"==typeof attrs&&(attrs={type:attrs}),is_plain_object_default()(attrs))return Inline.fromJSON(attrs);throw new Error("`Inline.create` only accepts objects, strings or inlines, but you passed it: "+attrs)}},{key:"createList",value:function createList(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(elements)||Array.isArray(elements)){var list=new immutable.List(elements.map(Inline.create));return list}throw new Error("`Inline.createList` only accepts arrays or lists, but you passed it: "+elements)}},{key:"fromJSON",value:function fromJSON(object){if(Inline.isInline(object))return object;var _object$data=object.data,data=void 0===_object$data?{}:_object$data,_object$key=object.key,key=void 0===_object$key?KeyUtils.create():_object$key,_object$nodes=object.nodes,nodes=void 0===_object$nodes?[]:_object$nodes,type=object.type;if("string"!=typeof type)throw new Error("`Inline.fromJS` requires a `type` string.");return new Inline({key,type,data:new immutable.Map(data),nodes:Node.createList(nodes)})}},{key:"isInlineList",value:function isInlineList(any){return immutable.List.isList(any)&&any.every((function(item){return Inline.isInline(item)}))}}]),Inline}((0,immutable.Record)(DEFAULTS$7)),DEFAULTS$8={key:void 0,marks:void 0,text:void 0},Leaf=(0,immutable.Record)({text:void 0,marks:void 0,annotations:void 0,decorations:void 0}),Text=function(_Record){function Text(){return classCallCheck(this,Text),possibleConstructorReturn(this,(Text.__proto__||Object.getPrototypeOf(Text)).apply(this,arguments))}return inherits(Text,_Record),createClass(Text,[{key:"addMark",value:function addMark(mark){mark=Mark.create(mark);var next=this.marks.add(mark);return this.set("marks",next)}},{key:"addMarks",value:function addMarks(marks){return marks=Mark.createSet(marks),this.set("marks",this.marks.union(marks))}},{key:"getLeaves",value:function getLeaves(annotations,decorations){var leaves=[{text:this.text,marks:this.marks,annotations:[],decorations:[]}],split=function split(leaf,at){return[{text:leaf.text.slice(0,at),marks:leaf.marks,annotations:[].concat(toConsumableArray(leaf.annotations)),decorations:[].concat(toConsumableArray(leaf.decorations))},{text:leaf.text.slice(at),marks:leaf.marks,annotations:[].concat(toConsumableArray(leaf.annotations)),decorations:[].concat(toConsumableArray(leaf.decorations))}]},compile=function compile(kind){var formats="annotations"===kind?annotations.values():decorations,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=formats[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var format=_step.value,start=format.start,end=format.end,next=[],o=0,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=leaves[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var leaf=_step2.value,length=leaf.text.length,offset=o;if(o+=length,start.offset<=offset&&end.offset>=offset+length)leaf[kind].push(format),next.push(leaf);else if(start.offset>offset+length||end.offset<offset||end.offset===offset&&0!==offset)next.push(leaf);else{var middle=leaf,before=void 0,after=void 0;if(end.offset<offset+length){var _split=split(middle,end.offset-offset),_split2=slicedToArray(_split,2);middle=_split2[0],after=_split2[1]}if(start.offset>offset){var _split3=split(middle,start.offset-offset),_split4=slicedToArray(_split3,2);before=_split4[0],middle=_split4[1]}middle[kind].push(format),before&&next.push(before),next.push(middle),after&&next.push(after)}}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}leaves=next}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}};return compile("annotations"),compile("decorations"),leaves=leaves.map((function(leaf){return new Leaf(_extends({},leaf,{annotations:(0,immutable.List)(leaf.annotations),decorations:(0,immutable.List)(leaf.decorations)}))})),(0,immutable.List)(leaves)}},{key:"insertText",value:function insertText(index,string){var text=this.text,next=text.slice(0,index)+string+text.slice(index);return this.set("text",next)}},{key:"removeMark",value:function removeMark(mark){mark=Mark.create(mark);var next=this.marks.remove(mark);return this.set("marks",next)}},{key:"removeText",value:function removeText(index,length){var text=this.text,next=text.slice(0,index)+text.slice(index+length);return this.set("text",next)}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,text:this.text,marks:this.marks.toArray().map((function(m){return m.toJSON()}))};return options.preserveKeys&&(object.key=this.key),object}},{key:"setMark",value:function setMark(properties,newProperties){var marks=this.marks,mark=Mark.create(properties),newMark=mark.merge(newProperties),next=marks.remove(mark).add(newMark);return this.set("marks",next)}},{key:"splitText",value:function splitText(index){var text=this.text;return[this.set("text",text.slice(0,index)),this.set("text",text.slice(index)).regenerateKey()]}},{key:"mergeText",value:function mergeText(other){var next=this.text+other.text;return this.set("text",next)}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(Text.isText(attrs))return attrs;if("string"==typeof attrs&&(attrs={text:attrs}),is_plain_object_default()(attrs))return Text.fromJSON(attrs);throw new Error("`Text.create` only accepts objects, arrays, strings or texts, but you passed it: "+attrs)}},{key:"createList",value:function createList(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(elements)||Array.isArray(elements)){var list=new immutable.List(elements.map(Text.create));return list}throw new Error("`Text.createList` only accepts arrays or lists, but you passed it: "+elements)}},{key:"fromJSON",value:function fromJSON(object){if(Text.isText(object))return object;tiny_invariant_esm(null==object.leaves,"As of slate@0.46, the `leaves` property of text nodes has been removed! Each individual leaf should be created as a text node instead.");var _object$text=object.text,text=void 0===_object$text?"":_object$text,_object$marks=object.marks,marks=void 0===_object$marks?[]:_object$marks,_object$key=object.key;return new Text({key:void 0===_object$key?KeyUtils.create():_object$key,text,marks:Mark.createSet(marks)})}},{key:"isTextList",value:function isTextList(any){return immutable.List.isList(any)&&any.every((function(item){return Text.isText(item)}))}}]),Text}((0,immutable.Record)(DEFAULTS$8)),Node=function(){function Node(){classCallCheck(this,Node)}return createClass(Node,null,[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Node.isNode(attrs))return attrs;if(is_plain_object_default()(attrs)){var object=attrs.object;switch(!object&&attrs.kind&&(tiny_warning_esm(!1,"As of slate@0.32.0, the `kind` property of Slate objects has been renamed to `object`."),object=attrs.kind),object){case"block":return Block.create(attrs);case"document":return Document.create(attrs);case"inline":return Inline.create(attrs);case"text":return Text.create(attrs);default:throw new Error("`Node.create` requires a `object` string.")}}throw new Error("`Node.create` only accepts objects or nodes but you passed it: "+attrs)}},{key:"createList",value:function createList(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(elements)||Array.isArray(elements)){var array=[];elements.forEach((function(el){if(el&&"text"===el.object&&el.leaves&&Array.isArray(el.leaves)){tiny_warning_esm(!1,"As of slate@0.46, the `leaves` property of Text nodes has been removed. Instead, each text node contains a string of text and a unique set of marks and leaves are unnecessary.");var texts=Text.createList(el.leaves).toArray();array=array.concat(texts)}else{var node=Node.create(el);array.push(node)}}));var list=(0,immutable.List)(array);return list}throw new Error("`Node.createList` only accepts lists or arrays, but you passed it: "+elements)}},{key:"createProperties",value:function createProperties(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Block.isBlock(attrs)||Inline.isInline(attrs))return{data:attrs.data,type:attrs.type};if("string"==typeof attrs)return{type:attrs};if(is_plain_object_default()(attrs)){var props={};return"type"in attrs&&(props.type=attrs.type),"data"in attrs&&(props.data=Data.create(attrs.data)),props}throw new Error("`Node.createProperties` only accepts objects, strings, blocks or inlines, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(value){var object=value.object;switch(!object&&value.kind&&(tiny_warning_esm(!1,"As of slate@0.32.0, the `kind` property of Slate objects has been renamed to `object`."),object=value.kind),object){case"block":return Block.fromJSON(value);case"document":return Document.fromJSON(value);case"inline":return Inline.fromJSON(value);case"text":return Text.fromJSON(value);default:throw new Error("`Node.fromJSON` requires an `object` of either 'block', 'document', 'inline' or 'text', but you passed: "+value)}}},{key:"isNode",value:function isNode(any){return Block.isBlock(any)||Document.isDocument(any)||Inline.isInline(any)||Text.isText(any)}},{key:"isNodeList",value:function isNodeList(any){return immutable.List.isList(any)&&any.every((function(item){return Node.isNode(item)}))}}]),Node}(),DEFAULTS$9={data:void 0,key:void 0,nodes:void 0,type:void 0},Block=function(_Record){function Block(){return classCallCheck(this,Block),possibleConstructorReturn(this,(Block.__proto__||Object.getPrototypeOf(Block)).apply(this,arguments))}return inherits(Block,_Record),createClass(Block,[{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,type:this.type,data:this.data.toJSON(),nodes:this.nodes.toArray().map((function(n){return n.toJSON(options)}))};return options.preserveKeys&&(object.key=this.key),object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Block.isBlock(attrs))return attrs;if("string"==typeof attrs&&(attrs={type:attrs}),is_plain_object_default()(attrs))return Block.fromJSON(attrs);throw new Error("`Block.create` only accepts objects, strings or blocks, but you passed it: "+attrs)}},{key:"createList",value:function createList(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(attrs)||Array.isArray(attrs)){var list=new immutable.List(attrs.map(Block.create));return list}throw new Error("`Block.createList` only accepts arrays or lists, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(object){if(Block.isBlock(object))return object;var _object$data=object.data,data=void 0===_object$data?{}:_object$data,_object$key=object.key,key=void 0===_object$key?KeyUtils.create():_object$key,_object$nodes=object.nodes,nodes=void 0===_object$nodes?[]:_object$nodes,type=object.type;if("string"!=typeof type)throw new Error("`Block.fromJSON` requires a `type` string.");return new Block({key,type,data:(0,immutable.Map)(data),nodes:Node.createList(nodes)})}},{key:"isBlockList",value:function isBlockList(any){return immutable.List.isList(any)&&any.every((function(item){return Block.isBlock(item)}))}}]),Block}((0,immutable.Record)(DEFAULTS$9)),DEFAULTS$10={annotations:void 0,data:void 0,document:void 0,selection:void 0},Value=function(_Record){function Value(){return classCallCheck(this,Value),possibleConstructorReturn(this,(Value.__proto__||Object.getPrototypeOf(Value)).apply(this,arguments))}return inherits(Value,_Record),createClass(Value,[{key:"addAnnotation",value:function addAnnotation(annotation){annotation=Annotation.create(annotation);var value=this,_value=value,annotations=_value.annotations,document=_value.document,key=annotation.key;return annotation=annotation.updatePoints((function(point){return point.normalize(document)})),annotations=annotations.set(key,annotation),value=value.set("annotations",annotations)}},{key:"addMark",value:function addMark(path,mark){mark=Mark.create(mark);var value=this,document=value.document;return document=document.addMark(path,mark),value=value.set("document",document)}},{key:"insertNode",value:function insertNode(path,node){var value=this,document=value.document;return document=document.insertNode(path,node),value=(value=value.set("document",document)).mapRanges((function(range){return range.updatePoints((function(point){return point.setPath(null)}))}))}},{key:"insertText",value:function insertText(path,offset,text){var value=this,document=value.document,node=document.assertNode(path);return document=document.insertText(path,offset,text),node=document.assertNode(path),value=(value=value.set("document",document)).mapPoints((function(point){return point.key===node.key&&point.offset>=offset?point.setOffset(point.offset+text.length):point}))}},{key:"mergeNode",value:function mergeNode(path){var value=this,document=value.document,newDocument=document.mergeNode(path);path=document.resolvePath(path);var withPath=PathUtils.decrement(path),one=document.getNode(withPath),two=document.getNode(path);return value=(value=value.set("document",newDocument)).mapRanges((function(range){if("text"===two.object){var max=one.text.length;range.anchor.key===two.key&&(range=range.moveAnchorTo(one.key,max+range.anchor.offset)),range.focus.key===two.key&&(range=range.moveFocusTo(one.key,max+range.focus.offset))}return range=range.updatePoints((function(point){return point.setPath(null)}))})),value}},{key:"moveNode",value:function moveNode(path,newPath){var newIndex=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,value=this,_value6=value,document=_value6.document;return PathUtils.isEqual(path,newPath)?value:(document=document.moveNode(path,newPath,newIndex),value=(value=value.set("document",document)).mapPoints((function(point){return point.setPath(null)})))}},{key:"removeAnnotation",value:function removeAnnotation(annotation){annotation=Annotation.create(annotation);var value=this,annotations=value.annotations,key=annotation.key;return annotations=annotations.delete(key),value=value.set("annotations",annotations)}},{key:"removeMark",value:function removeMark(path,mark){mark=Mark.create(mark);var value=this,document=value.document;return document=document.removeMark(path,mark),value=value.set("document",document)}},{key:"removeNode",value:function removeNode(path){var value=this,document=value.document,node=document.assertNode(path),first="text"===node.object?node:node.getFirstText()||node,last="text"===node.object?node:node.getLastText()||node,prev=document.getPreviousText(first.key),next=document.getNextText(last.key);return document=document.removeNode(path),value=(value=value.set("document",document)).mapRanges((function(range){var _range=range,anchor=_range.anchor,focus=_range.focus;return node.hasNode(anchor.key)&&(range=prev?range.moveAnchorTo(prev.key,prev.text.length):next?range.moveAnchorTo(next.key,0):range.unset()),node.hasNode(focus.key)&&(range=prev?range.moveFocusTo(prev.key,prev.text.length):next?range.moveFocusTo(next.key,0):range.unset()),range=range.updatePoints((function(point){return point.setPath(null)}))}))}},{key:"removeText",value:function removeText(path,offset,text){var value=this,document=value.document,node=document.assertNode(path);document=document.removeText(path,offset,text),value=value.set("document",document);var length=text.length,start=offset,end=offset+length;return value=value.mapPoints((function(point){return point.key!==node.key?point:point.offset>=end?point.setOffset(point.offset-length):point.offset>start?point.setOffset(start):point}))}},{key:"setAnnotation",value:function setAnnotation(properties,newProperties){newProperties=Annotation.createProperties(newProperties);var annotation=Annotation.create(properties),next=annotation.merge(newProperties),value=this,annotations=value.annotations,key=annotation.key;return annotations=annotations.set(key,next),value=value.set("annotations",annotations)}},{key:"setNode",value:function setNode(path,properties){var value=this,document=value.document;return document=document.setNode(path,properties),value=value.set("document",document)}},{key:"setMark",value:function setMark(path,mark,properties){var value=this,document=value.document;return document=document.setMark(path,mark,properties),value=value.set("document",document)}},{key:"setProperties",value:function setProperties(properties){var value=this,document=value.document,data=properties.data,annotations=properties.annotations,props={};return data&&(props.data=data),annotations&&(props.annotations=annotations.map((function(a){return a.isSet?a:document.resolveAnnotation(a)}))),value=value.merge(props)}},{key:"setSelection",value:function setSelection(properties){var value=this,_value15=value,document=_value15.document,selection=_value15.selection,next=selection.setProperties(properties);return selection=document.resolveSelection(next),value=value.set("selection",selection)}},{key:"splitNode",value:function splitNode(path,position,properties){var value=this,document=value.document,newDocument=document.splitNode(path,position,properties),node=document.assertNode(path);return value=(value=value.set("document",newDocument)).mapRanges((function(range){var next=newDocument.getNextText(node.key),_range2=range,anchor=_range2.anchor,focus=_range2.focus;return node.key===anchor.key&&position<=anchor.offset&&(range=range.moveAnchorTo(next.key,anchor.offset-position)),node.key===focus.key&&position<=focus.offset&&(range=range.moveFocusTo(next.key,focus.offset-position)),range=range.updatePoints((function(point){return point.setPath(null)}))}))}},{key:"mapRanges",value:function mapRanges(iterator){var value=this,_value17=value,document=_value17.document,selection=_value17.selection,annotations=_value17.annotations,sel=selection.isSet?iterator(selection):selection;sel||(sel=selection.unset()),sel!==selection&&(sel=document.createSelection(sel)),value=value.set("selection",sel);var anns=annotations.map((function(annotation){var n=annotation.isSet?iterator(annotation):annotation;return n&&n!==annotation&&(n=document.createAnnotation(n)),n}));return anns=anns.filter((function(annotation){return!!annotation})),value=value.set("annotations",anns)}},{key:"mapPoints",value:function mapPoints(iterator){return this.mapRanges((function(range){return range.updatePoints(iterator)}))}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,document:this.document.toJSON(options)};return options.preserveData&&(object.data=this.data.toJSON(options)),options.preserveAnnotations&&(object.annotations=this.annotations.map((function(a){return a.toJSON(options)})).toObject()),options.preserveSelection&&(object.selection=this.selection.toJSON(options)),object}},{key:"change",value:function change(){tiny_invariant_esm(!1,"As of Slate 0.42.0, value object are no longer schema-aware, and the `value.change()` method is no longer available. Use the `editor.change()` method on the new `Editor` controller instead.")}},{key:"startBlock",get:function get$$1(){return this.selection.start.key&&this.document.getClosestBlock(this.selection.start.key)}},{key:"endBlock",get:function get$$1(){return this.selection.end.key&&this.document.getClosestBlock(this.selection.end.key)}},{key:"anchorBlock",get:function get$$1(){return this.selection.anchor.key&&this.document.getClosestBlock(this.selection.anchor.key)}},{key:"focusBlock",get:function get$$1(){return this.selection.focus.key&&this.document.getClosestBlock(this.selection.focus.key)}},{key:"startInline",get:function get$$1(){return this.selection.start.key&&this.document.getClosestInline(this.selection.start.key)}},{key:"endInline",get:function get$$1(){return this.selection.end.key&&this.document.getClosestInline(this.selection.end.key)}},{key:"anchorInline",get:function get$$1(){return this.selection.anchor.key&&this.document.getClosestInline(this.selection.anchor.key)}},{key:"focusInline",get:function get$$1(){return this.selection.focus.key&&this.document.getClosestInline(this.selection.focus.key)}},{key:"startText",get:function get$$1(){return this.selection.start.key&&this.document.getDescendant(this.selection.start.key)}},{key:"endText",get:function get$$1(){return this.selection.end.key&&this.document.getDescendant(this.selection.end.key)}},{key:"anchorText",get:function get$$1(){return this.selection.anchor.key&&this.document.getDescendant(this.selection.anchor.key)}},{key:"focusText",get:function get$$1(){return this.selection.focus.key&&this.document.getDescendant(this.selection.focus.key)}},{key:"nextBlock",get:function get$$1(){return this.selection.end.key&&this.document.getNextBlock(this.selection.end.key)}},{key:"previousBlock",get:function get$$1(){return this.selection.start.key&&this.document.getPreviousBlock(this.selection.start.key)}},{key:"nextInline",get:function get$$1(){return this.selection.end.key&&this.document.getNextInline(this.selection.end.key)}},{key:"previousInline",get:function get$$1(){return this.selection.start.key&&this.document.getPreviousInline(this.selection.start.key)}},{key:"nextText",get:function get$$1(){return this.selection.end.key&&this.document.getNextText(this.selection.end.key)}},{key:"previousText",get:function get$$1(){return this.selection.start.key&&this.document.getPreviousText(this.selection.start.key)}},{key:"marks",get:function get$$1(){return this.selection.isUnset?new immutable.Set:this.selection.marks||this.document.getMarksAtRange(this.selection)}},{key:"activeMarks",get:function get$$1(){return this.selection.isUnset?new immutable.Set:this.selection.marks||this.document.getActiveMarksAtRange(this.selection)}},{key:"blocks",get:function get$$1(){return this.selection.isUnset?new immutable.List:this.document.getLeafBlocksAtRange(this.selection)}},{key:"fragment",get:function get$$1(){return this.selection.isUnset?Document.create():this.document.getFragmentAtRange(this.selection)}},{key:"inlines",get:function get$$1(){return this.selection.isUnset?new immutable.List:this.document.getLeafInlinesAtRange(this.selection)}},{key:"texts",get:function get$$1(){return this.selection.isUnset?new immutable.List:this.document.getTextsAtRange(this.selection)}},{key:"history",get:function get$$1(){tiny_invariant_esm(!1,"As of Slate 0.42.0, the `value.history` model no longer exists, and the history is stored in `value.data` instead using plugins.")}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Value.isValue(attrs))return attrs;if(is_plain_object_default()(attrs))return Value.fromJSON(attrs,options);throw new Error("`Value.create` only accepts objects or values, but you passed it: "+attrs)}},{key:"createProperties",value:function createProperties(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Value.isValue(a))return{annotations:a.annotations,data:a.data};if(is_plain_object_default()(a)){var p={};return"annotations"in a&&(p.annotations=Annotation.createMap(a.annotations)),"data"in a&&(p.data=Data.create(a.data)),p}throw new Error("`Value.createProperties` only accepts objects or values, but you passed it: "+a)}},{key:"fromJSON",value:function fromJSON(object){var _object$data=object.data,data=void 0===_object$data?{}:_object$data,_object$annotations=object.annotations,annotations=void 0===_object$annotations?{}:_object$annotations,_object$document=object.document,document=void 0===_object$document?{}:_object$document,_object$selection=object.selection,selection=void 0===_object$selection?{}:_object$selection;if(data=Data.fromJSON(data),selection=(document=Document.fromJSON(document)).createSelection(selection),annotations=Annotation.createMap(annotations),selection.isUnset){var text=document.getFirstText();text&&(selection=selection.moveToStartOfNode(text)),selection=document.createSelection(selection)}return new Value({annotations,data,document,selection})}}]),Value}((0,immutable.Record)(DEFAULTS$10)),debug=browser_default()("slate:operation:apply");function applyOperation(value,op){var type=(op=Operation.create(op)).type;switch(debug(type,op),type){case"add_annotation":var annotation=op.annotation;return value.addAnnotation(annotation);case"add_mark":var _op3=op,path=_op3.path,mark=_op3.mark;return value.addMark(path,mark);case"insert_node":var _op4=op,_path=_op4.path,node=_op4.node;return value.insertNode(_path,node);case"insert_text":var _op5=op,_path2=_op5.path,offset=_op5.offset,text=_op5.text,marks=_op5.marks;return value.insertText(_path2,offset,text,marks);case"merge_node":var _path3=op.path;return value.mergeNode(_path3);case"move_node":var _op7=op,_path4=_op7.path,newPath=_op7.newPath;return value.moveNode(_path4,newPath);case"remove_annotation":var _annotation=op.annotation;return value.removeAnnotation(_annotation);case"remove_mark":var _op9=op,_path5=_op9.path,_mark=_op9.mark;return value.removeMark(_path5,_mark);case"remove_node":var _path6=op.path;return value.removeNode(_path6);case"remove_text":var _op11=op,_path7=_op11.path,_offset=_op11.offset,_text=_op11.text;return value.removeText(_path7,_offset,_text);case"set_annotation":var _op12=op,properties=_op12.properties,newProperties=_op12.newProperties;return value.setAnnotation(properties,newProperties);case"set_mark":var _op13=op,_path8=_op13.path,_properties=_op13.properties,_newProperties=_op13.newProperties;return value.setMark(_path8,_properties,_newProperties);case"set_node":var _op14=op,_path9=_op14.path,_newProperties2=_op14.newProperties;return value.setNode(_path9,_newProperties2);case"set_selection":var _newProperties3=op.newProperties;return value.setSelection(_newProperties3);case"set_value":var _newProperties4=op.newProperties;return value.setProperties(_newProperties4);case"split_node":var _op17=op,_path10=_op17.path,position=_op17.position,_properties2=_op17.properties;return value.splitNode(_path10,position,_properties2);default:throw new Error('Unknown operation type: "'+type+'".')}}var debug$1=browser_default()("slate:operation:invert");function invertOperation(op){var type=(op=Operation.create(op)).type;switch(debug$1(type,op),type){case"move_node":var _op2=op,newPath=_op2.newPath,path=_op2.path;if(PathUtils.isEqual(newPath,path))return op;var inversePath=PathUtils.transform(path,op).first(),inverseNewPath=PathUtils.transform(PathUtils.increment(path),op).first();return op.set("path",inversePath).set("newPath",inverseNewPath);case"merge_node":var _path=op.path,_inversePath=PathUtils.decrement(_path);return op.set("type","split_node").set("path",_inversePath);case"split_node":var _path2=op.path,_inversePath2=PathUtils.increment(_path2);return op.set("type","merge_node").set("path",_inversePath2);case"set_annotation":case"set_node":case"set_value":case"set_selection":case"set_mark":var _op5=op,properties=_op5.properties,newProperties=_op5.newProperties;return op.set("properties",newProperties).set("newProperties",properties);case"insert_node":case"insert_text":return op.set("type",type.replace("insert_","remove_"));case"remove_node":case"remove_text":return op.set("type",type.replace("remove_","insert_"));case"add_annotation":case"add_mark":return op.set("type",type.replace("add_","remove_"));case"remove_annotation":case"remove_mark":return op.set("type",type.replace("remove_","add_"));default:throw new Error('Unknown operation type: "'+type+'".')}}var OPERATION_ATTRIBUTES={add_mark:["path","mark","data"],add_annotation:["annotation","data"],insert_node:["path","node","data"],insert_text:["path","offset","text","data"],merge_node:["path","position","properties","target","data"],move_node:["path","newPath","data"],remove_annotation:["annotation","data"],remove_mark:["path","mark","data"],remove_node:["path","node","data"],remove_text:["path","offset","text","data"],set_annotation:["properties","newProperties","data"],set_mark:["path","properties","newProperties","data"],set_node:["path","properties","newProperties","data"],set_selection:["properties","newProperties","data"],set_value:["properties","newProperties","data"],split_node:["path","position","properties","target","data"]},DEFAULTS$11={annotation:void 0,data:void 0,length:void 0,mark:void 0,marks:void 0,newPath:void 0,newProperties:void 0,node:void 0,offset:void 0,path:void 0,position:void 0,properties:void 0,target:void 0,text:void 0,type:void 0},Operation=function(_Record){function Operation(){return classCallCheck(this,Operation),possibleConstructorReturn(this,(Operation.__proto__||Object.getPrototypeOf(Operation)).apply(this,arguments))}return inherits(Operation,_Record),createClass(Operation,[{key:"apply",value:function apply(value){return applyOperation(value,this)}},{key:"invert",value:function invert(){return invertOperation(this)}},{key:"toJSON",value:function toJSON(){var object=this.object,type=this.type,json={object,type},ATTRIBUTES=OPERATION_ATTRIBUTES[type],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=ATTRIBUTES[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var key=_step.value,value=this[key];if("annotation"!==key&&"mark"!==key&&"marks"!==key&&"node"!==key&&"path"!==key&&"newPath"!==key||(value=value.toJSON()),"properties"===key&&"merge_node"===type){var v={};"data"in value&&(v.data=value.data.toJS()),"type"in value&&(v.type=value.type),value=v}if(("properties"===key||"newProperties"===key)&&"set_annotation"===type){var _v={};"anchor"in value&&(_v.anchor=value.anchor.toJS()),"focus"in value&&(_v.focus=value.focus.toJS()),"key"in value&&(_v.key=value.key),"data"in value&&(_v.data=value.data.toJS()),"type"in value&&(_v.type=value.type),value=_v}if(("properties"===key||"newProperties"===key)&&"set_mark"===type){var _v2={};"data"in value&&(_v2.data=value.data.toJS()),"type"in value&&(_v2.type=value.type),value=_v2}if(("properties"===key||"newProperties"===key)&&"set_node"===type){var _v3={};"data"in value&&(_v3.data=value.data.toJS()),"type"in value&&(_v3.type=value.type),value=_v3}if(("properties"===key||"newProperties"===key)&&"set_selection"===type){var _v4={};"anchor"in value&&(_v4.anchor=value.anchor.toJSON()),"focus"in value&&(_v4.focus=value.focus.toJSON()),"isFocused"in value&&(_v4.isFocused=value.isFocused),"marks"in value&&(_v4.marks=value.marks&&value.marks.toJSON()),value=_v4}if(("properties"===key||"newProperties"===key)&&"set_value"===type){var _v5={};"data"in value&&(_v5.data=value.data.toJS()),value=_v5}if("properties"===key&&"split_node"===type){var _v6={};"data"in value&&(_v6.data=value.data.toJS()),"type"in value&&(_v6.type=value.type),value=_v6}"data"===key&&(value=value.toJSON()),json[key]=value}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return json}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Operation.isOperation(attrs))return attrs;if(is_plain_object_default()(attrs))return Operation.fromJSON(attrs);throw new Error("`Operation.create` only accepts objects or operations, but you passed it: "+attrs)}},{key:"createList",value:function createList(){var elements=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(elements)||Array.isArray(elements)){var list=new immutable.List(elements.map(Operation.create));return list}throw new Error("`Operation.createList` only accepts arrays or lists, but you passed it: "+elements)}},{key:"fromJSON",value:function fromJSON(object){if(Operation.isOperation(object))return object;var type=object.type,ATTRIBUTES=OPERATION_ATTRIBUTES[type],attrs={type};if(!ATTRIBUTES)throw new Error('`Operation.fromJSON` was passed an unrecognized operation type: "'+type+'"');var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=ATTRIBUTES[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var key=_step2.value,v=object[key];if("data"===key&&void 0===v&&(v={}),void 0===v)throw new Error('`Operation.fromJSON` was passed a "'+type+'" operation without the required "'+key+'" attribute.');"annotation"===key&&(v=Annotation.create(v)),"path"!==key&&"newPath"!==key||(v=PathUtils.create(v)),"mark"===key&&(v=Mark.create(v)),"node"===key&&(v=Node.create(v)),"properties"!==key&&"newProperties"!==key||"set_annotation"!==type||(v=Annotation.createProperties(v)),"properties"!==key&&"newProperties"!==key||"set_mark"!==type||(v=Mark.createProperties(v)),"properties"!==key&&"newProperties"!==key||"set_node"!==type&&"merge_node"!==type&&"split_node"!==type||(v=Node.createProperties(v)),"properties"!==key&&"newProperties"!==key||"set_selection"!==type||(v=Selection.createProperties(v)),"properties"!==key&&"newProperties"!==key||"set_value"!==type||(v=Value.createProperties(v)),"data"===key&&(v=(0,immutable.Map)(v)),attrs[key]=v}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return new Operation(attrs)}},{key:"isOperationList",value:function isOperationList(any){return immutable.List.isList(any)&&any.every((function(item){return Operation.isOperation(item)}))}}]),Operation}((0,immutable.Record)(DEFAULTS$11)),DEFAULTS$12={operations:void 0,value:void 0},Change=function(_Record){function Change(){return classCallCheck(this,Change),possibleConstructorReturn(this,(Change.__proto__||Object.getPrototypeOf(Change)).apply(this,arguments))}return inherits(Change,_Record),createClass(Change,[{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,value:this.value.toJSON(options),operations:this.operations.toArray().map((function(o){return o.toJSON(options)}))};return object}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Change.isChange(attrs))return attrs;if(is_plain_object_default()(attrs))return Change.fromJSON(attrs);throw new Error("`Change.create` only accepts objects or changes, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(object){var value=object.value,_object$operations=object.operations,operations=void 0===_object$operations?[]:_object$operations;return new Change({value:Value.create(value),operations:Operation.createList(operations)})}}]),Change}((0,immutable.Record)(DEFAULTS$12));function CommandsPlugin(){var commands=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function onCommand(command,editor,next){var type=command.type,args=command.args,fn=commands[type];if(!fn)return next();editor.command.apply(editor,[fn].concat(toConsumableArray(args)))}function onConstruct(editor,next){for(var command in commands)editor.registerCommand(command);return next()}return{onCommand,onConstruct}}var SPACE=/\s/,CHAMELEON=/['\u2018\u2019]/,PUNCTUATION=/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/;function isSurrogate(code){return 55296<=code&&code<=57343}function isModifier(code,text,offset){if(55356===code){var next=text.charCodeAt(offset+1);return next<=57343&&next>=57339}return!1}function isVariationSelector(code){return code<=65039&&code>=65024}function isWord(char,remaining){if(SPACE.test(char))return!1;if(CHAMELEON.test(char)){var next=remaining.charAt(0),length=getCharLength(next);if(isWord(next=remaining.slice(0,length),remaining.slice(length)))return!0}return!PUNCTUATION.test(char)}function getCharLength(char){return isSurrogate(char.charCodeAt(0))?2:1}function getCharOffset(text,chars,forward){var code,offset=0;if(""===text)return 1;for(var i=0;i<chars;i++)for(var prev=null,charCode=text.charCodeAt(offset);charCode;)if(isSurrogate(charCode)){var modifier=isModifier(charCode,text,offset);if(forward){if(!modifier&&prev&&"ZWJ"!==prev||modifier&&prev&&"SURR"!==prev)break}else if("SURR"===prev||"BMP"===prev)break;offset+=2,prev=modifier?"MOD":"SURR",charCode=text.charCodeAt(offset)}else if(8205!==charCode)if(10084!==(code=charCode)&&9794!==code&&9792!==code&&9760!==code&&9877!==code&&9992!==code&&9711!==code){if(!isVariationSelector(charCode)){if(forward){if(isModifier(text.charCodeAt(offset+1),text,offset+1)){offset+=3,prev="MOD",charCode=text.charCodeAt(offset);continue}}else if("MOD"===prev){offset+=1;break}null===prev&&(offset+=1);break}if(!forward&&prev&&"ZWJ"!==prev)break;offset+=1,prev="VAR",charCode=text.charCodeAt(offset)}else{if(forward&&"VAR"===prev||prev&&"ZWJ"!==prev&&"VAR"!==prev)break;offset+=1,prev="BMP",charCode=text.charCodeAt(offset)}else offset+=1,prev="ZWJ",charCode=text.charCodeAt(offset);return offset}function getWordOffset(text){for(var length=0,i=0,started=!1,char=void 0;char=text.charAt(i);){var l=getCharLength(char);if(isWord(char=text.slice(i,i+l),text.slice(i+l)))started=!0,length+=l;else{if(started)break;length+=l}i+=l}return length}var TextUtils={getCharLength,getCharOffset,getCharOffsetBackward:function getCharOffsetBackward(text,offset){var chars=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return text=text.slice(0,offset),getCharOffset(text=(0,esrever.reverse)(text),chars)},getCharOffsetForward:function getCharOffsetForward(text,offset){var chars=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return getCharOffset(text=text.slice(offset),chars,!0)},getWordOffset,getWordOffsetBackward:function getWordOffsetBackward(text,offset){return text=text.slice(0,offset),getWordOffset(text=(0,esrever.reverse)(text))},getWordOffsetForward:function getWordOffsetForward(text,offset){return getWordOffset(text=text.slice(offset))},isSurrogate,isWord};function deleteExpandedAtRange(editor,range){range.isExpanded&&editor.deleteAtRange(range);var document=editor.value.document,_range=range,start=_range.start,end=_range.end;return range=document.hasDescendant(start.path)?range.moveToStart():range.moveTo(end.path,0).normalize(document)}var Commands$1={addMarkAtRange:function(editor,range,mark){if(!range.isCollapsed){var document=editor.value.document,start=range.start,end=range.end,texts=document.getTextsAtRange(range);editor.withoutNormalizing((function(){texts.forEach((function(node){var key=node.key,index=0,length=node.text.length;key===start.key&&(index=start.offset),key===end.key&&(length=end.offset),key===start.key&&key===end.key&&(length=end.offset-start.offset),editor.addMarkByKey(key,index,length,mark)}))}))}},addMarksAtRange:function(editor,range,marks){marks.forEach((function(mark){return editor.addMarkAtRange(range,mark)}))},deleteAtRange:function(editor,range){editor.snapshotSelection();var value=editor.value,start=range.start,end=range.end,startKey=start.key,startOffset=start.offset,endKey=end.key,endOffset=end.offset,document=value.document,isStartVoid=document.hasVoidParent(startKey,editor),isEndVoid=document.hasVoidParent(endKey,editor),startBlock=document.getClosestBlock(startKey),endBlock=document.getClosestBlock(endKey),isHanging=0===startOffset&&0===endOffset&&!1===isStartVoid&&startKey===startBlock.getFirstText().key&&endKey===endBlock.getFirstText().key&&startKey!==endKey;if(isHanging&&isEndVoid){var prevText=document.getPreviousText(endKey);endKey=prevText.key,endOffset=prevText.text.length,isEndVoid=document.hasVoidParent(endKey,editor)}editor.withoutNormalizing((function(){for(;isStartVoid;){var startVoid=document.getClosestVoid(startKey,editor),nextText=document.getNextText(startKey);if(editor.removeNodeByKey(startVoid.key),startKey===endKey)return;if(!nextText)return;document=editor.value.document,startKey=nextText.key,startOffset=0,isStartVoid=document.hasVoidParent(startKey,editor)}for(;isEndVoid;){var endVoid=document.getClosestVoid(endKey,editor),_prevText=document.getPreviousText(endKey);editor.removeNodeByKey(endVoid.key),document=editor.value.document,endKey=_prevText.key,endOffset=_prevText.text.length,isEndVoid=document.hasVoidParent(endKey,editor)}if(startKey===endKey&&isHanging)editor.removeNodeByKey(startBlock.key);else if(startKey!==endKey){startBlock=document.getClosestBlock(startKey),endBlock=document.getClosestBlock(endKey);var startText=document.getNode(startKey),endText=document.getNode(endKey),startLength=startText.text.length-startOffset,endLength=endOffset,ancestor=document.getCommonAncestor(startKey,endKey),startChild=ancestor.getFurthestChild(startKey),endChild=ancestor.getFurthestChild(endKey),startParent=document.getParent(startBlock.key),startParentIndex=startParent.nodes.indexOf(startBlock),endParentIndex=startParent.nodes.indexOf(endBlock),child=void 0;for(child=startText;child.key!==startChild.key;){var parent=document.getParent(child.key),_index=parent.nodes.indexOf(child);parent.nodes.slice(_index+1).reverse().forEach((function(node){editor.removeNodeByKey(node.key)})),child=parent}var startChildIndex=ancestor.nodes.indexOf(startChild),endChildIndex=ancestor.nodes.indexOf(endChild);for(ancestor.nodes.slice(startChildIndex+1,endChildIndex).reverse().forEach((function(node){editor.removeNodeByKey(node.key)})),child=endText;child.key!==endChild.key;){var _parent=document.getParent(child.key),_index2=_parent.nodes.indexOf(child);_parent.nodes.slice(0,_index2).reverse().forEach((function(node){editor.removeNodeByKey(node.key)})),child=_parent}if(0!==startLength&&editor.removeTextByKey(startKey,startOffset,startLength),0!==endLength&&editor.removeTextByKey(endKey,0,endOffset),startBlock.key!==endBlock.key){document=editor.value.document;var onlyChildAncestor=void 0,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=document.ancestors(endBlock.key)[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ref=_step.value,node=slicedToArray(_ref,1)[0];if(node.nodes.size>1)break;onlyChildAncestor=node}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}endParentIndex!==startParentIndex+1&&editor.moveNodeByKey(endBlock.key,startParent.key,startParentIndex+1),isHanging?editor.removeNodeByKey(startBlock.key):editor.mergeNodeByKey(endBlock.key),onlyChildAncestor&&editor.removeNodeByKey(onlyChildAncestor.key)}}else{var index=startOffset,length=endOffset-startOffset;editor.removeTextByKey(startKey,index,length)}}))},deleteBackwardAtRange:function(editor,range){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==n){var value=editor.value,document=value.document,_range2=range,start=_range2.start,focus=_range2.focus;if(range.isExpanded)editor.deleteAtRange(range);else{var voidParent=document.getClosestVoid(start.path,editor);if(voidParent)editor.removeNodeByKey(voidParent.key);else if(!start.isAtStartOfNode(document)){var block=document.getClosestBlock(start.path);if(1!==document.nodes.size&&block&&""===block.text&&1===block.nodes.size)editor.removeNodeByKey(block.key);else{var text=document.getDescendant(start.path);if(start.isAtStartOfNode(text)){var prev=document.getPreviousText(text.key),inline=document.getClosestInline(text.key);inline&&""===prev.text&&(prev=document.getPreviousText(prev.key));var prevBlock=document.getClosestBlock(prev.key),prevVoid=document.getClosestVoid(prev.key,editor);if(prevVoid)return void editor.removeNodeByKey(prevVoid.key);if(1===n&&prevBlock!==block)return range=range.moveAnchorTo(prev.key,prev.text.length),void editor.deleteAtRange(range)}if(n<=focus.offset)return range=range.moveFocusBackward(n),void editor.deleteAtRange(range);for(var node=text,offset=0,traversed=focus.offset;n>traversed;){var next=traversed+(node=document.getPreviousText(node.key)).text.length;if(n<=next){offset=next-n;break}traversed=next}range=range.moveAnchorTo(node.key,offset),editor.deleteAtRange(range)}}}}},deleteCharBackwardAtRange:function(editor,range){if(range.isExpanded)editor.deleteAtRange(range);else{var document=editor.value.document,start=range.start,startBlock=document.getClosestBlock(start.path),o=startBlock.getOffset(start.key)+start.offset,text=startBlock.text,n=TextUtils.getCharOffsetBackward(text,o);editor.deleteBackwardAtRange(range,n)}},deleteCharForwardAtRange:function(editor,range){if(range.isExpanded)editor.deleteAtRange(range);else{var document=editor.value.document,start=range.start,startBlock=document.getClosestBlock(start.path),o=startBlock.getOffset(start.key)+start.offset,text=startBlock.text,n=TextUtils.getCharOffsetForward(text,o);editor.deleteForwardAtRange(range,n)}},deleteForwardAtRange:function(editor,range){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==n){var value=editor.value,document=value.document,_range3=range,start=_range3.start,focus=_range3.focus;if(range.isExpanded)editor.deleteAtRange(range);else{var voidParent=document.getClosestVoid(start.path,editor);if(voidParent)editor.removeNodeByKey(voidParent.key);else{var block=document.getClosestBlock(start.path);if(block&&!editor.isVoid(block)&&""===block.text&&1!==document.nodes.size){var nextBlock=document.getNextBlock(block.key);return editor.removeNodeByKey(block.key),void(nextBlock&&nextBlock.key&&editor.moveToStartOfNode(nextBlock))}if(!start.isAtEndOfNode(document)){var text=document.getDescendant(start.path);if(start.isAtEndOfNode(text)){var next=document.getNextText(text.key),_nextBlock=document.getClosestBlock(next.key),nextVoid=document.getClosestVoid(next.key,editor);if(nextVoid)return void editor.removeNodeByKey(nextVoid.key);if(1===n&&_nextBlock!==block)return range=range.moveFocusTo(next.key,0),void editor.deleteAtRange(range)}if(n<=text.text.length-focus.offset)return range=range.moveFocusForward(n),void editor.deleteAtRange(range);for(var node=text,offset=focus.offset,traversed=text.text.length-focus.offset;n>traversed;){var _next=traversed+(node=document.getNextText(node.key)).text.length;if(n<=_next){offset=n-traversed;break}traversed=_next}range=range.moveFocusTo(node.key,offset),editor.deleteAtRange(range)}}}}},deleteLineBackwardAtRange:function(editor,range){if(range.isExpanded)editor.deleteAtRange(range);else{var document=editor.value.document,start=range.start,o=document.getClosestBlock(start.path).getOffset(start.key)+start.offset;editor.deleteBackwardAtRange(range,o)}},deleteLineForwardAtRange:function(editor,range){if(range.isExpanded)editor.deleteAtRange(range);else{var document=editor.value.document,start=range.start,startBlock=document.getClosestBlock(start.path),o=startBlock.getOffset(start.key)+start.offset;editor.deleteForwardAtRange(range,startBlock.text.length-o)}},deleteWordBackwardAtRange:function(editor,range){if(range.isExpanded)editor.deleteAtRange(range);else{var document=editor.value.document,start=range.start,startBlock=document.getClosestBlock(start.path),o=startBlock.getOffset(start.key)+start.offset,text=startBlock.text,n=0===o?1:TextUtils.getWordOffsetBackward(text,o);editor.deleteBackwardAtRange(range,n)}},deleteWordForwardAtRange:function(editor,range){if(range.isExpanded)editor.deleteAtRange(range);else{var document=editor.value.document,start=range.start,startBlock=document.getClosestBlock(start.path),o=startBlock.getOffset(start.key)+start.offset,text=startBlock.text,wordOffset=TextUtils.getWordOffsetForward(text,o),n=0===wordOffset?1:wordOffset;editor.deleteForwardAtRange(range,n)}},insertBlockAtRange:function(editor,range,block){range=deleteExpandedAtRange(editor,range),block=Block.create(block);var document=editor.value.document,start=range.start,startKey=start.key,startOffset=start.offset,startBlock=document.getClosestBlock(startKey),startInline=document.getClosestInline(startKey),parent=document.getParent(startBlock.key),index=parent.nodes.indexOf(startBlock),insertionMode=getInsertionMode(editor,range);if("before"===insertionMode)editor.insertNodeByKey(parent.key,index,block);else if("behind"===insertionMode)editor.insertNodeByKey(parent.key,index+1,block);else{if(startInline&&editor.isVoid(startInline)){var atEnd=start.isAtEndOfNode(startInline),siblingText=atEnd?document.getNextText(startKey):document.getPreviousText(startKey),splitRange=atEnd?range.moveToStartOfNode(siblingText):range.moveToEndOfNode(siblingText);startKey=splitRange.start.key,startOffset=splitRange.start.offset}editor.withoutNormalizing((function(){editor.splitDescendantsByKey(startBlock.key,startKey,startOffset),editor.insertNodeByKey(parent.key,index+1,block)}))}}},getInsertionMode=function getInsertionMode(editor,range){var document=editor.value.document,start=range.start,startKey=start.key,startBlock=document.getClosestBlock(startKey),startInline=document.getClosestInline(startKey);return editor.isVoid(startBlock)?start.isAtEndOfNode(startBlock)?"behind":"before":startInline||""!==startBlock.text?start.isAtStartOfNode(startBlock)?"before":start.isAtEndOfNode(startBlock)?"behind":"split":"behind"};Commands$1.insertFragmentAtRange=function(editor,range,fragment){editor.withoutNormalizing((function(){if(range=deleteExpandedAtRange(editor,range),fragment.nodes.size){fragment=fragment.mapDescendants((function(child){return child.regenerateKey()}));var start=range.start,document=editor.value.document,startText=document.getDescendant(start.path),startBlock=document.getClosestBlock(startText.key),startChild=startBlock.getFurthestChild(startText.key),isAtStart=start.isAtStartOfNode(startBlock),parent=document.getParent(startBlock.key),index=parent.nodes.indexOf(startBlock),blocks=fragment.getBlocks(),firstChild=fragment.nodes.first(),lastChild=fragment.nodes.last(),firstBlock=blocks.first(),lastBlock=blocks.last(),insertionNode=findInsertionNode(fragment,document,startBlock.key);if(firstBlock===lastBlock&&editor.isVoid(firstBlock))editor.insertBlockAtRange(range,firstBlock);else if(insertionNode!==fragment||!firstChild.hasBlockChildren()&&!lastChild.hasBlockChildren()){if(firstBlock!==lastBlock){var lonelyChild=insertionNode.getFurthest(firstBlock.key,(function(p){return 1===p.nodes.size}))||firstBlock,startIndex=parent.nodes.indexOf(startBlock);insertionNode.removeNode(lonelyChild.key).nodes.forEach((function(node,i){var newIndex=startIndex+i+1;editor.insertNodeByKey(parent.key,newIndex,node)}))}if(0!==start.offset&&editor.splitDescendantsByKey(startChild.key,start.key,start.offset),startText=(document=editor.value.document).getDescendant(start.key),startChild=(startBlock=document.getClosestBlock(start.key)).getFurthestChild(startText.key),firstBlock!==lastBlock){var nextChild=isAtStart?startChild:startBlock.getNextSibling(startChild.key),nextNodes=nextChild?startBlock.nodes.skipUntil((function(n){return n.key===nextChild.key})):(0,immutable.List)(),lastIndex=lastBlock.nodes.size;nextNodes.forEach((function(node,i){var newIndex=lastIndex+i;editor.moveNodeByKey(node.key,lastBlock.key,newIndex)}))}if(editor.isVoid(startBlock)||""!==startBlock.text||startBlock.findDescendant((function(n){return editor.isVoid(n)}))){var inlineChild=startBlock.getFurthestChild(startText.key),inlineIndex=startBlock.nodes.indexOf(inlineChild);firstBlock.nodes.forEach((function(inline,i){var o=0===start.offset?0:1,newIndex=inlineIndex+i+o;editor.insertNodeByKey(startBlock.key,newIndex,inline)}))}else editor.removeNodeByKey(startBlock.key),editor.insertNodeByKey(parent.key,index,firstBlock)}else{("before"===getInsertionMode(editor,range)?fragment.nodes:fragment.nodes.reverse()).forEach((function(node){editor.insertBlockAtRange(range,node)}))}}}))};var findInsertionNode=function findInsertionNode(fragment,document,documentKey){var ancestorTypesMatch=function ancestorTypesMatch(fragmentAncestors,documentAncestors){return documentAncestors.size>=fragmentAncestors.size&&fragmentAncestors.every((function(fragmentNode,i){return documentAncestors.get(i).type===fragmentNode.type}))},getAncestorBlocks=function getAncestorBlocks(doc,key){return doc.getAncestors(key).slice(1).push(doc.getNode(key)).reverse()},fragmentStartBlock=function deepestSingleBlock(doc){for(var result=doc;1===result.nodes.size&&"block"===result.nodes.first().object;)result=result.nodes.first();return result===doc?null:result}(fragment);return fragmentStartBlock?function matchingFragmentAncestor(documentAncestors,fragmentAncestors){var depthDifference=documentAncestors.size-fragmentAncestors.size;if(depthDifference<0)return fragment;for(var fragIdx=0;fragIdx<fragmentAncestors.size;fragIdx++)for(var docIdx=0;docIdx<=depthDifference;docIdx++)if(ancestorTypesMatch(fragmentAncestors.slice(fragIdx),documentAncestors.slice(docIdx)))return fragmentAncestors.get(fragIdx);return fragment}(getAncestorBlocks(document,documentKey),getAncestorBlocks(fragment,fragmentStartBlock.key)):fragment};Commands$1.insertInlineAtRange=function(editor,range,inline){inline=Inline.create(inline),editor.withoutNormalizing((function(){range=deleteExpandedAtRange(editor,range);var document=editor.value.document,start=range.start,parent=document.getParent(start.path),startText=document.assertDescendant(start.path),index=parent.nodes.indexOf(startText);editor.isVoid(parent)||(editor.splitNodeByPath(start.path,start.offset),editor.insertNodeByKey(parent.key,index+1,inline))}))},Commands$1.insertTextAtRange=function(editor,range,text,marks){editor.withoutNormalizing((function(){range=deleteExpandedAtRange(editor,range);var document=editor.value.document,start=range.start,offset=start.offset,parent=document.getParent(start.path);editor.isVoid(parent)||editor.insertTextByPath(start.path,offset,text,marks)}))},Commands$1.removeMarkAtRange=function(editor,range,mark){if(!range.isCollapsed){var texts=editor.value.document.getTextsAtRange(range),start=range.start,end=range.end;editor.withoutNormalizing((function(){texts.forEach((function(node){var key=node.key,index=0,length=node.text.length;key===start.key&&(index=start.offset),key===end.key&&(length=end.offset),key===start.key&&key===end.key&&(length=end.offset-start.offset),editor.removeMarkByKey(key,index,length,mark)}))}))}},Commands$1.setBlocksAtRange=function(editor,range,properties){var document=editor.value.document,blocks=document.getLeafBlocksAtRange(range),start=range.start,end=range.end,isCollapsed=range.isCollapsed,isStartVoid=document.hasVoidParent(start.path,editor),startBlock=document.getClosestBlock(start.path),endBlock=document.getClosestBlock(end.key),sets=!1===isCollapsed&&0===start.offset&&0===end.offset&&!1===isStartVoid&&start.key===startBlock.getFirstText().key&&end.key===endBlock.getFirstText().key?blocks.slice(0,-1):blocks;editor.withoutNormalizing((function(){sets.forEach((function(block){editor.setNodeByKey(block.key,properties)}))}))},Commands$1.setInlinesAtRange=function(editor,range,properties){var inlines=editor.value.document.getLeafInlinesAtRange(range);editor.withoutNormalizing((function(){inlines.forEach((function(inline){editor.setNodeByKey(inline.key,properties)}))}))},Commands$1.splitBlockAtRange=function(editor,range){for(var height=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,_range8=range=deleteExpandedAtRange(editor,range),start=_range8.start,end=_range8.end,value=editor.value,_value=value,document=_value.document,node=document.assertDescendant(start.path),parent=document.getClosestBlock(node.key),h=0;parent&&"block"===parent.object&&h<height;)node=parent,parent=document.getClosestBlock(parent.key),h++;editor.withoutNormalizing((function(){if(editor.splitDescendantsByKey(node.key,start.path,start.offset),value=editor.value,document=value.document,range.isExpanded){range.isBackward&&(range=range.flip());var nextBlock=document.getNextBlock(node.key);range=(range=range.moveAnchorToStartOfNode(nextBlock)).setFocus(range.focus.setPath(null)),start.path.equals(end.path)&&(range=range.moveFocusTo(range.anchor.key,end.offset-start.offset)),range=document.resolveRange(range),editor.deleteAtRange(range)}}))},Commands$1.splitInlineAtRange=function(editor,range){for(var height=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,_range9=range=deleteExpandedAtRange(editor,range),start=_range9.start,value=editor.value,document=value.document,node=document.assertDescendant(start.path),parent=document.getClosestInline(node.key),h=0;parent&&"inline"===parent.object&&h<height;)node=parent,parent=document.getClosestInline(parent.key),h++;editor.splitDescendantsByKey(node.key,start.path,start.offset)},Commands$1.toggleMarkAtRange=function(editor,range,mark){range.isCollapsed||(mark=Mark.create(mark),editor.value.document.getActiveMarksAtRange(range).some((function(m){return m.equals(mark)}))?editor.removeMarkAtRange(range,mark):editor.addMarkAtRange(range,mark))},Commands$1.unwrapBlockAtRange=function(editor,range,properties){properties=Node.createProperties(properties);var document=editor.value.document,blocks=document.getLeafBlocksAtRange(range),wrappers=blocks.map((function(block){return document.getClosest(block.key,(function(parent){return"block"===parent.object&&((null==properties.type||parent.type===properties.type)&&!(null!=properties.data&&!parent.data.isSuperset(properties.data)))}))})).filter((function(exists){return exists})).toOrderedSet().toList();editor.withoutNormalizing((function(){wrappers.forEach((function(block){var first=block.nodes.first(),last=block.nodes.last(),parent=editor.value.document.getParent(block.key),index=parent.nodes.indexOf(block),children=block.nodes.filter((function(child){return blocks.some((function(b){return child===b||child.hasDescendant(b.key)}))})),firstMatch=children.first(),lastMatch=children.last();if(first===firstMatch&&last===lastMatch)block.nodes.forEach((function(child,i){editor.moveNodeByKey(child.key,parent.key,index+i)})),editor.removeNodeByKey(block.key);else if(last===lastMatch)block.nodes.skipUntil((function(n){return n===firstMatch})).forEach((function(child,i){editor.moveNodeByKey(child.key,parent.key,index+1+i)}));else if(first===firstMatch)block.nodes.takeUntil((function(n){return n===lastMatch})).push(lastMatch).forEach((function(child,i){editor.moveNodeByKey(child.key,parent.key,index+i)}));else{var firstText=firstMatch.getFirstText();editor.splitDescendantsByKey(block.key,firstText.key,0),document=editor.value.document,children.forEach((function(child,i){if(0===i){var extra=child;child=document.getNextBlock(child.key),editor.removeNodeByKey(extra.key)}editor.moveNodeByKey(child.key,parent.key,index+1+i)}))}}))}))},Commands$1.unwrapInlineAtRange=function(editor,range,properties){properties=Node.createProperties(properties);var document=editor.value.document,inlines=document.getTextsAtRange(range).map((function(text){return document.getClosest(text.key,(function(parent){return"inline"===parent.object&&((null==properties.type||parent.type===properties.type)&&!(null!=properties.data&&!parent.data.isSuperset(properties.data)))}))})).filter((function(exists){return exists})).toOrderedSet().toList();editor.withoutNormalizing((function(){inlines.forEach((function(inline){var parent=editor.value.document.getParent(inline.key),index=parent.nodes.indexOf(inline);inline.nodes.forEach((function(child,i){editor.moveNodeByKey(child.key,parent.key,index+i)})),editor.removeNodeByKey(inline.key)}))}))},Commands$1.wrapBlockAtRange=function(editor,range,block){block=(block=Block.create(block)).set("nodes",block.nodes.clear());var document=editor.value.document,blocks=document.getLeafBlocksAtRange(range),firstblock=blocks.first(),lastblock=blocks.last(),parent=void 0,siblings=void 0,index=void 0;if(1===blocks.length?(parent=document.getParent(firstblock.key),siblings=blocks):parent=document.getClosest(firstblock.key,(function(p1){return!!document.getClosest(lastblock.key,(function(p2){return p1===p2}))})),null==parent&&(parent=document),null==siblings){var indexes=parent.nodes.reduce((function(ind,node,i){return(node===firstblock||node.hasDescendant(firstblock.key))&&(ind[0]=i),(node===lastblock||node.hasDescendant(lastblock.key))&&(ind[1]=i),ind}),[]);index=indexes[0],siblings=parent.nodes.slice(indexes[0],indexes[1]+1)}null==index&&(index=parent.nodes.indexOf(siblings.first())),editor.withoutNormalizing((function(){editor.insertNodeByKey(parent.key,index,block),siblings.forEach((function(node,i){editor.moveNodeByKey(node.key,block.key,i)}))}))},Commands$1.wrapInlineAtRange=function(editor,range,inline){var document=editor.value.document,start=range.start,end=range.end;if(range.isCollapsed){var inlineParent=document.getClosestInline(start.path);if(!inlineParent)return;if(!editor.isVoid(inlineParent))return;return editor.wrapInlineByKey(inlineParent.key,inline)}inline=(inline=Inline.create(inline)).set("nodes",inline.nodes.clear());var blocks=document.getLeafBlocksAtRange(range),startBlock=document.getClosestBlock(start.path),endBlock=document.getClosestBlock(end.path),startInline=document.getClosestInline(start.path),endInline=document.getClosestInline(end.path),startChild=startBlock.getFurthestChild(start.key),endChild=endBlock.getFurthestChild(end.key);editor.withoutNormalizing((function(){startInline&&startInline===endInline||(editor.splitDescendantsByKey(endChild.key,end.key,end.offset),editor.splitDescendantsByKey(startChild.key,start.key,start.offset)),document=editor.value.document,startBlock=document.getDescendant(startBlock.key),endBlock=document.getDescendant(endBlock.key),startChild=startBlock.getFurthestChild(start.key),endChild=endBlock.getFurthestChild(end.key);var startIndex=startBlock.nodes.indexOf(startChild),endIndex=endBlock.nodes.indexOf(endChild);if(startInline&&startInline===endInline){var texts=startBlock.getTextsAtRange(range).map((function(text){return start.key===text.key&&end.key===text.key?text.splitText(start.offset)[1].splitText(end.offset-start.offset)[0].regenerateKey():start.key===text.key?text.splitText(start.offset)[1].regenerateKey():end.key===text.key?text.splitText(end.offset)[0].regenerateKey():text.regenerateKey()}));inline=inline.set("nodes",texts),editor.insertInlineAtRange(range,inline)}else if(startBlock===endBlock){document=editor.value.document,startBlock=document.getClosestBlock(start.key),startChild=startBlock.getFurthestChild(start.key);var startInner=document.getNextSibling(startChild.key),startInnerIndex=startBlock.nodes.indexOf(startInner),endInner=start.key===end.key?startInner:startBlock.getFurthestChild(end.key),inlines=startBlock.nodes.skipUntil((function(n){return n===startInner})).takeUntil((function(n){return n===endInner})).push(endInner),node=inline.regenerateKey();editor.insertNodeByKey(startBlock.key,startInnerIndex,node),inlines.forEach((function(child,i){editor.moveNodeByKey(child.key,node.key,i)}))}else{var startInlines=startBlock.nodes.slice(startIndex+1),endInlines=endBlock.nodes.slice(0,endIndex+1),startNode=inline.regenerateKey(),endNode=inline.regenerateKey();editor.insertNodeByKey(startBlock.key,startIndex+1,startNode),editor.insertNodeByKey(endBlock.key,endIndex,endNode),startInlines.forEach((function(child,i){editor.moveNodeByKey(child.key,startNode.key,i)})),endInlines.forEach((function(child,i){editor.moveNodeByKey(child.key,endNode.key,i)})),blocks.slice(1,-1).forEach((function(block){var node=inline.regenerateKey();editor.insertNodeByKey(block.key,0,node),block.nodes.forEach((function(child,i){editor.moveNodeByKey(child.key,node.key,i)}))}))}}))},Commands$1.wrapTextAtRange=function(editor,range,prefix){var suffix=arguments.length>3&&void 0!==arguments[3]?arguments[3]:prefix,start=range.start,end=range.end,startRange=range.moveToStart(),endRange=range.moveToEnd();start.path.equals(end.path)&&(endRange=endRange.moveForward(prefix.length)),editor.withoutNormalizing((function(){editor.insertTextAtRange(startRange,prefix),editor.insertTextAtRange(endRange,suffix)}))};var Commands$2={addMarkByPath:function(editor,path,offset,length,mark){mark=Mark.create(mark),editor.addMarksByPath(path,offset,length,[mark])},addMarksByPath:function(editor,path,offset,length,marks){if((marks=Mark.createSet(marks)).size){var node=editor.value.document.assertNode(path);editor.withoutNormalizing((function(){offset+length<node.text.length&&editor.splitNodeByPath(path,offset+length),offset>0&&(editor.splitNodeByPath(path,offset),path=PathUtils.increment(path),offset=0),marks.forEach((function(mark){editor.applyOperation({type:"add_mark",path,mark:Mark.create(mark)})}))}))}},replaceMarksByPath:function(editor,path,offset,length,marks){var marksSet=Mark.createSet(marks),node=editor.value.document.assertNode(path);node.marks.equals(marksSet)||editor.withoutNormalizing((function(){offset+length<node.text.length&&editor.splitNodeByPath(path,offset+length),offset>0&&(editor.splitNodeByPath(path,offset),path=PathUtils.increment(path),offset=0);var marksToApply=marksSet.subtract(node.marks);node.marks.subtract(marksSet).forEach((function(mark){editor.applyOperation({type:"remove_mark",path,mark:Mark.create(mark)})})),marksToApply.forEach((function(mark){editor.applyOperation({type:"add_mark",path,mark:Mark.create(mark)})}))}))},insertFragmentByPath:function(editor,path,index,fragment){fragment.nodes.forEach((function(node,i){editor.insertNodeByPath(path,index+i,node)}))},insertNodeByPath:function(editor,path,index,node){editor.applyOperation({type:"insert_node",path:path.concat(index),node})},insertTextByPath:function(editor,path,offset,text,marks){var value=editor.value,annotations=value.annotations;value.document.assertNode(path),editor.withoutNormalizing((function(){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=annotations.values()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var annotation=_step.value,start=annotation.start,end=annotation.end;editor.isAtomic(annotation)&&(start.path.equals(path)&&start.offset<offset&&(!end.path.equals(path)||end.offset>offset)&&editor.removeAnnotation(annotation))}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}editor.applyOperation({type:"insert_text",path,offset,text}),marks&&editor.replaceMarksByPath(path,offset,text.length,marks)}))},mergeNodeByPath:function(editor,path){var document=editor.value.document,original=document.getDescendant(path),previous=document.getPreviousSibling(path);if(!previous)throw new Error('Unable to merge node with path "'+path+'", because it has no previous sibling.');var position="text"===previous.object?previous.text.length:previous.nodes.size;editor.applyOperation({type:"merge_node",path,position,properties:{type:original.type,data:original.data},target:null})},moveNodeByPath:function(editor,path,newParentPath,newIndex){if(PathUtils.isEqual(path,newParentPath))return editor;var newPath=newParentPath.concat(newIndex);if(PathUtils.isEqual(path,newPath))return editor;editor.applyOperation({type:"move_node",path,newPath})},removeMarkByPath:function(editor,path,offset,length,mark){mark=Mark.create(mark),editor.removeMarksByPath(path,offset,length,[mark])},removeMarksByPath:function(editor,path,offset,length,marks){if((marks=Mark.createSet(marks)).size){var node=editor.value.document.assertNode(path);marks.intersect(node.marks).isEmpty()||editor.withoutNormalizing((function(){offset+length<node.text.length&&editor.splitNodeByPath(path,offset+length),offset>0&&(editor.splitNodeByPath(path,offset),path=PathUtils.increment(path),offset=0),marks.forEach((function(mark){editor.applyOperation({type:"remove_mark",path,offset,length,mark})}))}))}},removeAllMarksByPath:function(editor,path){var node=editor.state.document.assertNode(path);editor.withoutNormalizing((function(){if("text"!==node.object){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=node.texts()[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _ref=_step2.value,_ref2=slicedToArray(_ref,2),n=_ref2[0],p=_ref2[1],pth=path.concat(p);editor.removeMarksByPath(pth,0,n.text.length,n.marks)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}else editor.removeMarksByPath(path,0,node.text.length,node.marks)}))},removeNodeByPath:function(editor,path){var node=editor.value.document.assertNode(path);editor.applyOperation({type:"remove_node",path,node})},removeTextByPath:function(editor,path,offset,length){var value=editor.value,document=value.document,annotations=value.annotations,text=document.assertNode(path).text.slice(offset,offset+length);editor.withoutNormalizing((function(){var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=annotations.values()[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var annotation=_step3.value,start=annotation.start,end=annotation.end;editor.isAtomic(annotation)&&(start.path.equals(path)&&start.offset<offset&&(!end.path.equals(path)||end.offset>offset)&&editor.removeAnnotation(annotation))}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}editor.applyOperation({type:"remove_text",path,offset,text})}))},replaceNodeByPath:function(editor,path,newNode){newNode=Node.create(newNode);var index=path.last(),parentPath=PathUtils.lift(path);editor.withoutNormalizing((function(){editor.removeNodeByPath(path),editor.insertNodeByPath(parentPath,index,newNode)}))},replaceTextByPath:function(editor,path,offset,length,text,marks){editor.withoutNormalizing((function(){editor.removeTextByPath(path,offset,length),editor.insertTextByPath(path,offset,text,marks)}))},setMarkByPath:function(editor,path,offset,length,properties,newProperties){properties=Mark.create(properties),newProperties=Mark.createProperties(newProperties);var node=editor.value.document.assertNode(path);editor.withoutNormalizing((function(){offset+length<node.text.length&&editor.splitNodeByPath(path,offset+length),offset>0&&(editor.splitNodeByPath(path,offset),path=PathUtils.increment(path),offset=0),editor.applyOperation({type:"set_mark",path,properties,newProperties})}))},setNodeByPath:function(editor,path,newProperties){var node=editor.value.document.assertNode(path);newProperties=Node.createProperties(newProperties);var prevProperties=pick_default()(node,Object.keys(newProperties));editor.applyOperation({type:"set_node",path,properties:prevProperties,newProperties})},setTextByPath:function(editor,path,text,marks){var end=editor.value.document.assertNode(path).text.length;editor.replaceTextByPath(path,0,end,text,marks)},splitNodeByPath:function(editor,path,position){var options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},_options$target=options.target,target=void 0===_options$target?null:_options$target,value=editor.value,document=value.document,node=document.getDescendant(path);editor.applyOperation({type:"split_node",path,position,target,properties:{type:node.type,data:node.data}})},splitDescendantsByPath:function(editor,path,textPath,textOffset){if(path.equals(textPath))editor.splitNodeByPath(textPath,textOffset);else{var document=editor.value.document,index=textOffset,lastPath=textPath;editor.withoutNormalizing((function(){editor.splitNodeByKey(textPath,textOffset);var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=document.ancestors(textPath)[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var _ref3=_step4.value,ancestorPath=slicedToArray(_ref3,2)[1],target=index;if(index=lastPath.last()+1,lastPath=ancestorPath,editor.splitNodeByPath(ancestorPath,index,{target}),ancestorPath.equals(path))break}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}))}},unwrapInlineByPath:function(editor,path,properties){var value=editor.value,document=value.document,selection=value.selection,node=document.assertNode(path),first=node.getFirstText(),last=node.getLastText(),range=selection.moveToRangeOfNode(first,last);editor.unwrapInlineAtRange(range,properties)},unwrapBlockByPath:function(editor,path,properties){var value=editor.value,document=value.document,selection=value.selection,node=document.assertNode(path),first=node.getFirstText(),last=node.getLastText(),range=selection.moveToRangeOfNode(first,last);editor.unwrapBlockAtRange(range,properties)},unwrapNodeByPath:function(editor,path){var document=editor.value.document;document.assertNode(path);var parentPath=PathUtils.lift(path),parent=document.assertNode(parentPath),index=path.last(),parentIndex=parentPath.last(),grandPath=PathUtils.lift(parentPath),isFirst=0===index,isLast=index===parent.nodes.size-1;editor.withoutNormalizing((function(){if(1===parent.nodes.size)editor.moveNodeByPath(path,grandPath,parentIndex+1),editor.removeNodeByPath(parentPath);else if(isFirst)editor.moveNodeByPath(path,grandPath,parentIndex);else if(isLast)editor.moveNodeByPath(path,grandPath,parentIndex+1);else{var updatedPath=PathUtils.increment(path,1,parentPath.size-1);updatedPath=updatedPath.set(updatedPath.size-1,0),editor.splitNodeByPath(parentPath,index),editor.moveNodeByPath(updatedPath,grandPath,parentIndex+1)}}))},unwrapChildrenByPath:function(editor,path){path=PathUtils.create(path);var node=editor.value.document.assertNode(path),parentPath=PathUtils.lift(path),index=path.last(),nodes=node.nodes;editor.withoutNormalizing((function(){nodes.reverse().forEach((function(child,i){var childIndex=nodes.size-i-1,childPath=path.push(childIndex);editor.moveNodeByPath(childPath,parentPath,index+1)})),editor.removeNodeByPath(path)}))},wrapBlockByPath:function(editor,path,block){block=(block=Block.create(block)).set("nodes",block.nodes.clear());var parentPath=PathUtils.lift(path),index=path.last(),newPath=PathUtils.increment(path);editor.withoutNormalizing((function(){editor.insertNodeByPath(parentPath,index,block),editor.moveNodeByPath(newPath,path,0)}))},wrapInlineByPath:function(editor,path,inline){inline=(inline=Inline.create(inline)).set("nodes",inline.nodes.clear());var parentPath=PathUtils.lift(path),index=path.last(),newPath=PathUtils.increment(path);editor.withoutNormalizing((function(){editor.insertNodeByPath(parentPath,index,inline),editor.moveNodeByPath(newPath,path,0)}))},wrapNodeByPath:function(editor,path,node){"block"===(node=Node.create(node)).object?editor.wrapBlockByPath(path,node):"inline"===node.object&&editor.wrapInlineByPath(path,node)}},_loop=function _loop(method){Commands$2[method+"ByKey"]=function(editor,key){for(var _len3=arguments.length,args=Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++)args[_key3-2]=arguments[_key3];var value=editor.value,document=value.document,path=document.assertPath(key);editor[method+"ByPath"].apply(editor,[path].concat(args))}},_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _step5,_iterator5=["addMark","insertFragment","insertNode","insertText","mergeNode","removeAllMarks","removeMark","removeNode","removeText","replaceMarks","replaceNode","replaceText","setMark","setNode","setText","splitNode","unwrapBlock","unwrapChildren","unwrapInline","unwrapNode","wrapBlock","wrapInline","wrapNode"][Symbol.iterator]();!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){_loop(_step5.value)}}catch(err){_didIteratorError5=!0,_iteratorError5=err}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}Commands$2.moveNodeByKey=function(editor,key,newKey){for(var _len=arguments.length,args=Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)args[_key-3]=arguments[_key];var value=editor.value,document=value.document,path=document.assertPath(key),newPath=document.assertPath(newKey);editor.moveNodeByPath.apply(editor,[path,newPath].concat(args))},Commands$2.splitDescendantsByKey=function(editor,key,textKey){for(var _len2=arguments.length,args=Array(_len2>3?_len2-3:0),_key2=3;_key2<_len2;_key2++)args[_key2-3]=arguments[_key2];var value=editor.value,document=value.document,path=document.assertPath(key),textPath=document.assertPath(textKey);editor.splitDescendantsByPath.apply(editor,[path,textPath].concat(args))};var Commands$3={};Commands$3.save=function(editor,operation){var operations=editor.operations,data=editor.value.data,_editor$tmp=editor.tmp,save=_editor$tmp.save,merge=_editor$tmp.merge;if(!1!==save&&function isValidOperation(o){if("set_selection"===o.type){var _o$newProperties=o.newProperties,isFocused=_o$newProperties.isFocused,anchor=_o$newProperties.anchor,focus=_o$newProperties.focus;if(void 0!==isFocused&&!anchor&&!focus)return!1}return!0}(operation)){var undos=data.get("undos")||(0,immutable.List)(),lastBatch=undos.last(),lastOperation=lastBatch&&lastBatch.last();if(null==merge&&(merge=0!==operations.size||function shouldMerge(o,p){return!!p&&("set_selection"===o.type&&"set_selection"===p.type||"insert_text"===o.type&&"insert_text"===p.type&&o.offset===p.offset+p.text.length&&o.path.equals(p.path)||"remove_text"===o.type&&"remove_text"===p.type&&o.offset+o.text.length===p.offset&&o.path.equals(p.path))}(operation,lastOperation)),merge&&lastBatch){var batch=lastBatch.push(operation);undos=(undos=undos.pop()).push(batch)}else{var _batch=(0,immutable.List)([operation]);undos=undos.push(_batch)}undos.size>100&&(undos=undos.takeLast(100)),editor.withoutSaving((function(){var redos=(0,immutable.List)(),newData=data.set("undos",undos).set("redos",redos);editor.setData(newData)}))}},Commands$3.redo=function(editor){var data=editor.value.data,redos=data.get("redos")||(0,immutable.List)(),undos=data.get("undos")||(0,immutable.List)(),batch=redos.last();batch&&editor.withoutSaving((function(){editor.withoutNormalizing((function(){batch.forEach((function(op){var _op=op,type=_op.type,newProperties=_op.newProperties;"set_selection"===type&&(op=op.set("newProperties",omit_default()(newProperties,"isFocused"))),editor.applyOperation(op)})),redos=redos.pop(),undos=undos.push(batch);var newData=data.set("undos",undos).set("redos",redos);editor.setData(newData)}))}))},Commands$3.undo=function(editor){var data=editor.value.data,redos=data.get("redos")||(0,immutable.List)(),undos=data.get("undos")||(0,immutable.List)(),batch=undos.last();batch&&editor.withoutSaving((function(){editor.withoutNormalizing((function(){batch.slice().reverse().map((function(op){return op.invert()})).forEach((function(inverse){var _inverse=inverse,type=_inverse.type,newProperties=_inverse.newProperties;"set_selection"===type&&(inverse=inverse.set("newProperties",omit_default()(newProperties,"isFocused"))),editor.applyOperation(inverse)})),redos=redos.push(batch),undos=undos.pop();var newData=data.set("undos",undos).set("redos",redos);editor.setData(newData)}))}))},Commands$3.withoutMerging=function(editor,fn){var value=editor.tmp.merge;editor.tmp.merge=!1,fn(editor),editor.tmp.merge=value},Commands$3.withoutSaving=function(editor,fn){var value=editor.tmp.save;editor.tmp.save=!1,fn(editor),editor.tmp.save=value};var Commands$4={};function proxy(editor,method){for(var _editor$value$selecti,_len39=arguments.length,args=Array(_len39>2?_len39-2:0),_key39=2;_key39<_len39;_key39++)args[_key39-2]=arguments[_key39];var range=(_editor$value$selecti=editor.value.selection)[method].apply(_editor$value$selecti,args);editor.select(range)}function pointEdgeObject(editor,point,edge,object){var Point=point.slice(0,1).toUpperCase()+point.slice(1),Edge=edge.slice(0,1).toUpperCase()+edge.slice(1),Object=object.slice(0,1).toUpperCase()+object.slice(1),method="move"+Point+"To"+Edge+"OfNode",getNode="text"===object?"getNode":"getClosest"+Object,value=editor.value,document=value.document,p=value.selection[point],node=document[getNode](p.key);node&&editor[method](node)}function pointEdgeSideObject(editor,point,edge,side,object){var Point=point.slice(0,1).toUpperCase()+point.slice(1),Edge=edge.slice(0,1).toUpperCase()+edge.slice(1),Side=side.slice(0,1).toUpperCase()+side.slice(1),Object=object.slice(0,1).toUpperCase()+object.slice(1),method="move"+Point+"To"+Edge+"OfNode",getNode="text"===object?"getNode":"getClosest"+Object,getDirectionNode="get"+Side+Object,value=editor.value,document=value.document,p=value.selection[point],node=document[getNode](p.key);if(node){var target=document[getDirectionNode](node.key);target&&editor[method](target)}}function pointBackward(editor,point){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==n){if(n<0)return pointForward(editor,point,-n);var Point=point.slice(0,1).toUpperCase()+point.slice(1),value=editor.value,document=value.document,selection=value.selection,p=selection[point],hasVoidParent=document.hasVoidParent(p.path,editor);if(!hasVoidParent&&p.offset-n>=0){var range=selection["move"+Point+"Backward"](n);editor.select(range)}else{var previous=document.getPreviousText(p.path);if(previous){var block=document.getClosestBlock(p.path),isInBlock=block.hasNode(previous.key),isPreviousInVoid=previous&&document.hasVoidParent(previous.key,editor);if(editor["move"+Point+"ToEndOfNode"](previous),!hasVoidParent&&!isPreviousInVoid&&isInBlock){var _range=editor.value.selection["move"+Point+"Backward"](n);editor.select(_range)}}}}}function pointForward(editor,point){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==n){if(n<0)return pointBackward(editor,point,-n);var Point=point.slice(0,1).toUpperCase()+point.slice(1),value=editor.value,document=value.document,selection=value.selection,p=selection[point],text=document.getNode(p.path),hasVoidParent=document.hasVoidParent(p.path,editor);if(!hasVoidParent&&p.offset+n<=text.text.length){var range=selection["move"+Point+"Forward"](n);editor.select(range)}else{var next=document.getNextText(p.path);if(next){var block=document.getClosestBlock(p.path),isInBlock=block.hasNode(next.key),isNextInVoid=document.hasVoidParent(next.key,editor);if(editor["move"+Point+"ToStartOfNode"](next),!hasVoidParent&&!isNextInVoid&&isInBlock){var _range2=editor.value.selection["move"+Point+"Forward"](n);editor.select(_range2)}}}}}function pointWordBackward(editor,pointName){var value=editor.value,document=value.document,point=value.selection[pointName],block=document.getClosestBlock(point.key),o=block.getOffset(point.key)+point.offset,text=block.text,n=TextUtils.getWordOffsetBackward(text,o);editor.command(pointBackward,pointName,n>0?n:1)}function pointWordForward(editor,pointName){var value=editor.value,document=value.document,point=value.selection[pointName],block=document.getClosestBlock(point.key),o=block.getOffset(point.key)+point.offset,text=block.text,n=TextUtils.getWordOffsetForward(text,o);editor.command(pointForward,pointName,n>0?n:1)}Commands$4.blur=function(editor){editor.select({isFocused:!1})},Commands$4.deselect=function(editor){var range=Selection.create();editor.select(range)},Commands$4.focus=function(editor){editor.select({isFocused:!0})},Commands$4.flip=function(editor){editor.command(proxy,"flip")},Commands$4.moveAnchorBackward=function(editor){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];editor.command.apply(editor,[pointBackward,"anchor"].concat(args))},Commands$4.moveAnchorWordBackward=function(editor){for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];editor.command.apply(editor,[pointWordBackward,"anchor"].concat(args))},Commands$4.moveAnchorForward=function(editor){for(var _len3=arguments.length,args=Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)args[_key3-1]=arguments[_key3];editor.command.apply(editor,[pointForward,"anchor"].concat(args))},Commands$4.moveAnchorWordForward=function(editor){for(var _len4=arguments.length,args=Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)args[_key4-1]=arguments[_key4];editor.command.apply(editor,[pointWordForward,"anchor"].concat(args))},Commands$4.moveAnchorTo=function(editor){for(var _len5=arguments.length,args=Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++)args[_key5-1]=arguments[_key5];editor.command.apply(editor,[proxy,"moveAnchorTo"].concat(args))},Commands$4.moveAnchorToEndOfBlock=function(editor){editor.command(pointEdgeObject,"anchor","end","block")},Commands$4.moveAnchorToEndOfInline=function(editor){editor.command(pointEdgeObject,"anchor","end","inline")},Commands$4.moveAnchorToEndOfDocument=function(editor){editor.moveAnchorToEndOfNode(editor.value.document).moveToAnchor()},Commands$4.moveAnchorToEndOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"anchor","end","next","block")},Commands$4.moveAnchorToEndOfNextInline=function(editor){editor.command(pointEdgeSideObject,"anchor","end","next","inline")},Commands$4.moveAnchorToEndOfNextText=function(editor){editor.command(pointEdgeSideObject,"anchor","end","next","text")},Commands$4.moveAnchorToEndOfNode=function(editor){for(var _len6=arguments.length,args=Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++)args[_key6-1]=arguments[_key6];editor.command.apply(editor,[proxy,"moveAnchorToEndOfNode"].concat(args))},Commands$4.moveAnchorToEndOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"anchor","end","previous","block")},Commands$4.moveAnchorToEndOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"anchor","end","previous","inline")},Commands$4.moveAnchorToEndOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"anchor","end","previous","text")},Commands$4.moveAnchorToEndOfText=function(editor){editor.command(pointEdgeObject,"anchor","end","text")},Commands$4.moveAnchorToStartOfBlock=function(editor){editor.command(pointEdgeObject,"anchor","start","block")},Commands$4.moveAnchorToStartOfDocument=function(editor){editor.moveAnchorToStartOfNode(editor.value.document).moveToAnchor()},Commands$4.moveAnchorToStartOfInline=function(editor){editor.command(pointEdgeObject,"anchor","start","inline")},Commands$4.moveAnchorToStartOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"anchor","start","next","block")},Commands$4.moveAnchorToStartOfNextInline=function(editor){editor.command(pointEdgeSideObject,"anchor","start","next","inline")},Commands$4.moveAnchorToStartOfNextText=function(editor){editor.command(pointEdgeSideObject,"anchor","start","next","text")},Commands$4.moveAnchorToStartOfNode=function(editor){for(var _len7=arguments.length,args=Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++)args[_key7-1]=arguments[_key7];editor.command.apply(editor,[proxy,"moveAnchorToStartOfNode"].concat(args))},Commands$4.moveAnchorToStartOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"anchor","start","previous","block")},Commands$4.moveAnchorToStartOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"anchor","start","previous","inline")},Commands$4.moveAnchorToStartOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"anchor","start","previous","text")},Commands$4.moveAnchorToStartOfText=function(editor){editor.command(pointEdgeObject,"anchor","start","text")},Commands$4.moveBackward=function(editor){var chars=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0!==chars){var value=editor.value,document=value.document,selection=value.selection,start=selection.start,startBlock=document.getClosestBlock(start.key),o=startBlock.getOffset(start.key),offset=o+start.offset,text=startBlock.text,charsOffset=TextUtils.getCharOffsetBackward(text,offset,chars);editor.moveAnchorBackward(charsOffset).moveFocusBackward(charsOffset)}},Commands$4.moveWordBackward=function(editor){for(var _len8=arguments.length,args=Array(_len8>1?_len8-1:0),_key8=1;_key8<_len8;_key8++)args[_key8-1]=arguments[_key8];editor.moveFocusWordBackward.apply(editor,args).moveToFocus()},Commands$4.moveEndBackward=function(editor){for(var _len9=arguments.length,args=Array(_len9>1?_len9-1:0),_key9=1;_key9<_len9;_key9++)args[_key9-1]=arguments[_key9];editor.command.apply(editor,[pointBackward,"end"].concat(args))},Commands$4.moveEndWordBackward=function(editor){for(var _len10=arguments.length,args=Array(_len10>1?_len10-1:0),_key10=1;_key10<_len10;_key10++)args[_key10-1]=arguments[_key10];editor.command.apply(editor,[pointWordBackward,"end"].concat(args))},Commands$4.moveEndForward=function(editor){for(var _len11=arguments.length,args=Array(_len11>1?_len11-1:0),_key11=1;_key11<_len11;_key11++)args[_key11-1]=arguments[_key11];editor.command.apply(editor,[pointForward,"end"].concat(args))},Commands$4.moveEndWordForward=function(editor){for(var _len12=arguments.length,args=Array(_len12>1?_len12-1:0),_key12=1;_key12<_len12;_key12++)args[_key12-1]=arguments[_key12];editor.command.apply(editor,[pointWordForward,"end"].concat(args))},Commands$4.moveEndTo=function(editor){for(var _len13=arguments.length,args=Array(_len13>1?_len13-1:0),_key13=1;_key13<_len13;_key13++)args[_key13-1]=arguments[_key13];editor.command.apply(editor,[proxy,"moveEndTo"].concat(args))},Commands$4.moveEndToEndOfBlock=function(editor){editor.command(pointEdgeObject,"end","end","block")},Commands$4.moveEndToEndOfDocument=function(editor){editor.moveEndToEndOfNode(editor.value.document).moveToEnd()},Commands$4.moveEndToEndOfInline=function(editor){editor.command(pointEdgeObject,"end","end","inline")},Commands$4.moveEndToEndOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"end","end","next","block")},Commands$4.moveEndToEndOfNextInline=function(editor){editor.command(pointEdgeSideObject,"end","end","next","inline")},Commands$4.moveEndToEndOfNextText=function(editor){editor.command(pointEdgeSideObject,"end","end","next","text")},Commands$4.moveEndToEndOfNode=function(editor){for(var _len14=arguments.length,args=Array(_len14>1?_len14-1:0),_key14=1;_key14<_len14;_key14++)args[_key14-1]=arguments[_key14];editor.command.apply(editor,[proxy,"moveEndToEndOfNode"].concat(args))},Commands$4.moveEndToEndOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"end","end","previous","block")},Commands$4.moveEndToEndOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"end","end","previous","inline")},Commands$4.moveEndToEndOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"end","end","previous","text")},Commands$4.moveEndToEndOfText=function(editor){editor.command(pointEdgeObject,"end","end","text")},Commands$4.moveEndToStartOfBlock=function(editor){editor.command(pointEdgeObject,"end","start","block")},Commands$4.moveEndToStartOfDocument=function(editor){editor.moveEndToStartOfNode(editor.value.document).moveToEnd()},Commands$4.moveEndToStartOfInline=function(editor){editor.command(pointEdgeObject,"end","start","inline")},Commands$4.moveEndToStartOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"end","start","next","block")},Commands$4.moveEndToStartOfNextInline=function(editor){editor.command(pointEdgeSideObject,"end","start","next","inline")},Commands$4.moveEndToStartOfNextText=function(editor){editor.command(pointEdgeSideObject,"end","start","next","text")},Commands$4.moveEndToStartOfNode=function(editor){for(var _len15=arguments.length,args=Array(_len15>1?_len15-1:0),_key15=1;_key15<_len15;_key15++)args[_key15-1]=arguments[_key15];editor.command.apply(editor,[proxy,"moveEndToStartOfNode"].concat(args))},Commands$4.moveEndToStartOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"end","start","previous","block")},Commands$4.moveEndToStartOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"end","start","previous","inline")},Commands$4.moveEndToStartOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"end","start","previous","text")},Commands$4.moveEndToStartOfText=function(editor){editor.command(pointEdgeObject,"end","start","text")},Commands$4.moveFocusBackward=function(editor){for(var _len16=arguments.length,args=Array(_len16>1?_len16-1:0),_key16=1;_key16<_len16;_key16++)args[_key16-1]=arguments[_key16];editor.command.apply(editor,[pointBackward,"focus"].concat(args))},Commands$4.moveFocusWordBackward=function(editor){for(var _len17=arguments.length,args=Array(_len17>1?_len17-1:0),_key17=1;_key17<_len17;_key17++)args[_key17-1]=arguments[_key17];editor.command.apply(editor,[pointWordBackward,"focus"].concat(args))},Commands$4.moveFocusForward=function(editor){for(var _len18=arguments.length,args=Array(_len18>1?_len18-1:0),_key18=1;_key18<_len18;_key18++)args[_key18-1]=arguments[_key18];editor.command.apply(editor,[pointForward,"focus"].concat(args))},Commands$4.moveFocusWordForward=function(editor){for(var _len19=arguments.length,args=Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++)args[_key19-1]=arguments[_key19];editor.command.apply(editor,[pointWordForward,"focus"].concat(args))},Commands$4.moveFocusTo=function(editor){for(var _len20=arguments.length,args=Array(_len20>1?_len20-1:0),_key20=1;_key20<_len20;_key20++)args[_key20-1]=arguments[_key20];editor.command.apply(editor,[proxy,"moveFocusTo"].concat(args))},Commands$4.moveFocusToEndOfBlock=function(editor){editor.command(pointEdgeObject,"focus","end","block")},Commands$4.moveFocusToEndOfDocument=function(editor){editor.moveFocusToEndOfNode(editor.value.document).moveToFocus()},Commands$4.moveFocusToEndOfInline=function(editor){editor.command(pointEdgeObject,"focus","end","inline")},Commands$4.moveFocusToEndOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"focus","end","next","block")},Commands$4.moveFocusToEndOfNextInline=function(editor){editor.command(pointEdgeSideObject,"focus","end","next","inline")},Commands$4.moveFocusToEndOfNextText=function(editor){editor.command(pointEdgeSideObject,"focus","end","next","text")},Commands$4.moveFocusToEndOfNode=function(editor){for(var _len21=arguments.length,args=Array(_len21>1?_len21-1:0),_key21=1;_key21<_len21;_key21++)args[_key21-1]=arguments[_key21];editor.command.apply(editor,[proxy,"moveFocusToEndOfNode"].concat(args))},Commands$4.moveFocusToEndOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"focus","end","previous","block")},Commands$4.moveFocusToEndOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"focus","end","previous","inline")},Commands$4.moveFocusToEndOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"focus","end","previous","text")},Commands$4.moveFocusToEndOfText=function(editor){editor.command(pointEdgeObject,"focus","end","text")},Commands$4.moveFocusToStartOfBlock=function(editor){editor.command(pointEdgeObject,"focus","start","block")},Commands$4.moveFocusToStartOfDocument=function(editor){editor.moveFocusToStartOfNode(editor.value.document).moveToFocus()},Commands$4.moveFocusToStartOfInline=function(editor){editor.command(pointEdgeObject,"focus","start","inline")},Commands$4.moveFocusToStartOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"focus","start","next","block")},Commands$4.moveFocusToStartOfNextInline=function(editor){editor.command(pointEdgeSideObject,"focus","start","next","inline")},Commands$4.moveFocusToStartOfNextText=function(editor){editor.command(pointEdgeSideObject,"focus","start","next","text")},Commands$4.moveFocusToStartOfNode=function(editor){for(var _len22=arguments.length,args=Array(_len22>1?_len22-1:0),_key22=1;_key22<_len22;_key22++)args[_key22-1]=arguments[_key22];editor.command.apply(editor,[proxy,"moveFocusToStartOfNode"].concat(args))},Commands$4.moveFocusToStartOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"focus","start","previous","block")},Commands$4.moveFocusToStartOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"focus","start","previous","inline")},Commands$4.moveFocusToStartOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"focus","start","previous","text")},Commands$4.moveFocusToStartOfText=function(editor){editor.command(pointEdgeObject,"focus","start","text")},Commands$4.moveForward=function(editor){var chars=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0!==chars){var value=editor.value,document=value.document,selection=value.selection,start=selection.start,startBlock=document.getClosestBlock(start.path),o=startBlock.getOffset(start.key),offset=o+start.offset,text=startBlock.text,charsOffset=TextUtils.getCharOffsetForward(text,offset,chars);editor.moveAnchorForward(charsOffset).moveFocusForward(charsOffset)}},Commands$4.moveWordForward=function(editor){for(var _editor$moveFocusWord,_len23=arguments.length,args=Array(_len23>1?_len23-1:0),_key23=1;_key23<_len23;_key23++)args[_key23-1]=arguments[_key23];(_editor$moveFocusWord=editor.moveFocusWordForward.apply(editor,args)).moveToFocus.apply(_editor$moveFocusWord,args)},Commands$4.moveStartBackward=function(editor){for(var _len24=arguments.length,args=Array(_len24>1?_len24-1:0),_key24=1;_key24<_len24;_key24++)args[_key24-1]=arguments[_key24];editor.command.apply(editor,[pointBackward,"start"].concat(args))},Commands$4.moveStartWordBackward=function(editor){for(var _len25=arguments.length,args=Array(_len25>1?_len25-1:0),_key25=1;_key25<_len25;_key25++)args[_key25-1]=arguments[_key25];editor.command.apply(editor,[pointWordBackward,"start"].concat(args))},Commands$4.moveStartForward=function(editor){for(var _len26=arguments.length,args=Array(_len26>1?_len26-1:0),_key26=1;_key26<_len26;_key26++)args[_key26-1]=arguments[_key26];editor.command.apply(editor,[pointForward,"start"].concat(args))},Commands$4.moveStartWordForward=function(editor){for(var _len27=arguments.length,args=Array(_len27>1?_len27-1:0),_key27=1;_key27<_len27;_key27++)args[_key27-1]=arguments[_key27];editor.command.apply(editor,[pointWordForward,"start"].concat(args))},Commands$4.moveStartTo=function(editor){for(var _len28=arguments.length,args=Array(_len28>1?_len28-1:0),_key28=1;_key28<_len28;_key28++)args[_key28-1]=arguments[_key28];editor.command.apply(editor,[proxy,"moveStartTo"].concat(args))},Commands$4.moveStartToEndOfBlock=function(editor){editor.command(pointEdgeObject,"start","end","block")},Commands$4.moveStartToEndOfDocument=function(editor){editor.moveStartToEndOfNode(editor.value.document).moveToStart()},Commands$4.moveStartToEndOfInline=function(editor){editor.command(pointEdgeObject,"start","end","inline")},Commands$4.moveStartToEndOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"start","end","next","block")},Commands$4.moveStartToEndOfNextInline=function(editor){editor.command(pointEdgeSideObject,"start","end","next","inline")},Commands$4.moveStartToEndOfNextText=function(editor){editor.command(pointEdgeSideObject,"start","end","next","text")},Commands$4.moveStartToEndOfNode=function(editor){for(var _len29=arguments.length,args=Array(_len29>1?_len29-1:0),_key29=1;_key29<_len29;_key29++)args[_key29-1]=arguments[_key29];editor.command.apply(editor,[proxy,"moveStartToEndOfNode"].concat(args))},Commands$4.moveStartToEndOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"start","end","previous","block")},Commands$4.moveStartToEndOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"start","end","previous","inline")},Commands$4.moveStartToEndOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"start","end","previous","text")},Commands$4.moveStartToEndOfText=function(editor){editor.command(pointEdgeObject,"start","end","text")},Commands$4.moveStartToStartOfBlock=function(editor){editor.command(pointEdgeObject,"start","start","block")},Commands$4.moveStartToStartOfDocument=function(editor){editor.moveStartToStartOfNode(editor.value.document).moveToStart()},Commands$4.moveStartToStartOfInline=function(editor){editor.command(pointEdgeObject,"start","start","inline")},Commands$4.moveStartToStartOfNextBlock=function(editor){editor.command(pointEdgeSideObject,"start","start","next","block")},Commands$4.moveStartToStartOfNextInline=function(editor){editor.command(pointEdgeSideObject,"start","start","next","inline")},Commands$4.moveStartToStartOfNextText=function(editor){editor.command(pointEdgeSideObject,"start","start","next","text")},Commands$4.moveStartToStartOfNode=function(editor){for(var _len30=arguments.length,args=Array(_len30>1?_len30-1:0),_key30=1;_key30<_len30;_key30++)args[_key30-1]=arguments[_key30];editor.command.apply(editor,[proxy,"moveStartToStartOfNode"].concat(args))},Commands$4.moveStartToStartOfPreviousBlock=function(editor){editor.command(pointEdgeSideObject,"start","start","previous","block")},Commands$4.moveStartToStartOfPreviousInline=function(editor){editor.command(pointEdgeSideObject,"start","start","previous","inline")},Commands$4.moveStartToStartOfPreviousText=function(editor){editor.command(pointEdgeSideObject,"start","start","previous","text")},Commands$4.moveStartToStartOfText=function(editor){editor.command(pointEdgeObject,"start","start","text")},Commands$4.moveTo=function(editor){for(var _len31=arguments.length,args=Array(_len31>1?_len31-1:0),_key31=1;_key31<_len31;_key31++)args[_key31-1]=arguments[_key31];editor.command.apply(editor,[proxy,"moveTo"].concat(args))},Commands$4.moveToAnchor=function(editor){editor.command(proxy,"moveToAnchor")},Commands$4.moveToEnd=function(editor){editor.command(proxy,"moveToEnd")},Commands$4.moveToEndOfBlock=function(editor){editor.moveEndToEndOfBlock().moveToEnd()},Commands$4.moveToEndOfDocument=function(editor){editor.moveEndToEndOfNode(editor.value.document).moveToEnd()},Commands$4.moveToEndOfInline=function(editor){editor.moveEndToEndOfInline().moveToEnd()},Commands$4.moveToEndOfNextBlock=function(editor){editor.moveEndToEndOfNextBlock().moveToEnd()},Commands$4.moveToEndOfNextInline=function(editor){editor.moveEndToEndOfNextInline().moveToEnd()},Commands$4.moveToEndOfNextText=function(editor){editor.moveEndToEndOfNextText().moveToEnd()},Commands$4.moveToEndOfNode=function(editor){for(var _len32=arguments.length,args=Array(_len32>1?_len32-1:0),_key32=1;_key32<_len32;_key32++)args[_key32-1]=arguments[_key32];editor.command.apply(editor,[proxy,"moveToEndOfNode"].concat(args))},Commands$4.moveToEndOfPreviousBlock=function(editor){editor.moveStartToEndOfPreviousBlock().moveToStart()},Commands$4.moveToEndOfPreviousInline=function(editor){editor.moveStartToEndOfPreviousInline().moveToStart()},Commands$4.moveToEndOfPreviousText=function(editor){editor.moveStartToEndOfPreviousText().moveToStart()},Commands$4.moveToEndOfText=function(editor){editor.moveEndToEndOfText().moveToEnd()},Commands$4.moveToFocus=function(editor){editor.command(proxy,"moveToFocus")},Commands$4.moveToRangeOfDocument=function(editor){editor.moveToRangeOfNode(editor.value.document)},Commands$4.moveToRangeOfNode=function(editor){for(var _len33=arguments.length,args=Array(_len33>1?_len33-1:0),_key33=1;_key33<_len33;_key33++)args[_key33-1]=arguments[_key33];editor.command.apply(editor,[proxy,"moveToRangeOfNode"].concat(args))},Commands$4.moveToStart=function(editor){editor.command(proxy,"moveToStart")},Commands$4.moveToStartOfBlock=function(editor){editor.moveStartToStartOfBlock().moveToStart()},Commands$4.moveToStartOfDocument=function(editor){editor.moveStartToStartOfNode(editor.value.document).moveToStart()},Commands$4.moveToStartOfInline=function(editor){editor.moveStartToStartOfInline().moveToStart()},Commands$4.moveToStartOfNextBlock=function(editor){editor.moveEndToStartOfNextBlock().moveToEnd()},Commands$4.moveToStartOfNextInline=function(editor){editor.moveEndToStartOfNextInline().moveToEnd()},Commands$4.moveToStartOfNextText=function(editor){editor.moveEndToStartOfNextText().moveToEnd()},Commands$4.moveToStartOfNode=function(editor){for(var _len34=arguments.length,args=Array(_len34>1?_len34-1:0),_key34=1;_key34<_len34;_key34++)args[_key34-1]=arguments[_key34];editor.command.apply(editor,[proxy,"moveToStartOfNode"].concat(args))},Commands$4.moveToStartOfPreviousBlock=function(editor){editor.moveStartToStartOfPreviousBlock().moveToStart()},Commands$4.moveToStartOfPreviousInline=function(editor){editor.moveStartToStartOfPreviousInline().moveToStart()},Commands$4.moveToStartOfPreviousText=function(editor){editor.moveStartToStartOfPreviousText().moveToStart()},Commands$4.moveToStartOfText=function(editor){editor.moveStartToStartOfText().moveToStart()},Commands$4.select=function(editor,properties){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};properties=Selection.createProperties(properties);var _options$snapshot=options.snapshot,snapshot=void 0!==_options$snapshot&&_options$snapshot,value=editor.value,document=value.document,selection=value.selection,newProperties={},next=selection.setProperties(properties);for(var k in next=document.resolveSelection(next),properties=pick_default()(next,Object.keys(properties)))!0!==snapshot&&(0,immutable.is)(properties[k],selection[k])||(newProperties[k]=properties[k]);if(selection.marks&&!newProperties.marks&&(newProperties.anchor||newProperties.focus)&&(newProperties.marks=null),0!==Object.keys(newProperties).length){var prevProperties=pick_default()(selection.toJSON(),Object.keys(newProperties));editor.applyOperation({type:"set_selection",value,properties:prevProperties,newProperties},snapshot?{skip:!1,merge:!1}:{})}},Commands$4.setAnchor=function(editor){for(var _len35=arguments.length,args=Array(_len35>1?_len35-1:0),_key35=1;_key35<_len35;_key35++)args[_key35-1]=arguments[_key35];editor.command.apply(editor,[proxy,"setAnchor"].concat(args))},Commands$4.setEnd=function(editor){for(var _len36=arguments.length,args=Array(_len36>1?_len36-1:0),_key36=1;_key36<_len36;_key36++)args[_key36-1]=arguments[_key36];editor.command.apply(editor,[proxy,"setEnd"].concat(args))},Commands$4.setFocus=function(editor){for(var _len37=arguments.length,args=Array(_len37>1?_len37-1:0),_key37=1;_key37<_len37;_key37++)args[_key37-1]=arguments[_key37];editor.command.apply(editor,[proxy,"setFocus"].concat(args))},Commands$4.setStart=function(editor){for(var _len38=arguments.length,args=Array(_len38>1?_len38-1:0),_key38=1;_key38<_len38;_key38++)args[_key38-1]=arguments[_key38];editor.command.apply(editor,[proxy,"setStart"].concat(args))},Commands$4.snapshotSelection=function(editor){editor.withoutMerging((function(){editor.select(editor.value.selection,{snapshot:!0})}))};var Commands$5={};function QueriesPlugin(){var queries=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function onConstruct(editor,next){for(var query in queries)editor.registerQuery(query);return next()}function onQuery(query,editor,next){var type=query.type,args=query.args,fn=queries[type];if(!fn)return next();var ret=fn.apply(void 0,[editor].concat(toConsumableArray(args)));return void 0===ret?next():ret}return{onConstruct,onQuery}}Commands$5.setData=function(editor){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},value=editor.value,newProperties=Value.createProperties({data}),prevProperties=pick_default()(value,Object.keys(newProperties));editor.applyOperation({type:"set_value",properties:prevProperties,newProperties})},Commands$5.addAnnotation=function(editor,annotation){annotation=Annotation.create(annotation),editor.applyOperation({type:"add_annotation",annotation})},Commands$5.removeAnnotation=function(editor,annotation){annotation=Annotation.create(annotation),editor.applyOperation({type:"remove_annotation",annotation})},Commands$5.setAnnotation=function(editor,annotation,newProperties){annotation=Annotation.create(annotation),newProperties=Annotation.createProperties(newProperties),editor.applyOperation({type:"set_annotation",properties:annotation,newProperties})},Commands$5.setAnnotations=function(editor){var annotations=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],value=editor.value,newProperties=Value.createProperties({annotations}),prevProperties=pick_default()(value,Object.keys(newProperties));editor.applyOperation({type:"set_value",properties:prevProperties,newProperties})};var SlateError=function(_Error){function SlateError(code){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};classCallCheck(this,SlateError);var _this=possibleConstructorReturn(this,(SlateError.__proto__||Object.getPrototypeOf(SlateError)).call(this,code));for(var key in _this.code=code,attrs)_this[key]=attrs[key];return Error.captureStackTrace?Error.captureStackTrace(_this,_this.constructor):_this.stack=(new Error).stack,_this}return inherits(SlateError,_Error),SlateError}(Error);function SchemaPlugin(schema){var rules=schema.rules,document=schema.document,blocks=schema.blocks,inlines=schema.inlines,marks=schema.marks,annotations=schema.annotations,decorations=schema.decorations,schemaRules=[];if(rules&&(schemaRules=schemaRules.concat(rules)),document&&schemaRules.push(_extends({match:[{object:"document"}]},document)),blocks)for(var key in blocks)schemaRules.push(_extends({match:[{object:"block",type:key}]},blocks[key]));if(inlines)for(var _key in inlines)schemaRules.push(_extends({match:[{object:"inline",type:_key}]},inlines[_key]));if(marks)for(var _key2 in marks)schemaRules.push(_extends({match:[{object:"mark",type:_key2}]},marks[_key2]));if(annotations)for(var _key3 in annotations)schemaRules.push(_extends({match:[{object:"annotation",type:_key3}]},annotations[_key3]));if(decorations)for(var _key4 in decorations)schemaRules.push(_extends({match:[{object:"decoration",type:_key4}]},decorations[_key4]));function validateNode(node,editor,next){var matches=schemaRules.filter((function(r){return testRules(node,r.match)})),failure=validateRules(node,matches,schemaRules,{every:!0});return failure?new SlateError(failure.code,failure):next()}return[{normalizeNode:function normalizeNode(node,editor,next){var error=validateNode(node,editor,(function(){}));return error?function(){var rule=error.rule,size=editor.operations.size;rule.normalize&&rule.normalize(editor,error),editor.operations.size===size&&function defaultNormalize(editor,error){var code=error.code,node=error.node,child=error.child,next=error.next,previous=error.previous,key=error.key,mark=error.mark;switch(code){case"child_max_invalid":case"child_object_invalid":case"child_type_invalid":case"child_unknown":case"first_child_object_invalid":case"first_child_type_invalid":case"last_child_object_invalid":case"last_child_type_invalid":return"text"===child.object&&"block"===node.object&&1===node.nodes.size?editor.removeNodeByKey(node.key):editor.removeNodeByKey(child.key);case"previous_sibling_object_invalid":case"previous_sibling_type_invalid":return"text"===previous.object&&"block"===node.object&&1===node.nodes.size?editor.removeNodeByKey(node.key):editor.removeNodeByKey(previous.key);case"next_sibling_object_invalid":case"next_sibling_type_invalid":return"text"===next.object&&"block"===node.object&&1===node.nodes.size?editor.removeNodeByKey(node.key):editor.removeNodeByKey(next.key);case"child_min_invalid":case"node_text_invalid":case"parent_object_invalid":case"parent_type_invalid":return"document"===node.object?node.nodes.forEach((function(n){return editor.removeNodeByKey(n.key)})):editor.removeNodeByKey(node.key);case"node_data_invalid":return void 0===node.data.get(key)&&"document"!==node.object?editor.removeNodeByKey(node.key):editor.setNodeByKey(node.key,{data:node.data.delete(key)});case"node_mark_invalid":return node.getTexts().forEach((function(t){return editor.removeMarkByKey(t.key,0,t.text.length,mark)}));default:return editor.removeNodeByKey(node.key)}}(editor,error)}:next()},validateNode},QueriesPlugin({isAtomic:function isAtomic(editor,format){var rule=schemaRules.find((function(r){return"isAtomic"in r&&testRules(format,r.match)}));return rule&&rule.isAtomic},isVoid:function isVoid(editor,node){var rule=schemaRules.find((function(r){return"isVoid"in r&&testRules(node,r.match)}));return rule&&rule.isVoid}})]}function testRules(object,rules){return!validateRules(object,rules)}function validateRules(object,rule,rules){var options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},_options$every=options.every,every=void 0!==_options$every&&_options$every,_options$match=options.match,match=void 0===_options$match?null:_options$match;if("function"==typeof rule){var valid=rule(object,match);return valid?null:fail("node_invalid",{rule,node:object})}if(Array.isArray(rule)){var array=rule.length?rule:[{}],first=void 0,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=array[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var r=_step.value,_error=validateRules(object,r,rules);if(first=first||_error,every&&_error)return _error;if(!every&&!_error)return}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return first}var error=validateObject(object,rule)||validateType(object,rule)||validateData(object,rule)||validateMarks(object,rule)||validateText(object,rule)||validateFirst(object,rule)||validateLast(object,rule)||validateNodes(object,rule,rules);return error}function validateObject(node,rule){if(null!=rule.object&&rule.object!==node.object&&("function"!=typeof rule.object||!rule.object(node.object)))return fail("node_object_invalid",{rule,node})}function validateType(node,rule){if(null!=rule.type&&rule.type!==node.type&&("function"!=typeof rule.type||!rule.type(node.type)))return fail("node_type_invalid",{rule,node})}function validateData(node,rule){if(null!=rule.data&&null!=node.data){if("function"==typeof rule.data){if(rule.data(node.data))return;return fail("node_data_invalid",{rule,node})}for(var key in rule.data){var fn=rule.data[key],value=node.data&&node.data.get(key);if(!("function"==typeof fn?fn(value):fn===value))return fail("node_data_invalid",{rule,node,key,value})}}}function validateMarks(node,rule){if(null!=rule.marks){var marks="text"===node.object?node.marks.toArray():node.getMarks().toArray(),_loop=function _loop(mark){return rule.marks.some((function(def){return"function"==typeof def.type?def.type(mark.type):def.type===mark.type}))?"continue":{v:fail("node_mark_invalid",{rule,node,mark})}},_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=marks[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _ret=_loop(_step2.value);if("continue"!==_ret&&"object"===(void 0===_ret?"undefined":_typeof(_ret)))return _ret.v}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}}function validateText(node,rule){if(null!=rule.text){var text=node.text;if(!("function"==typeof rule.text?rule.text(text):rule.text.test(text)))return fail("node_text_invalid",{rule,node,text})}}function validateFirst(node,rule){if(null!=rule.first){var first=node.nodes.first();if(first){var error=validateRules(first,rule.first);if(error)return error.rule=rule,error.node=node,error.child=first,error.code=error.code.replace("node_","first_child_"),error}}}function validateLast(node,rule){if(null!=rule.last){var last=node.nodes.last();if(last){var error=validateRules(last,rule.last);if(error)return error.rule=rule,error.node=node,error.child=last,error.code=error.code.replace("node_","last_child_"),error}}}function validateNodes(node,rule){var rules=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null!=node.nodes){var children=node.nodes,defs=null!=rule.nodes?rule.nodes.slice():[],count=0,lastCount=0,min=null,index=-1,def=null,max=null,child=null,previous=null,next=null;for(null!=rule.nodes&&nextDef();nextChild();){var err=validateParent(node,child,rules)||validatePrevious(node,child,previous,index,rules)||validateNext(node,child,next,index,rules);if(err)return err;if(null!=rule.nodes){if(!def)return fail("child_unknown",{rule,node,child,index});if(def.match){var error=validateRules(child,def.match);if(error){if(null!=max&&count-1>max)return rewind(),fail("child_max_invalid",{rule,node,index,child:children.get(index),count,limit:max});var lastMin=min;if(nextDef()){if(lastCount-1>=lastMin){index-=1;continue}return null==validateRules(child,def.match)?(rewind(),fail("child_min_invalid",{rule,node,index,count:lastCount-1,limit:lastMin})):(error.rule=rule,error.node=node,error.child=child,error.index=index,error.code=error.code.replace("node_","child_"),error)}return null!=max&&count>max?fail("child_unknown",{rule,node,child,index}):(error.rule=rule,error.node=node,error.child=child,error.index=index,error.code=error.code.replace("node_","child_"),error)}}}}if(null!=max&&count>max)return fail("child_max_invalid",{rule,node,index:index-1,count,child:children.get(index-1),limit:max});if(null!=rule.nodes)do{if(count<min)return fail("child_min_invalid",{rule,node,index,count,limit:min})}while(nextDef())}function nextDef(){return 0!==defs.length&&(def=defs.shift(),lastCount=count,count=0,min=def.min||null,max=def.max||null,!0)}function nextChild(){return previous=(index+=1)?children.get(index-1):null,child=children.get(index),next=children.get(index+1),!!child&&(lastCount=count,count+=1,!0)}function rewind(){index>0&&(index-=1,count=lastCount)}}function validateParent(node,child,rules){var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=rules[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var rule=_step3.value;if(null!=rule.parent&&testRules(child,rule.match)){var error=validateRules(node,rule.parent);if(error)return error.rule=rule,error.parent=node,error.node=child,error.code=error.code.replace("node_","parent_"),error}}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}function validatePrevious(node,child,previous,index,rules){if(previous){var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=rules[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var rule=_step4.value;if(null!=rule.previous&&testRules(child,rule.match)){var error=validateRules(previous,rule.previous);if(error)return error.rule=rule,error.node=node,error.child=child,error.index=index,error.previous=previous,error.code=error.code.replace("node_","previous_sibling_"),error}}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}}function validateNext(node,child,next,index,rules){if(next){var _iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _step5,_iterator5=rules[Symbol.iterator]();!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){var rule=_step5.value;if(null!=rule.next&&testRules(child,rule.match)){var error=validateRules(next,rule.next,[],{match:child});if(error)return error.rule=rule,error.node=node,error.child=child,error.index=index,error.next=next,error.code=error.code.replace("node_","next_sibling_"),error}}}catch(err){_didIteratorError5=!0,_iteratorError5=err}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}}}function fail(code,attrs){return _extends({code},attrs)}function deleteExpanded(editor){editor.value.selection.isExpanded&&editor.delete()}var Commands$6={};function CorePlugin(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_options$plugins=options.plugins,plugins=void 0===_options$plugins?[]:_options$plugins,commands=CommandsPlugin(_extends({},Commands$1,Commands$2,Commands$3,Commands$4,Commands$5,Commands$6)),queries=QueriesPlugin({isAtomic:function isAtomic(){return!1},isVoid:function isVoid(){return!1}}),schema=SchemaPlugin({rules:[{match:{object:"document"},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:{object:"block"}},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:[{object:"inline"},{object:"text"}]},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:{object:"inline"},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:[{object:"block"},{object:"inline"}],nodes:[{min:1}],normalize:function normalize(editor,error){var code=error.code,node=error.node;"child_min_invalid"===code&&node.nodes.isEmpty()&&editor.insertNodeByKey(node.key,0,Text.create())}},{match:{object:"block"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],normalize:function normalize(editor,error){var code=error.code,node=error.node,text=Text.create(),i=void 0;if("first_child_object_invalid"===code)i=0;else{if("last_child_object_invalid"!==code)return;i=node.nodes.size}editor.insertNodeByKey(node.key,i,text)}},{match:{object:"inline"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],previous:[{object:"block"},{object:"text"}],next:[{object:"block"},{object:"text"}],normalize:function normalize(editor,error){var code=error.code,node=error.node,index=error.index,text=Text.create(),i=void 0;if("first_child_object_invalid"===code)i=0;else if("last_child_object_invalid"===code)i=node.nodes.size;else if("previous_sibling_object_invalid"===code)i=index;else{if("next_sibling_object_invalid"!==code)return;i=index+1}editor.insertNodeByKey(node.key,i,text)}},{match:{object:"text"},next:function next(_next,match){return"text"!==_next.object||!match.marks.equals(_next.marks)},normalize:function normalize(editor,error){var code=error.code,next=error.next;"next_sibling_invalid"===code&&editor.mergeNodeByKey(next.key)}},{match:{object:"text"},previous:function previous(prev){return"text"!==prev.object||""!==prev.text},next:function next(_next2){return"text"!==_next2.object||""!==_next2.text},normalize:function normalize(editor,error){var code=error.code,next=error.next,previous=error.previous;"next_sibling_invalid"===code?editor.removeNodeByKey(next.key):"previous_sibling_invalid"===code&&editor.removeNodeByKey(previous.key)}}]});return[schema].concat(toConsumableArray(plugins),[commands,queries])}Commands$6.addMark=function(editor,mark){mark=Mark.create(mark);var value=editor.value,document=value.document,selection=value.selection;if(selection.isExpanded)editor.addMarkAtRange(selection,mark);else if(selection.marks){var marks=selection.marks.add(mark),sel=selection.set("marks",marks);editor.select(sel)}else{var _marks=document.getActiveMarksAtRange(selection).add(mark),_sel=selection.set("marks",_marks);editor.select(_sel)}},Commands$6.addMarks=function(editor,marks){marks.forEach((function(mark){return editor.addMark(mark)}))},Commands$6.delete=function(editor){var selection=editor.value.selection;editor.deleteAtRange(selection),editor.moveToFocus()},Commands$6.deleteBackward=function(editor){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,value=editor.value,selection=value.selection;selection.isExpanded?editor.delete():editor.deleteBackwardAtRange(selection,n)},Commands$6.deleteCharBackward=function(editor){var selection=editor.value.selection;selection.isExpanded?editor.delete():editor.deleteCharBackwardAtRange(selection)},Commands$6.deleteLineBackward=function(editor){var selection=editor.value.selection;selection.isExpanded?editor.delete():editor.deleteLineBackwardAtRange(selection)},Commands$6.deleteWordBackward=function(editor){var selection=editor.value.selection;selection.isExpanded?editor.delete():editor.deleteWordBackwardAtRange(selection)},Commands$6.deleteForward=function(editor){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,value=editor.value,selection=value.selection;selection.isExpanded?editor.delete():editor.deleteForwardAtRange(selection,n)},Commands$6.deleteCharForward=function(editor){var selection=editor.value.selection;selection.isExpanded?editor.delete():editor.deleteCharForwardAtRange(selection)},Commands$6.deleteLineForward=function(editor){var selection=editor.value.selection;selection.isExpanded?editor.delete():editor.deleteLineForwardAtRange(selection)},Commands$6.deleteWordForward=function(editor){var selection=editor.value.selection;selection.isExpanded?editor.delete():editor.deleteWordForwardAtRange(selection)},Commands$6.insertBlock=function(editor,block){deleteExpanded(editor),block=Block.create(block);var selection=editor.value.selection;editor.insertBlockAtRange(selection,block);var node=editor.value.document.getNode(block.key);node&&editor.moveToEndOfNode(node)},Commands$6.insertFragment=function(editor,fragment){if(fragment.nodes.size){deleteExpanded(editor);var value=editor.value,_value=value,document=_value.document,selection=_value.selection,start=selection.start,keys=Array.from(document.texts(),(function(_ref){return slicedToArray(_ref,1)[0].key}));editor.insertFragmentAtRange(selection,fragment);var newTexts=(document=(value=editor.value).document).getTexts().filter((function(n){return!keys.includes(n.key)}));if(0!==newTexts.size){var fragmentLength=fragment.text.length,startText=document.getNode(start.key)||newTexts.first(),endText=newTexts.last()||startText;if(startText!==endText){var parent=document.getCommonAncestor(startText.key,endText.key),startOffset=parent.getOffset(startText.key)+(start.key===startText.key?start.offset:0);endText=parent.getTextAtOffset(startOffset+fragmentLength-1)||endText,editor.moveTo(endText.key,startOffset+fragmentLength-parent.getOffset(endText.key))}else editor.moveTo(endText.key,fragmentLength)}}},Commands$6.insertInline=function(editor,inline){deleteExpanded(editor),inline=Inline.create(inline);var selection=editor.value.selection;editor.insertInlineAtRange(selection,inline);var node=editor.value.document.getNode(inline.key);node&&editor.moveToEndOfNode(node)},Commands$6.insertText=function(editor,text,marks){deleteExpanded(editor);var value=editor.value,document=value.document,selection=value.selection;marks=marks||selection.marks||document.getInsertMarksAtRange(selection),editor.withoutNormalizing((function(){editor.insertTextAtRange(selection,text,marks),selection.marks&&document!==editor.value.document&&editor.select({marks:null})}))},Commands$6.removeMark=function(editor,mark){mark=Mark.create(mark);var value=editor.value,document=value.document,selection=value.selection;if(selection.isExpanded)editor.removeMarkAtRange(selection,mark);else if(selection.marks){var marks=selection.marks.remove(mark),sel=selection.set("marks",marks);editor.select(sel)}else{var _marks2=document.getActiveMarksAtRange(selection).remove(mark),_sel2=selection.set("marks",_marks2);editor.select(_sel2)}},Commands$6.replaceMark=function(editor,oldMark,newMark){editor.removeMark(oldMark),editor.addMark(newMark)},Commands$6.setBlocks=function(editor,properties){var selection=editor.value.selection;editor.setBlocksAtRange(selection,properties)},Commands$6.setInlines=function(editor,properties){var selection=editor.value.selection;editor.setInlinesAtRange(selection,properties)},Commands$6.splitBlock=function(editor){var depth=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;deleteExpanded(editor);var value=editor.value,selection=value.selection,document=value.document,marks=selection.marks||document.getInsertMarksAtRange(selection);editor.splitBlockAtRange(selection,depth).moveToEnd(),marks&&0!==marks.size&&editor.select({marks})},Commands$6.splitInline=function(editor,height){deleteExpanded(editor);var selection=editor.value.selection;editor.splitInlineAtRange(selection,height)},Commands$6.toggleMark=function(editor,mark){mark=Mark.create(mark),editor.value.activeMarks.has(mark)?editor.removeMark(mark):editor.addMark(mark)},Commands$6.unwrapBlock=function(editor,properties){var selection=editor.value.selection;editor.unwrapBlockAtRange(selection,properties)},Commands$6.unwrapInline=function(editor,properties){var selection=editor.value.selection;editor.unwrapInlineAtRange(selection,properties)},Commands$6.wrapBlock=function(editor,block){var selection=editor.value.selection;editor.wrapBlockAtRange(selection,block)},Commands$6.wrapInline=function(editor,inline){var selection=editor.value.selection;editor.wrapInlineAtRange(selection,inline)},Commands$6.wrapText=function(editor,prefix){var suffix=arguments.length>2&&void 0!==arguments[2]?arguments[2]:prefix,value=editor.value,selection=value.selection;editor.wrapTextAtRange(selection,prefix,suffix),selection.isCollapsed&&editor.moveStartBackward(prefix.length),editor.moveEndBackward(suffix.length),selection.isForward!==editor.value.selection.isForward&&editor.flip()};var debug$2=browser_default()("slate:editor"),Editor=function(){function Editor(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};classCallCheck(this,Editor);var _options$controller=options.controller,controller=void 0===_options$controller?this:_options$controller,_options$construct=options.construct,construct=void 0===_options$construct||_options$construct,_attrs$onChange=attrs.onChange,onChange=void 0===_attrs$onChange?function(){}:_attrs$onChange,_attrs$plugins=attrs.plugins,plugins=void 0===_attrs$plugins?[]:_attrs$plugins,_attrs$readOnly=attrs.readOnly,readOnly=void 0!==_attrs$readOnly&&_attrs$readOnly,_attrs$value=attrs.value,value=void 0===_attrs$value?Value.create():_attrs$value;this.controller=controller,this.middleware={},this.onChange=onChange,this.operations=(0,immutable.List)(),this.readOnly=null,this.value=null,this.tmp={dirty:[],flushing:!1,merge:null,normalize:!0,save:!0};var core=CorePlugin({plugins});registerPlugin(this,core),construct&&(this.run("onConstruct"),this.setReadOnly(readOnly),this.setValue(value,options))}return createClass(Editor,[{key:"applyOperation",value:function applyOperation(operation){var _this=this,operations=this.operations,controller=this.controller,value=this.value;is_plain_object_default()(operation)&&(operation=_extends({},operation,{value})),operation=Operation.create(operation),this.withoutNormalizing((function(){controller.save(operation),value=_this.value})),debug$2("apply",{operation}),this.value=operation.apply(value),this.operations=operations.push(operation);var newDirtyPaths=function getDirtyPaths(operation){var type=operation.type,node=operation.node,path=operation.path,newPath=operation.newPath;switch(type){case"add_mark":case"insert_text":case"remove_mark":case"remove_text":case"set_mark":case"set_node":var ancestors=PathUtils.getAncestors(path).toArray();return[].concat(toConsumableArray(ancestors),[path]);case"insert_node":var table=node.getKeysToPathsTable(),paths=Object.values(table).map((function(p){return path.concat(p)})),_ancestors=PathUtils.getAncestors(path).toArray();return[].concat(toConsumableArray(_ancestors),[path],toConsumableArray(paths));case"split_node":var _ancestors2=PathUtils.getAncestors(path).toArray(),nextPath=PathUtils.increment(path);return[].concat(toConsumableArray(_ancestors2),[path,nextPath]);case"merge_node":var _ancestors3=PathUtils.getAncestors(path).toArray(),previousPath=PathUtils.decrement(path);return[].concat(toConsumableArray(_ancestors3),[previousPath]);case"move_node":if(PathUtils.isEqual(path,newPath))return[];var oldAncestors=PathUtils.getAncestors(path).reduce((function(arr,p){return arr.push.apply(arr,toConsumableArray(PathUtils.transform(p,operation).toArray())),arr}),[]),newAncestors=PathUtils.getAncestors(newPath).reduce((function(arr,p){return arr.push.apply(arr,toConsumableArray(PathUtils.transform(p,operation).toArray())),arr}),[]);return[].concat(toConsumableArray(oldAncestors),toConsumableArray(newAncestors));case"remove_node":var _ancestors4=PathUtils.getAncestors(path).toArray();return[].concat(toConsumableArray(_ancestors4));default:return[]}}(operation),dirty=this.tmp.dirty.map((function(path){return path=PathUtils.create(path),PathUtils.transform(path,operation).toArray()})),pathIndex={},dirtyPaths=Array.prototype.concat.apply(newDirtyPaths,dirty);return this.tmp.dirty=[],dirtyPaths.forEach((function(dirtyPath){var key=dirtyPath.join(",");pathIndex[key]||_this.tmp.dirty.push(dirtyPath),pathIndex[key]=!0})),this.tmp.flushing||(this.tmp.flushing=!0,Promise.resolve().then((function(){return _this.flush()}))),controller}},{key:"flush",value:function flush(){this.run("onChange");var value=this.value,operations=this.operations,controller=this.controller,change={value,operations};return this.operations=(0,immutable.List)(),this.tmp.flushing=!1,this.onChange(change),controller}},{key:"command",value:function command(type){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var controller=this.controller;if("function"==typeof type)return type.apply(void 0,[controller].concat(args)),normalizeDirtyPaths(this),controller;debug$2("command",{type,args});var obj={type,args};return this.run("onCommand",obj),normalizeDirtyPaths(this),controller}},{key:"hasCommand",value:function hasCommand(type){var controller=this.controller;return type in controller&&controller[type].__command}},{key:"hasQuery",value:function hasQuery(type){var controller=this.controller;return type in controller&&controller[type].__query}},{key:"normalize",value:function normalize(){var value=this.value,controller=this.controller,document=value.document,table=document.getKeysToPathsTable(),paths=Object.values(table).map(PathUtils.create);this.tmp.dirty=this.tmp.dirty.concat(paths),normalizeDirtyPaths(this);var selection=value.selection;return document=value.document,selection.isUnset&&document.nodes.size&&controller.moveToStartOfDocument(),controller}},{key:"query",value:function query(type){for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];var controller=this.controller;if("function"==typeof type)return type.apply(void 0,[controller].concat(args));debug$2("query",{type,args});var obj={type,args};return this.run("onQuery",obj)}},{key:"registerCommand",value:function registerCommand(type){var _this2=this,controller=this.controller;if(type in controller&&controller[type].__command)return controller;tiny_invariant_esm(!(type in controller),"You cannot register a `"+type+"` command because it would overwrite an existing property of the `Editor`.");var method=function method(){for(var _len3=arguments.length,args=Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];return _this2.command.apply(_this2,[type].concat(args))};return controller[type]=method,method.__command=!0,controller}},{key:"registerQuery",value:function registerQuery(type){var _this3=this,controller=this.controller;if(type in controller&&controller[type].__query)return controller;tiny_invariant_esm(!(type in controller),"You cannot register a `"+type+"` query because it would overwrite an existing property of the `Editor`.");var method=function method(){for(var _len4=arguments.length,args=Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=arguments[_key4];return _this3.query.apply(_this3,[type].concat(args))};return controller[type]=method,method.__query=!0,controller}},{key:"run",value:function run(key){for(var _len5=arguments.length,args=Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++)args[_key5-1]=arguments[_key5];var controller=this.controller,middleware=this.middleware,fns=middleware[key]||[],i=0;function next(){var fn=fns[i++];if(fn){for(var _len6=arguments.length,overrides=Array(_len6),_key6=0;_key6<_len6;_key6++)overrides[_key6]=arguments[_key6];overrides.length&&(args=overrides);var ret=fn.apply(void 0,toConsumableArray(args).concat([controller,next]));return ret}}return Object.defineProperty(next,"change",{get:function get$$1(){tiny_invariant_esm(!1,"As of Slate 0.42, the `editor` is no longer passed as the third argument to event handlers. You can access it via `change.editor` instead.")}}),Object.defineProperty(next,"onChange",{get:function get$$1(){tiny_invariant_esm(!1,"As of Slate 0.42, the `editor` is no longer passed as the third argument to event handlers. You can access it via `change.editor` instead.")}}),Object.defineProperty(next,"props",{get:function get$$1(){tiny_invariant_esm(!1,"As of Slate 0.42, the `editor` is no longer passed as the third argument to event handlers. You can access it via `change.editor` instead.")}}),Object.defineProperty(next,"schema",{get:function get$$1(){tiny_invariant_esm(!1,"As of Slate 0.42, the `editor` is no longer passed as the third argument to event handlers. You can access it via `change.editor` instead.")}}),Object.defineProperty(next,"stack",{get:function get$$1(){tiny_invariant_esm(!1,"As of Slate 0.42, the `editor` is no longer passed as the third argument to event handlers. You can access it via `change.editor` instead.")}}),next()}},{key:"setReadOnly",value:function setReadOnly(readOnly){return this.readOnly=readOnly,this}},{key:"setValue",value:function setValue(value){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_options$normalize=options.normalize,normalize=void 0===_options$normalize?value!==this.value:_options$normalize;return this.value=value,normalize&&this.normalize(),this}},{key:"withoutNormalizing",value:function withoutNormalizing(fn){var controller=this.controller,value=this.tmp.normalize;return this.tmp.normalize=!1,fn(controller),this.tmp.normalize=value,normalizeDirtyPaths(this),controller}},{key:"change",value:function change(fn){tiny_warning_esm(!1,"As of Slate 0.43 the `change` object has been replaced with `editor`, so the `editor.change()` method is deprecated.`");for(var _len7=arguments.length,args=Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++)args[_key7-1]=arguments[_key7];fn.apply(void 0,[this.controller].concat(args))}},{key:"call",value:function call(fn){tiny_warning_esm(!1,"As of Slate 0.43 the `editor.call(fn)` method has been deprecated, please use `editor.command(fn)` instead.");for(var _len8=arguments.length,args=Array(_len8>1?_len8-1:0),_key8=1;_key8<_len8;_key8++)args[_key8-1]=arguments[_key8];return fn.apply(void 0,[this.controller].concat(args)),this.controller}},{key:"applyOperations",value:function applyOperations(operations){var _this4=this;return tiny_warning_esm(!1,"As of Slate 0.43 the `applyOperations` method is deprecated, please apply each operation in a loop instead."),operations.forEach((function(op){return _this4.applyOperation(op)})),this.controller}},{key:"setOperationFlag",value:function setOperationFlag(key,value){return tiny_warning_esm(!1,"As of slate@0.41 the `change.setOperationFlag` method has been deprecated."),this.tmp[key]=value,this}},{key:"getFlag",value:function getFlag(key){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tiny_warning_esm(!1,"As of slate@0.41 the `change.getFlag` method has been deprecated."),void 0!==options[key]?options[key]:this.tmp[key]}},{key:"unsetOperationFlag",value:function unsetOperationFlag(key){return tiny_warning_esm(!1,"As of slate@0.41 the `change.unsetOperationFlag` method has been deprecated."),delete this.tmp[key],this}},{key:"withoutNormalization",value:function withoutNormalization(fn){return tiny_warning_esm(!1,"As of slate@0.41 the `change.withoutNormalization` helper has been renamed to `change.withoutNormalizing`."),this.withoutNormalizing(fn)}},{key:"editor",get:function get$$1(){return tiny_warning_esm(!1,"As of Slate 0.43 the `change` object has been replaced with `editor`, so you don't need to access `change.editor`."),this.controller}}]),Editor}();function normalizeDirtyPaths(editor){editor.tmp.normalize&&editor.tmp.dirty.length&&editor.withoutNormalizing((function(){for(;editor.tmp.dirty.length;){var path=editor.tmp.dirty.pop();normalizeNodeByPath(editor,path)}}))}function normalizeNodeByPath(editor,path){for(var controller=editor.controller,value=editor.value,document=value.document,node=document.assertNode(path),iterations=0,max=100+("text"===node.object?1:node.nodes.size);node;){var fn=node.normalize(controller);if(!fn)break;fn(controller),document=(value=editor.value).document;var key=node.key,found=document.getDescendant(path);if(found&&found.key===key)node=found;else{if(!(found=document.getDescendant(key)))break;node=found,path=document.getPath(key)}if(++iterations>max)throw new Error("A schema rule could not be normalized after sufficient iterations. This is usually due to a `rule.normalize` or `plugin.normalizeNode` function of a schema being incorrectly written, causing an infinite loop.")}}function registerPlugin(editor,plugin){if(Array.isArray(plugin))plugin.forEach((function(p){return registerPlugin(editor,p)}));else if(null!=plugin){var commands=plugin.commands,queries=plugin.queries,schema=plugin.schema,rest=objectWithoutProperties(plugin,["commands","queries","schema"]);if(commands){var commandsPlugin=CommandsPlugin(commands);registerPlugin(editor,commandsPlugin)}if(queries){var queriesPlugin=QueriesPlugin(queries);registerPlugin(editor,queriesPlugin)}if(schema){var schemaPlugin=SchemaPlugin(schema);registerPlugin(editor,schemaPlugin)}for(var key in rest){var fn=rest[key];(editor.middleware[key]=editor.middleware[key]||[]).push(fn)}}}var DEFAULTS$13={marks:void 0,text:void 0},Leaf$1=function(_Record){function Leaf(){return classCallCheck(this,Leaf),possibleConstructorReturn(this,(Leaf.__proto__||Object.getPrototypeOf(Leaf)).apply(this,arguments))}return inherits(Leaf,_Record),createClass(Leaf,[{key:"updateMark",value:function updateMark(mark,newMark){var marks=this.marks;if(newMark.equals(mark))return this;if(!marks.has(mark))return this;var newMarks=marks.withMutations((function(collection){collection.remove(mark).add(newMark)}));return this.set("marks",newMarks)}},{key:"addMark",value:function addMark(mark){var marks=this.marks;return this.set("marks",marks.add(mark))}},{key:"addMarks",value:function addMarks(set$$1){var marks=this.marks;return this.set("marks",marks.union(set$$1))}},{key:"insertText",value:function insertText(offset,string){var text=this.text,next=text.slice(0,offset)+string+text.slice(offset);return this.set("text",next)}},{key:"removeMark",value:function removeMark(mark){var marks=this.marks;return this.set("marks",marks.remove(mark))}},{key:"toJSON",value:function toJSON(){return{object:this.object,text:this.text,marks:this.marks.toArray().map((function(m){return m.toJSON()}))}}}],[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(tiny_warning_esm(!1,"As of slate@0.47 the `Leaf` model is deprecated."),Leaf.isLeaf(attrs))return attrs;if("string"==typeof attrs&&(attrs={text:attrs}),is_plain_object_default()(attrs))return Leaf.fromJSON(attrs);throw new Error("`Leaf.create` only accepts objects, strings or leaves, but you passed it: "+attrs)}},{key:"createLeaves",value:function createLeaves(leaves){if(leaves.size<=1)return leaves;var invalid=!1,result=(0,immutable.List)().withMutations((function(cache){leaves.findLast((function(leaf,index){var firstLeaf=cache.first();if(firstLeaf){if(firstLeaf.marks.equals(leaf.marks))return invalid=!0,void cache.set(0,firstLeaf.set("text",""+leaf.text+firstLeaf.text));if(""===firstLeaf.text)return invalid=!0,void cache.set(0,leaf);if(""===leaf.text)return void(invalid=!0)}cache.unshift(leaf)}))}));return invalid?result:leaves}},{key:"splitLeaves",value:function splitLeaves(leaves,offset){if(offset<0)return[(0,immutable.List)(),leaves];if(0===leaves.size)return[(0,immutable.List)(),(0,immutable.List)()];var endOffset=0,index=-1,left=void 0,right=void 0;return leaves.find((function(leaf){index++;var startOffset=endOffset,text=leaf.text;if((endOffset+=text.length)<offset)return!1;if(startOffset>offset)return!1;var length=offset-startOffset;return left=leaf.set("text",text.slice(0,length)),right=leaf.set("text",text.slice(length)),!0})),left?""===left.text?0===index?[immutable.List.of(left),leaves]:[leaves.take(index),leaves.skip(index)]:""===right.text?index===leaves.size-1?[leaves,immutable.List.of(right)]:[leaves.take(index+1),leaves.skip(index+1)]:[leaves.take(index).push(left),leaves.skip(index+1).unshift(right)]:[leaves,(0,immutable.List)()]}},{key:"createList",value:function createList(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(immutable.List.isList(attrs)||Array.isArray(attrs)){var list=new immutable.List(attrs.map(Leaf.create));return list}throw new Error("`Leaf.createList` only accepts arrays or lists, but you passed it: "+attrs)}},{key:"fromJSON",value:function fromJSON(object){var _object$text=object.text,text=void 0===_object$text?"":_object$text,_object$marks=object.marks,marks=void 0===_object$marks?[]:_object$marks;return new Leaf({text,marks:(0,immutable.Set)(marks.map(Mark.fromJSON))})}},{key:"isLeafList",value:function isLeafList(any){return immutable.List.isList(any)&&any.every((function(item){return Leaf.isLeaf(item)}))}}]),Leaf}((0,immutable.Record)(DEFAULTS$13));function mixin(Interface,Classes){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=Classes[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var Class=_step.value,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=Object.getOwnPropertyNames(Interface)[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var name=_step2.value;if(!Class.hasOwnProperty(name)){var desc=Object.getOwnPropertyDescriptor(Interface,name);Object.defineProperty(Class,name,desc)}}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=Object.getOwnPropertyNames(Interface.prototype)[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var _name=_step3.value;if(!Class.prototype.hasOwnProperty(_name)){desc=Object.getOwnPropertyDescriptor(Interface.prototype,_name);Object.defineProperty(Class.prototype,_name,desc)}}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}Object.entries({Annotation,Block,Change,Decoration,Document,Editor,Inline,Leaf:Leaf$1,Mark,Node,Operation,Point,Range,Selection,Text,Value}).forEach((function(_ref){var _ref2=slicedToArray(_ref,2),camel=_ref2[0],obj=_ref2[1];return mixin(function create$2(type){var TYPE=TYPES[type],is$$1="is"+type.charAt(0).toUpperCase()+type.slice(1),ObjectInterface=function(){function ObjectInterface(){classCallCheck(this,ObjectInterface)}return createClass(ObjectInterface,[{key:"object",get:function get$$1(){return type}}]),ObjectInterface}();return ObjectInterface[is$$1]=isObject.bind(null,type),ObjectInterface.prototype[TYPE]=!0,ObjectInterface}(camel.toLowerCase()),[obj])})),mixin(function(){function ModelInterface(){classCallCheck(this,ModelInterface)}return createClass(ModelInterface,[{key:"toJS",value:function toJS(){return this.toJSON.apply(this,arguments)}}],[{key:"fromJS",value:function fromJS(){return this.fromJSON.apply(this,arguments)}}]),ModelInterface}(),[Annotation,Block,Decoration,Document,Inline,Leaf$1,Mark,Node,Operation,Point,Range,Selection,Text,Value]);var ENABLED=!0,LEAF=Symbol("LEAF"),STORE_KEY=Symbol("STORE_KEY"),UNDEFINED=Symbol("undefined"),NULL=Symbol("null"),memoizeStore=new WeakMap;function memoize(object,properties){var _loop=function _loop(property){var original=object[property];if(!original)throw new Error('Object does not have a property named "'+property+'".');object[property]=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];if(!ENABLED)return original.apply(this,args);memoizeStore.has(this)||memoizeStore.set(this,{noArgs:{},hasArgs:{}});var _memoizeStore$get=memoizeStore.get(this),noArgs=_memoizeStore$get.noArgs,hasArgs=_memoizeStore$get.hasArgs,takesArguments=0!==args.length,cachedValue=void 0,keys=void 0;if(undefined!==(cachedValue=takesArguments?getIn(hasArgs,keys=[property].concat(args)):noArgs[property]))return cachedValue===UNDEFINED?void 0:cachedValue;var value=original.apply(this,args),v=void 0===value?UNDEFINED:value;return takesArguments?setIn(hasArgs,keys,v):noArgs[property]=v,value}},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=properties[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){_loop(_step.value)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}function getIn(map,keys){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=keys[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var key=_step2.value;if(void 0===key?key=UNDEFINED:null==key&&(key=NULL),undefined===(map="object"===(void 0===key?"undefined":_typeof(key))?map[STORE_KEY]&&map[STORE_KEY].get(key):map[key]))return}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return map[LEAF]}function setIn(map,keys,value){var child=map,_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=keys[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var key=_step3.value;if(void 0===key?key=UNDEFINED:null==key&&(key=NULL),"object"===(void 0===key?"undefined":_typeof(key)))if(child[STORE_KEY]||(child[STORE_KEY]=new WeakMap),child[STORE_KEY].has(key))child=child[STORE_KEY].get(key);else{var newChild={};child[STORE_KEY].set(key,newChild),child=newChild}else child[key]||(child[key]={}),child=child[key]}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}return child[LEAF]=value,map}var NodeInterface=function(){function NodeInterface(){classCallCheck(this,NodeInterface)}return createClass(NodeInterface,[{key:"getFirstText",value:function getFirstText(){if("text"===this.object)return this;var descendant=null,found=this.nodes.find((function(node){return"text"===node.object||!!(descendant=node.getFirstText())}));return descendant||found}},{key:"getKeysToPathsTable",value:function getKeysToPathsTable(){var ret=defineProperty({},this.key,[]);return this.nodes&&this.nodes.forEach((function(node,i){var nested=node.getKeysToPathsTable();for(var key in nested){var path=nested[key];tiny_warning_esm(!(key in ret),'A node with a duplicate key of "'+key+'" was found! Duplicate keys are not allowed, you should use `node.regenerateKey` before inserting if you are reusing an existing node.'),ret[key]=[i].concat(toConsumableArray(path))}})),ret}},{key:"getLastText",value:function getLastText(){if("text"===this.object)return this;var descendant=null,found=this.nodes.findLast((function(node){return"text"===node.object||(descendant=node.getLastText())}));return descendant||found}},{key:"getNode",value:function getNode(path){return(path=this.resolvePath(path))?"text"===this.object&&path.size?null:path.size?this.getDescendant(path):this:null}},{key:"getPath",value:function getPath(key){if(immutable.List.isList(key))return key;if(Node.isNode(key)&&this.descendants){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=this.descendants()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ref=_step.value,_ref2=slicedToArray(_ref,2),node=_ref2[0],_path=_ref2[1];if(key===node)return _path}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}var path=this.getKeysToPathsTable()[key];return path?(0,immutable.List)(path):null}},{key:"getText",value:function getText(){return"text"===this.object?this.text:this.nodes.reduce((function(memo,c){return memo+c.text}),"")}},{key:"hasNode",value:function hasNode(path){return!!this.getNode(path)}},{key:"normalize",value:function normalize(editor){return editor.run("normalizeNode",this)}},{key:"regenerateKey",value:function regenerateKey(){var key=KeyUtils.create();return this.set("key",key)}},{key:"resolvePath",value:function resolvePath(path,index){return"string"==typeof path?(path=this.getPath(path),null!=index&&(path=path.concat(index))):path=PathUtils.create(path),path}},{key:"validate",value:function validate(editor){return editor.run("validateNode",this)}}]),NodeInterface}();memoize(NodeInterface.prototype,["getFirstText","getKeysToPathsTable","getLastText","getText","normalize","validate"]),mixin(NodeInterface,[Block,Document,Inline,Text]);var global$1=void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function identity(){return!0}var ElementInterface=function(){function ElementInterface(){classCallCheck(this,ElementInterface)}return createClass(ElementInterface,[{key:"addMark",value:function addMark(path,mark){path=this.resolvePath(path);var node=this.assertDescendant(path);return node=node.addMark(mark),this.replaceNode(path,node)}},{key:"ancestors",value:function ancestors(path){return this.createIterable({path,direction:null,downward:!1,includeTargetAncestors:!0,includeRoot:!0})}},{key:"blocks",value:function blocks(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},onlyLeaves=options.onlyLeaves,onlyRoots=options.onlyRoots,onlyTypes=options.onlyTypes,_match=options.match,rest=objectWithoutProperties(options,["onlyLeaves","onlyRoots","onlyTypes","match"]),iterable=this.descendants(_extends({includeDocument:!1,includeInlines:!1,includeTexts:!1},rest,{match:function match(node,path){return!(onlyTypes&&!onlyTypes.includes(node.type))&&((!onlyRoots||1===path.size)&&(!(onlyLeaves&&!node.isLeafBlock())&&!(_match&&!_match(node,path))))}}));return iterable}},{key:"createAnnotation",value:function createAnnotation(properties){return properties=Annotation.createProperties(properties),this.resolveAnnotation(properties)}},{key:"createDecoration",value:function createDecoration(properties){return properties=Decoration.createProperties(properties),this.resolveDecoration(properties)}},{key:"createIterable",value:function createIterable(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_options$direction=options.direction,direction=void 0===_options$direction?"forward":_options$direction,_options$downward=options.downward,downward=void 0===_options$downward||_options$downward,_options$upward=options.upward,upward=void 0===_options$upward||_options$upward,_options$includeBlock=options.includeBlocks,includeBlocks=void 0===_options$includeBlock||_options$includeBlock,_options$includeDocum=options.includeDocument,includeDocument=void 0===_options$includeDocum||_options$includeDocum,_options$includeInlin=options.includeInlines,includeInlines=void 0===_options$includeInlin||_options$includeInlin,_options$includeRoot=options.includeRoot,includeRoot=void 0!==_options$includeRoot&&_options$includeRoot,_options$includeTarge=options.includeTarget,includeTarget=void 0===_options$includeTarge?!!options.range:_options$includeTarge,_options$includeTarge2=options.includeTargetAncestors,includeTargetAncestors=void 0!==_options$includeTarge2&&_options$includeTarge2,_options$includeTexts=options.includeTexts,includeTexts=void 0===_options$includeTexts||_options$includeTexts,_options$match=options.match,match=void 0===_options$match?null:_options$match,root=this,targetPath=null,targetRange=null;options.range?(targetRange=root.resolveRange(options.range),targetPath=root.resolvePath(targetRange.start.path)):options.path&&(targetPath=root.resolvePath(options.path));var targetNode=targetPath&&root.assertNode(targetPath),NativeSet="undefined"==typeof window?global$1.Set:window.Set;return defineProperty({},Symbol.iterator,(function(){var visited=new NativeSet,startPath=targetRange&&targetRange.start.path,endPath=targetRange&&targetRange.end.path,path=targetPath,node=targetNode,includedTarget=!1,includedStart=!1,includingStart=!1,result=function result(){return path&&node?(includeRoot||node!==root)&&(includeBlocks||"block"!==node.object)&&(includeDocument||"document"!==node.object)&&(includeInlines||"inline"!==node.object)&&(includeTexts||"text"!==node.object)?match&&!match(node,path)?next():{value:[node,path],done:!1}:next():{done:!0}},next=function next(){if(!path||!node)return result();if(startPath&&!includedStart)return includingStart?path.size===startPath.size-1?(includedStart=!0,path=targetPath,node=targetNode,next()):(path=startPath.slice(0,path.size+1),node=root.assertNode(path),result()):(includingStart=!0,path=PathUtils.create([]),node=root,result());if(includeTarget&&!includedTarget)return includedTarget=!0,result();if(endPath&&path.equals(endPath))return node=null,path=null,next();if(downward&&node.nodes&&node.nodes.size&&!visited.has(node)){visited.add(node);var nextIndex="forward"===direction?0:node.nodes.size-1;return path=path.push(nextIndex),node=root.assertNode(path),result()}if("forward"===direction){var newPath=PathUtils.increment(path),newNode=root.getNode(newPath);if(newNode)return path=newPath,node=newNode,result()}if("backward"===direction&&0!==path.last()){var _newPath=PathUtils.decrement(path),_newNode=root.getNode(_newPath);if(_newNode)return path=_newPath,node=_newNode,result()}return upward&&path.size?(path=PathUtils.lift(path),node=root.assertNode(path),visited.has(node)?next():(visited.add(node),includeTargetAncestors?result():next())):(path=null,node=null,next())};return{next}}))}},{key:"createPoint",value:function createPoint(properties){return properties=Point.createProperties(properties),this.resolvePoint(properties)}},{key:"createRange",value:function createRange(properties){return properties=Range.createProperties(properties),this.resolveRange(properties)}},{key:"createSelection",value:function createSelection(properties){return properties=Selection.createProperties(properties),this.resolveSelection(properties)}},{key:"descendants",value:function descendants(options){return this.createIterable(_extends({path:[]},options))}},{key:"filterDescendants",value:function filterDescendants(){var predicate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:identity,matches=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=this.descendants()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ref2=_step.value,_ref3=slicedToArray(_ref2,2),node=_ref3[0],path=_ref3[1];predicate(node,path)&&matches.push(node)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return(0,immutable.List)(matches)}},{key:"findDescendant",value:function findDescendant(){var predicate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:identity,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=this.descendants()[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _ref4=_step2.value,_ref5=slicedToArray(_ref4,2),node=_ref5[0],path=_ref5[1];if(predicate(node,path))return node}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}return null}},{key:"forEachDescendant",value:function forEachDescendant(){var predicate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:identity,_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=this.descendants()[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var _next=_step3.value,ret=predicate.apply(void 0,toConsumableArray(_next));if(!1===ret)return}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}},{key:"getActiveMarksAtRange",value:function getActiveMarksAtRange(range){if((range=this.resolveRange(range)).isUnset)return(0,immutable.Set)();if(range.isCollapsed){var _start=range.start;return this.getInsertMarksAtPoint(_start)}var _range2=range,start=_range2.start,end=_range2.end,startPath=start.path,startOffset=start.offset,endPath=end.path,endOffset=end.offset,startText=this.getDescendant(startPath),endText=this.getDescendant(endPath);if(!startPath.equals(endPath)){for(;!startPath.equals(endPath)&&0===endOffset;){var _texts=this.texts({path:endPath,direction:"backward"}),_texts2=slicedToArray(_texts,1),_texts2$=slicedToArray(_texts2[0],2);endText=_texts2$[0],endPath=_texts2$[1],endOffset=endText.text.length}for(;!startPath.equals(endPath)&&startOffset===startText.text.length;){var _texts3=this.texts({path:startPath}),_texts4=slicedToArray(_texts3,1),_texts4$=slicedToArray(_texts4[0],2);startText=_texts4$[0],startPath=_texts4$[1],startOffset=0}}if(startPath.equals(endPath))return startText.marks;var startMarks=startText.marks;if(0===startMarks.size)return(0,immutable.Set)();var endMarks=endText.marks,marks=startMarks.intersect(endMarks);if(0===marks.size)return marks;var _texts5=this.texts({path:startPath}),_texts6=slicedToArray(_texts5,1),_texts6$=slicedToArray(_texts6[0],2);for(startText=_texts6$[0],startPath=_texts6$[1];!startPath.equals(endPath);){if(0!==startText.text.length&&0===(marks=marks.intersect(startText.marks)).size)return(0,immutable.Set)();var _texts7=this.texts({path:startPath}),_texts8=slicedToArray(_texts7,1),_texts8$=slicedToArray(_texts8[0],2);startText=_texts8$[0],startPath=_texts8$[1]}return marks}},{key:"getAncestors",value:function getAncestors(path){var iterable=this.ancestors(path),array=Array.from(iterable,(function(_ref6){return slicedToArray(_ref6,1)[0]})).reverse();return(0,immutable.List)(array)}},{key:"getBlocks",value:function getBlocks(){var iterable=this.blocks({onlyLeaves:!0}),array=Array.from(iterable,(function(_ref8){return slicedToArray(_ref8,1)[0]}));return(0,immutable.List)(array)}},{key:"getBlocksByType",value:function getBlocksByType(type){var iterable=this.blocks({onlyLeaves:!0,onlyTypes:[type]}),array=Array.from(iterable,(function(_ref10){return slicedToArray(_ref10,1)[0]}));return(0,immutable.List)(array)}},{key:"getChild",value:function getChild(path){return!(path=this.resolvePath(path))||path.size>1?null:this.nodes.get(path.first())}},{key:"getClosest",value:function getClosest(path,predicate){var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=this.ancestors(path)[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var _ref12=_step4.value,_ref13=slicedToArray(_ref12,2),n=_ref13[0];if(predicate(n,_ref13[1]))return n}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}return null}},{key:"getClosestBlock",value:function getClosestBlock(path){var closest=this.getClosest(path,(function(n){return"block"===n.object}));return closest}},{key:"getClosestInline",value:function getClosestInline(path){var closest=this.getClosest(path,(function(n){return"inline"===n.object}));return closest}},{key:"getClosestVoid",value:function getClosestVoid(path,editor){tiny_invariant_esm(!Value.isValue(editor),"As of Slate 0.42.0, the `node.getClosestVoid` method takes an `editor` instead of a `value`.");var closest=this.getClosest(path,(function(n){return editor.isVoid(n)}));return closest}},{key:"getCommonAncestor",value:function getCommonAncestor(a,b){if(a=this.resolvePath(a),b=this.resolvePath(b),!a||!b)return null;var path=PathUtils.relate(a,b);return this.getNode(path)}},{key:"getDecorations",value:function getDecorations(editor){var decorations=editor.run("decorateNode",this);return decorations=Decoration.createList(decorations)}},{key:"getDepth",value:function getDepth(path){var startAt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!(path=this.resolvePath(path)))return null;var node=this.getNode(path),depth=node?path.size-1+startAt:null;return depth}},{key:"getDescendant",value:function getDescendant(path){if(!(path=this.resolvePath(path))||!path.size)return null;var node=this;return path.forEach((function(index){return!!(node=node.getIn(["nodes",index]))})),node}},{key:"getDescendantsAtRange",value:function getDescendantsAtRange(range){var iterable=this.descendants({range}),array=Array.from(iterable,(function(_ref14){return slicedToArray(_ref14,1)[0]}));return(0,immutable.List)(array)}},{key:"getFragmentAtRange",value:function getFragmentAtRange(range){if((range=this.resolveRange(range)).isUnset)return Document.create();for(var _range3=range,start=_range3.start,end=_range3.end,node=this,targetPath=end.path,targetPosition=end.offset,side="end";targetPath.size;){var index=targetPath.last();node=node.splitNode(targetPath,targetPosition),targetPosition=index+1,(targetPath=PathUtils.lift(targetPath)).size||"end"!==side||(targetPath=start.path,targetPosition=start.offset,side="start")}var startIndex=start.path.first()+1,endIndex=end.path.first()+2,nodes=node.nodes.slice(startIndex,endIndex);return Document.create({nodes})}},{key:"getFurthest",value:function getFurthest(path){var predicate=arguments.length>1&&void 0!==arguments[1]?arguments[1]:identity,iterable=this.ancestors(path),results=Array.from(iterable).reverse(),_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _step5,_iterator5=results[Symbol.iterator]();!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){var _ref16=_step5.value,_ref17=slicedToArray(_ref16,2),n=_ref17[0],p=_ref17[1];if(predicate(n,p))return n}}catch(err){_didIteratorError5=!0,_iteratorError5=err}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}return null}},{key:"getFurthestBlock",value:function getFurthestBlock(path){var furthest=this.getFurthest(path,(function(n){return"block"===n.object}));return furthest}},{key:"getFurthestChild",value:function getFurthestChild(path){return(path=this.resolvePath(path))&&path.size?this.nodes.get(path.first()):null}},{key:"getFurthestInline",value:function getFurthestInline(path){var furthest=this.getFurthest(path,(function(n){return"inline"===n.object}));return furthest}},{key:"getInlines",value:function getInlines(){var iterable=this.inlines({onlyLeaves:!0}),array=Array.from(iterable,(function(_ref18){return slicedToArray(_ref18,1)[0]}));return(0,immutable.List)(array)}},{key:"getInlinesByType",value:function getInlinesByType(type){var iterable=this.inlines({onlyLeaves:!0,onlyTypes:[type]}),array=Array.from(iterable,(function(_ref20){return slicedToArray(_ref20,1)[0]}));return(0,immutable.List)(array)}},{key:"getInsertMarksAtPoint",value:function getInsertMarksAtPoint(point){var _point=point=this.resolvePoint(point),path=_point.path,offset=_point.offset,text=this.getDescendant(path);if(0!==offset)return text.marks;var blockNode=void 0,blockPath=void 0,_iteratorNormalCompletion6=!0,_didIteratorError6=!1,_iteratorError6=void 0;try{for(var _step6,_iterator6=this.ancestors(path)[Symbol.iterator]();!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=!0){var entry=_step6.value,_entry=slicedToArray(entry,2),n=_entry[0],p=_entry[1];"block"===n.object&&(blockNode=n,blockPath=p)}}catch(err){_didIteratorError6=!0,_iteratorError6=err}finally{try{!_iteratorNormalCompletion6&&_iterator6.return&&_iterator6.return()}finally{if(_didIteratorError6)throw _iteratorError6}}var relativePath=PathUtils.drop(path,blockPath.size),_blockNode$texts=blockNode.texts({path:relativePath,direction:"backward"}),previous=slicedToArray(_blockNode$texts,1)[0];return previous?slicedToArray(previous,1)[0].marks:text.marks}},{key:"getInsertMarksAtRange",value:function getInsertMarksAtRange(range){var start=(range=this.resolveRange(range)).start;return range.isUnset?(0,immutable.Set)():range.isCollapsed?this.getInsertMarksAtPoint(start):this.getDescendant(start.path).marks}},{key:"getLeafBlocksAtRange",value:function getLeafBlocksAtRange(range){var iterable=this.blocks({range,onlyLeaves:!0}),array=Array.from(iterable,(function(_ref22){return slicedToArray(_ref22,1)[0]}));return(0,immutable.List)(array)}},{key:"getLeafInlinesAtRange",value:function getLeafInlinesAtRange(range){var iterable=this.inlines({range,onlyLeaves:!0}),array=Array.from(iterable,(function(_ref24){return slicedToArray(_ref24,1)[0]}));return(0,immutable.List)(array)}},{key:"getNodesToPathsMap",value:function getNodesToPathsMap(){var map="undefined"==typeof window?new global$1.Map:new window.Map;return map.set(this,PathUtils.create([])),this.forEachDescendant((function(node,path){map.set(node,path)})),map}},{key:"getMarks",value:function getMarks(){var iterable=this.marks(),array=Array.from(iterable,(function(_ref26){return slicedToArray(_ref26,1)[0]}));return(0,immutable.OrderedSet)(array)}},{key:"getMarksAtRange",value:function getMarksAtRange(range){var iterable=this.marks({range}),array=Array.from(iterable,(function(_ref28){return slicedToArray(_ref28,1)[0]}));return(0,immutable.OrderedSet)(array)}},{key:"getMarksByType",value:function getMarksByType(type){var iterable=this.marks({onlyTypes:[type]}),array=Array.from(iterable,(function(_ref30){return slicedToArray(_ref30,1)[0]}));return(0,immutable.OrderedSet)(array)}},{key:"getNextBlock",value:function getNextBlock(path){var _blocks=this.blocks({path,onlyLeaves:!0}),entry=slicedToArray(_blocks,1)[0];return entry?entry[0]:null}},{key:"getNextNode",value:function getNextNode(path){var iterable=this.createIterable({path,downward:!1}),entry=slicedToArray(iterable,1)[0];return entry?entry[0]:null}},{key:"getNextSibling",value:function getNextSibling(path){var _siblings=this.siblings(path),entry=slicedToArray(_siblings,1)[0];return entry?entry[0]:null}},{key:"getNextText",value:function getNextText(path){var _texts9=this.texts({path}),entry=slicedToArray(_texts9,1)[0];return entry?entry[0]:null}},{key:"getOffset",value:function getOffset(path){path=this.resolvePath(path),this.assertDescendant(path);var index=path.first(),offset=this.nodes.slice(0,index).reduce((function(memo,n){return memo+n.text.length}),0);return 1===path.size?offset:offset+this.nodes.get(index).getOffset(PathUtils.drop(path))}},{key:"getOffsetAtRange",value:function getOffsetAtRange(range){if((range=this.resolveRange(range)).isUnset)throw new Error("The range cannot be unset to calculcate its offset.");if(range.isExpanded)throw new Error("The range must be collapsed to calculcate its offset.");var start=range.start;return this.getOffset(start.path)+start.offset}},{key:"getParent",value:function getParent(path){if(!(path=this.resolvePath(path)))return null;if(!path.size)return null;var parentPath=PathUtils.lift(path);return this.getNode(parentPath)}},{key:"getPreviousBlock",value:function getPreviousBlock(path){var _blocks3=this.blocks({path,onlyLeaves:!0,direction:"backward"}),entry=slicedToArray(_blocks3,1)[0];return entry?entry[0]:null}},{key:"getPreviousNode",value:function getPreviousNode(path){var iterable=this.createIterable({path,downward:!1,direction:"backward"}),entry=slicedToArray(iterable,1)[0];return entry?entry[0]:null}},{key:"getPreviousSibling",value:function getPreviousSibling(path){var _siblings3=this.siblings(path,{direction:"backward"}),entry=slicedToArray(_siblings3,1)[0];return entry?entry[0]:null}},{key:"getPreviousText",value:function getPreviousText(path){var _texts11=this.texts({path,direction:"backward"}),entry=slicedToArray(_texts11,1)[0];return entry?entry[0]:null}},{key:"getRootBlocksAtRange",value:function getRootBlocksAtRange(range){var iterable=this.blocks({range,onlyRoots:!0}),array=Array.from(iterable,(function(_ref32){return slicedToArray(_ref32,1)[0]}));return(0,immutable.List)(array)}},{key:"getRootInlinesAtRange",value:function getRootInlinesAtRange(range){var iterable=this.inlines({range,onlyRoots:!0}),array=Array.from(iterable,(function(_ref34){return slicedToArray(_ref34,1)[0]}));return(0,immutable.List)(array)}},{key:"getTextAtOffset",value:function getTextAtOffset(offset){if(0===offset)return this.getFirstText();if(offset===this.text.length)return this.getLastText();if(offset<0||offset>this.text.length)return null;var length=0,_iteratorNormalCompletion7=!0,_didIteratorError7=!1,_iteratorError7=void 0;try{for(var _step7,_iterator7=this.texts()[Symbol.iterator]();!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=!0){var _ref36=_step7.value,node=slicedToArray(_ref36,1)[0];if((length+=node.text.length)>offset)return node}}catch(err){_didIteratorError7=!0,_iteratorError7=err}finally{try{!_iteratorNormalCompletion7&&_iterator7.return&&_iterator7.return()}finally{if(_didIteratorError7)throw _iteratorError7}}return null}},{key:"getTextDirection",value:function getTextDirection(){var dir=direction_default()(this.text);return"neutral"===dir?null:dir}},{key:"getTexts",value:function getTexts(){var iterable=this.texts(),array=Array.from(iterable,(function(_ref38){return slicedToArray(_ref38,1)[0]}));return(0,immutable.List)(array)}},{key:"getTextsAtRange",value:function getTextsAtRange(range){var iterable=this.texts({range}),array=Array.from(iterable,(function(_ref40){return slicedToArray(_ref40,1)[0]}));return(0,immutable.List)(array)}},{key:"hasBlockChildren",value:function hasBlockChildren(){return!(!this.nodes||!this.nodes.find((function(n){return"block"===n.object})))}},{key:"hasChild",value:function hasChild(path){return!!this.getChild(path)}},{key:"hasInlineChildren",value:function hasInlineChildren(){return!(!this.nodes||!this.nodes.find((function(n){return"inline"===n.object||"text"===n.object})))}},{key:"hasDescendant",value:function hasDescendant(path){return!!this.getDescendant(path)}},{key:"hasVoidParent",value:function hasVoidParent(path,editor){return tiny_invariant_esm(!Value.isValue(editor),"As of Slate 0.42.0, the `node.hasVoidParent` method takes an `editor` instead of a `value`."),!!this.getClosestVoid(path,editor)}},{key:"inlines",value:function inlines(){var _this=this,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},onlyLeaves=options.onlyLeaves,onlyRoots=options.onlyRoots,onlyTypes=options.onlyTypes,_match2=options.match,rest=objectWithoutProperties(options,["onlyLeaves","onlyRoots","onlyTypes","match"]),iterable=this.descendants(_extends({includeBlocks:!1,includeTexts:!1,includeDocument:!1},rest,{match:function match(node,path){return!(onlyTypes&&!onlyTypes.includes(node.type))&&(!(onlyLeaves&&!node.isLeafInline())&&((!onlyRoots||"block"===_this.getParent(path).object)&&!(_match2&&!_match2(node,path))))}}));return iterable}},{key:"insertNode",value:function insertNode(path,node){var index=(path=this.resolvePath(path)).last(),parentPath=PathUtils.lift(path),parent=this.assertNode(parentPath),nodes=parent.nodes.splice(index,0,node);return parent=parent.set("nodes",nodes),this.replaceNode(parentPath,parent)}},{key:"insertText",value:function insertText(path,offset,text){path=this.resolvePath(path);var node=this.assertDescendant(path);return node=node.insertText(offset,text),this.replaceNode(path,node)}},{key:"isLeafBlock",value:function isLeafBlock(){return"block"===this.object&&!this.nodes.some((function(n){return"block"===n.object}))}},{key:"isLeafInline",value:function isLeafInline(){return"inline"===this.object&&!this.nodes.some((function(n){return"inline"===n.object}))}},{key:"isInRange",value:function isInRange(path,range){if(path=this.resolvePath(path),(range=this.resolveRange(range)).isUnset)return!1;var toStart=PathUtils.compare(path,range.start.path),toEnd=PathUtils.compare(path,range.end.path),isInRange=-1!==toStart&&1!==toEnd;return isInRange}},{key:"mapChildren",value:function mapChildren(){var _this2=this,predicate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:identity,nodes=this.nodes;nodes.forEach((function(node,i){var ret=predicate(node,i,_this2.nodes);ret!==node&&(nodes=nodes.set(ret.key,ret))}));var ret=this.set("nodes",nodes);return ret}},{key:"mapDescendants",value:function mapDescendants(){var _this3=this,predicate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:identity,nodes=this.nodes;nodes.forEach((function(node,index){var ret=node;"text"!==ret.object&&(ret=ret.mapDescendants(predicate)),(ret=predicate(ret,index,_this3.nodes))!==node&&(nodes=nodes.set(index,ret))}));var ret=this.set("nodes",nodes);return ret}},{key:"marks",value:function marks(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_options$onlyTypes=options.onlyTypes,onlyTypes=void 0===_options$onlyTypes?null:_options$onlyTypes,match=options.match,rest=objectWithoutProperties(options,["onlyTypes","match"]),texts=this.texts(rest);return defineProperty({},Symbol.iterator,(function(){var iterator=texts[Symbol.iterator](),node=null,path=null,remaining=[];return{next:function next(){if(remaining.length){var mark=remaining.shift();return onlyTypes&&!onlyTypes.includes(mark.type)||match&&!match(mark,node,path)?next():{value:[mark,node,path],done:!1}}var _iterator$next=iterator.next(),value=_iterator$next.value;if(_iterator$next.done)return{done:!0};var _value=slicedToArray(value,2);return node=_value[0],path=_value[1],remaining=node.marks.toArray(),next()}}}))}},{key:"mergeNode",value:function mergeNode(path){var b=this.assertNode(path);if(0===(path=this.resolvePath(path)).last())throw new Error("Unable to merge node because it has no previous sibling: "+b);var withPath=PathUtils.decrement(path),a=this.assertNode(withPath);if(a.object!==b.object)throw new Error("Unable to merge two different kinds of nodes: "+a+" and "+b);var newNode="text"===a.object?a.mergeText(b):a.set("nodes",a.nodes.concat(b.nodes)),ret=this;return ret=(ret=(ret=ret.removeNode(path)).removeNode(withPath)).insertNode(withPath,newNode)}},{key:"moveNode",value:function moveNode(path,newPath){var newIndex=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,node=this.assertNode(path);path=this.resolvePath(path),newPath=this.resolvePath(newPath,newIndex);var newParentPath=PathUtils.lift(newPath);this.assertNode(newParentPath);var op=Operation.create({type:"move_node",path,newPath});newPath=PathUtils.transform(path,op).first();var ret=this;return ret=(ret=ret.removeNode(path)).insertNode(newPath,node)}},{key:"removeMark",value:function removeMark(path,mark){path=this.resolvePath(path);var node=this.assertDescendant(path);return node=node.removeMark(mark),this.replaceNode(path,node)}},{key:"removeNode",value:function removeNode(path){this.assertDescendant(path);var deep=(path=this.resolvePath(path)).flatMap((function(x){return["nodes",x]}));return this.deleteIn(deep)}},{key:"removeText",value:function removeText(path,offset,text){var node=this.assertDescendant(path);return node=node.removeText(offset,text.length),this.replaceNode(path,node)}},{key:"replaceNode",value:function replaceNode(path,node){if(!(path=this.resolvePath(path)))throw new Error("Unable to replace a node because it could not be found in the first place: "+path);if(!path.size)return node;this.assertNode(path);var deep=path.flatMap((function(x){return["nodes",x]}));return this.setIn(deep,node)}},{key:"resolveAnnotation",value:function resolveAnnotation(annotation){return annotation=(annotation=Annotation.create(annotation)).normalize(this)}},{key:"resolveDecoration",value:function resolveDecoration(decoration){return decoration=(decoration=Decoration.create(decoration)).normalize(this)}},{key:"resolvePoint",value:function resolvePoint(point){return point=(point=Point.create(point)).normalize(this)}},{key:"resolveRange",value:function resolveRange(range){return range=(range=Range.create(range)).normalize(this)}},{key:"resolveSelection",value:function resolveSelection(selection){return selection=(selection=Selection.create(selection)).normalize(this)}},{key:"setNode",value:function setNode(path,properties){var node=this.assertNode(path);return node=node.merge(properties),this.replaceNode(path,node)}},{key:"setMark",value:function setMark(path,properties,newProperties){path=this.resolvePath(path);var node=this.assertDescendant(path);return node=node.setMark(properties,newProperties),this.replaceNode(path,node)}},{key:"siblings",value:function siblings(path,options){return this.createIterable(_extends({path,upward:!1,downward:!1},options))}},{key:"splitNode",value:function splitNode(path,position,properties){var child=this.assertNode(path);path=this.resolvePath(path);var a=void 0,b=void 0;if("text"===child.object){var _child$splitText=child.splitText(position),_child$splitText2=slicedToArray(_child$splitText,2);a=_child$splitText2[0],b=_child$splitText2[1]}else{var befores=child.nodes.take(position),afters=child.nodes.skip(position);a=child.set("nodes",befores),b=child.set("nodes",afters).regenerateKey()}properties&&"text"!==child.object&&(b=b.merge(properties));var ret=this;return ret=(ret=(ret=ret.removeNode(path)).insertNode(path,b)).insertNode(path,a)}},{key:"texts",value:function texts(options){return this.descendants(_extends({includeBlocks:!1,includeInlines:!1,includeDocument:!1},options))}},{key:"getBlocksAtRange",value:function getBlocksAtRange(range){return tiny_warning_esm(!1,"As of slate@0.44 the `node.getBlocksAtRange` method has been renamed to `getLeafBlocksAtRange`."),this.getLeafBlocksAtRange(range)}},{key:"getBlocksAtRangeAsArray",value:function getBlocksAtRangeAsArray(range){return tiny_warning_esm(!1,"As of slate@0.44 the `node.getBlocksAtRangeAsArray` method has been renamed to `getLeafBlocksAtRangeAsArray`."),this.getLeafBlocksAtRangeAsArray(range)}},{key:"getInlinesAtRange",value:function getInlinesAtRange(range){return tiny_warning_esm(!1,"As of slate@0.44 the `node.getInlinesAtRange` method has been renamed to `getLeafInlinesAtRange`."),this.getLeafInlinesAtRange(range)}},{key:"getInlinesAtRangeAsArray",value:function getInlinesAtRangeAsArray(range){return tiny_warning_esm(!1,"As of slate@0.44 the `node.getInlinesAtRangeAsArray` method has been renamed to `getLeafInlinesAtRangeAsArray`."),this.getLeafInlinesAtRangeAsArray(range)}},{key:"getNextTextAndPath",value:function getNextTextAndPath(path){return tiny_warning_esm(!1,"As of slate@0.47, the `getNextTextAndPath` method has been renamed to `getNextTextEntry`."),this.getNextTextEntry(path)}},{key:"getNextDeepMatchingNodeAndPath",value:function getNextDeepMatchingNodeAndPath(path){var iterator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};tiny_warning_esm(!1,"As of slate@0.47, the `getNextDeepMatchingNodeAndPath` method is deprecated.");var match=this.getNextMatchingNodeAndPath(path);if(!match)return null;for(var _match3=slicedToArray(match,2),nextNode=_match3[0],nextPath=_match3[1],childMatch=void 0,assign=function assign(){return childMatch="text"!==nextNode.object&&nextNode.findFirstDescendantAndPath(iterator,nextPath)};assign(childMatch);){var _childMatch=childMatch,_childMatch2=slicedToArray(_childMatch,2);nextNode=_childMatch2[0],nextPath=_childMatch2[1]}return nextNode?iterator(nextNode)?[nextNode,nextPath]:this.getNextDeepMatchingNodeAndPath(match[1],iterator):null}},{key:"getPreviousTextAndPath",value:function getPreviousTextAndPath(path){return tiny_warning_esm(!1,"As of slate@0.47, the `getPreviousTextAndPath` method has been renamed to `getPreviousTextEntry`."),this.getPreviousTextEntry(path)}},{key:"findFirstDescendantAndPath",value:function findFirstDescendantAndPath(iterator,pathToThisNode){return tiny_warning_esm(!1,"As of slate@0.47, the `findFirstDescendantAndPath` method is deprecated."),this.findDescendantAndPath(iterator,pathToThisNode,!1)}},{key:"getPreviousMatchingNodeAndPath",value:function getPreviousMatchingNodeAndPath(path){var iterator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(tiny_warning_esm(!1,"As of slate@0.47, the `getPreviousMatchingNodeAndPath` method is deprecated."),!path)return null;for(var i=path.size;i>0;i--){var p=path.slice(0,i);if(0!==p.last()){for(var previousPath=PathUtils.decrement(p),previousNode=this.getNode(previousPath);previousNode&&!iterator(previousNode);)previousPath=PathUtils.decrement(previousPath),previousNode=this.getNode(previousPath);if(previousNode)return[previousNode,previousPath]}}return null}},{key:"getPreviousDeepMatchingNodeAndPath",value:function getPreviousDeepMatchingNodeAndPath(path){var iterator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};tiny_warning_esm(!1,"As of slate@0.47, the `getPreviousDeepMatchingNodeAndPath` method is deprecated.");var match=this.getPreviousMatchingNodeAndPath(path);if(!match)return null;for(var _match4=slicedToArray(match,2),previousNode=_match4[0],previousPath=_match4[1],childMatch=void 0,assign=function assign(){return childMatch="text"!==previousNode.object&&previousNode.findLastDescendantAndPath(iterator,previousPath)};assign(childMatch);){var _childMatch3=childMatch,_childMatch4=slicedToArray(_childMatch3,2);previousNode=_childMatch4[0],previousPath=_childMatch4[1]}return previousNode?iterator(previousNode)?[previousNode,previousPath]:this.getPreviousDeepMatchingNodeAndPath(match[1],iterator):null}},{key:"findLastDescendantAndPath",value:function findLastDescendantAndPath(iterator,pathToThisNode){return tiny_warning_esm(!1,"As of slate@0.47, the `findLastDescendantAndPath` method is deprecated."),this.findDescendantAndPath(iterator,pathToThisNode,!0)}},{key:"findDescendantAndPath",value:function findDescendantAndPath(iterator){var pathToThisNode=arguments.length>1&&void 0!==arguments[1]?arguments[1]:PathUtils.create([]),findLast=arguments.length>2&&void 0!==arguments[2]&&arguments[2];tiny_warning_esm(!1,"As of slate@0.47, the `findDescendantAndPath` method is deprecated.");var found=void 0,foundPath=void 0;return this.forEachDescendantWithPath((function(node,path,nodes){if(iterator(node,path,nodes))return found=node,foundPath=path,!1}),pathToThisNode,findLast),found?[found,foundPath]:null}},{key:"forEachDescendantWithPath",value:function forEachDescendantWithPath(iterator){var path=arguments.length>1&&void 0!==arguments[1]?arguments[1]:PathUtils.create([]),findLast=arguments[2];tiny_warning_esm(!1,"As of slate@0.47, the `forEachDescendantWithPath` method is deprecated.");var nodes=this.nodes,ret=void 0;return findLast&&(nodes=nodes.reverse()),nodes.forEach((function(child,i){var childPath=path.concat(i);return!1===iterator(child,childPath,nodes)?(ret=!1,!1):"text"!==child.object?ret=child.forEachDescendantWithPath(iterator,childPath,findLast):void 0})),ret}},{key:"getNextMatchingNodeAndPath",value:function getNextMatchingNodeAndPath(path){var iterator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(tiny_warning_esm(!1,"As of slate@0.47, the `getNextMatchingNodeAndPath` method is deprecated."),!path)return null;for(var i=path.size;i>0;i--){for(var p=path.slice(0,i),nextPath=PathUtils.increment(p),nextNode=this.getNode(nextPath);nextNode&&!iterator(nextNode);)nextPath=PathUtils.increment(nextPath),nextNode=this.getNode(nextPath);if(nextNode)return[nextNode,nextPath]}return null}},{key:"getSelectionIndexes",value:function getSelectionIndexes(range){var isSelected=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];tiny_warning_esm(!1,"As of slate@0.47, the `getSelectionIndexes` method is deprecated.");var start=range.start,end=range.end;if(!isSelected)return null;if(range.isUnset)return null;if(start.path.equals(end.path)){var child=this.getFurthestAncestor(start.path),index=child?this.nodes.indexOf(child):null;return{start:index,end:index+1}}var startIndex=null,endIndex=null;return this.nodes.forEach((function(child,i){return"text"===child.object?(null==startIndex&&child.key===start.key&&(startIndex=i),null==endIndex&&child.key===end.key&&(endIndex=i+1)):(null==startIndex&&child.hasDescendant(start.key)&&(startIndex=i),null==endIndex&&child.hasDescendant(end.key)&&(endIndex=i+1)),null==startIndex||null==endIndex})),isSelected&&null==startIndex&&(startIndex=0),isSelected&&null==endIndex&&(endIndex=this.nodes.size),null==startIndex?null:{start:startIndex,end:endIndex}}},{key:"getTextsBetweenPositionsAsArray",value:function getTextsBetweenPositionsAsArray(startPath,endPath){return tiny_warning_esm(!1,"As of slate@0.47, the `getTextsBetweenPositionsAsArray` method is deprecated."),startPath=this.resolvePath(startPath),endPath=this.resolvePath(endPath),this.getTextsBetweenPathPositionsAsArray(startPath,endPath)}},{key:"getOrderedMarksBetweenPositions",value:function getOrderedMarksBetweenPositions(startPath,startOffset,endPath,endOffset){tiny_warning_esm(!1,"As of slate@0.47, the `getOrderedMarksBetweenPositions` method is deprecated."),startPath=this.resolvePath(startPath),endPath=this.resolvePath(endPath);var startText=this.getDescendant(startPath);if(PathUtils.isEqual(startPath,endPath))return startText.marks;var texts=this.getTextsBetweenPathPositionsAsArray(startPath,endPath);return(0,immutable.OrderedSet)().withMutations((function(result){texts.forEach((function(text){result.union(text.marks)}))}))}},{key:"getTextsBetweenPathPositionsAsArray",value:function getTextsBetweenPathPositionsAsArray(startPath,endPath){if(tiny_warning_esm(!1,"As of slate@0.47, the `getTextsBetweenPathPositionsAsArray` method is deprecated."),startPath&&endPath&&PathUtils.isEqual(startPath,endPath))return[this.getDescendant(startPath)];if(!startPath&&!endPath)return this.getTextsAsArray();var startIndex=startPath?startPath.get(0,0):0,endIndex=endPath?endPath.get(0,this.nodes.size-1):this.nodes.size-1,array=[];return this.nodes.slice(startIndex,endIndex+1).forEach((function(node,i){if("text"===node.object)array.push(node);else{var childStartPath=startPath&&0===i?PathUtils.drop(startPath):null,childEndPath=endPath&&i===endIndex-startIndex?PathUtils.drop(endPath):null;array=array.concat(node.getTextsBetweenPathPositionsAsArray(childStartPath,childEndPath))}})),array}},{key:"getFurthestAncestor",value:function getFurthestAncestor(path){return tiny_warning_esm(!1,"As of slate@0.47, the `getFurthestAncestor` method has been renamed to `getFurthestChild`."),this.getFurthestChild(path)}},{key:"getLeafBlocksAtRangeAsArray",value:function getLeafBlocksAtRangeAsArray(range){if(tiny_warning_esm(!1,"As of slate@0.47, the `getLeafBlocksAtRangeAsArray` method is deprecated."),(range=this.resolveRange(range)).isUnset)return[];var _range6=range,start=_range6.start,end=_range6.end;return this.getLeafBlocksBetweenPathPositionsAsArray(start.path,end.path)}},{key:"getLeafBlocksBetweenPathPositionsAsArray",value:function getLeafBlocksBetweenPathPositionsAsArray(startPath,endPath){if(tiny_warning_esm(!1,"As of slate@0.47, the `getLeafBlocksBetweenPathPositionsAsArray` method is deprecated."),startPath&&endPath&&PathUtils.isEqual(startPath,endPath))return[this.getClosestBlock(startPath)];if(!startPath&&!endPath)return this.getBlocksAsArray();var startIndex=startPath?startPath.get(0,0):0,endIndex=endPath?endPath.get(0,this.nodes.size-1):this.nodes.size-1,array=[];return this.nodes.slice(startIndex,endIndex+1).forEach((function(node,i){if("block"===node.object)if(node.isLeafBlock())array.push(node);else{var childStartPath=startPath&&0===i?PathUtils.drop(startPath):null,childEndPath=endPath&&i===endIndex-startIndex?PathUtils.drop(endPath):null;array=array.concat(node.getLeafBlocksBetweenPathPositionsAsArray(childStartPath,childEndPath))}})),array}},{key:"getBlocksAsArray",value:function getBlocksAsArray(){tiny_warning_esm(!1,"As of slate@0.47, the `getBlocksAsArray` method is deprecated.");var iterable=this.blocks({onlyLeaves:!0});return Array.from(iterable,(function(_ref43){return slicedToArray(_ref43,1)[0]}))}},{key:"getBlocksByTypeAsArray",value:function getBlocksByTypeAsArray(type){tiny_warning_esm(!1,"As of slate@0.47, the `getBlocksByTypeAsArray` method is deprecated.");var iterable=this.blocks({onlyLeaves:!0,onlyTypes:[type]});return Array.from(iterable,(function(_ref45){return slicedToArray(_ref45,1)[0]}))}},{key:"getFurthestOnlyChildAncestor",value:function getFurthestOnlyChildAncestor(path){tiny_warning_esm(!1,"As of slate@0.47, the `getFurthestOnlyChildAncestor` method is deprecated.");var ancestors=this.getAncestors(path);return ancestors&&ancestors.rest().reverse().takeUntil((function(p){return p.nodes.size>1})).last()||null}},{key:"getInlinesAsArray",value:function getInlinesAsArray(){return tiny_warning_esm(!1,"As of slate@0.47, the `getInlinesAsArray` method is deprecated."),Array.from(this.inlines({onlyLeaves:!0}),(function(_ref47){return slicedToArray(_ref47,1)[0]}))}},{key:"getInlinesByTypeAsArray",value:function getInlinesByTypeAsArray(type){return tiny_warning_esm(!1,"As of slate@0.47, the `getInlinesByTypeAsArray` method is deprecated."),Array.from(this.inlines({onlyLeaves:!0,onlyTypes:[type]}),(function(_ref49){return slicedToArray(_ref49,1)[0]}))}},{key:"getLeafInlinesAtRangeAsArray",value:function getLeafInlinesAtRangeAsArray(range){var _this4=this;return tiny_warning_esm(!1,"As of slate@0.47, the `getLeafInlinesAtRangeAsArray` method is deprecated."),(range=this.resolveRange(range)).isUnset?[]:this.getTextsAtRangeAsArray(range).map((function(text){return _this4.getClosestInline(text.key)})).filter((function(exists){return exists}))}},{key:"getOrderedMarks",value:function getOrderedMarks(){return tiny_warning_esm(!1,"As of slate@0.47, the `getOrderedMarks` method has been folded into `getMarks`, which will now return an ordered set."),this.getMarks()}},{key:"getOrderedMarksAtRange",value:function getOrderedMarksAtRange(range){return tiny_warning_esm(!1,"As of slate@0.47, the `getOrderedMarksAtRange` method has been folded into `getMarksAtRange`, which will now return an ordered set."),this.getMarksAtRange(range)}},{key:"getOrderedMarksByType",value:function getOrderedMarksByType(type){return tiny_warning_esm(!1,"As of slate@0.47, the `getOrderedMarksByType` method has been folded into `getMarksByType`, which will now return an ordered set."),this.getMarksByType(type)}},{key:"getMarksByTypeAsArray",value:function getMarksByTypeAsArray(type){return tiny_warning_esm(!1,"As of slate@0.47, the `getMarksByTypeAsArray` method is deprecated."),this.nodes.reduce((function(memo,node){return"text"===node.object?memo.concat(node.marks.filter((function(m){return m.type===type}))):memo.concat(node.getMarksByTypeAsArray(type))}),[])}},{key:"getMarksAsArray",value:function getMarksAsArray(){var _ref53;tiny_warning_esm(!1,"As of slate@0.47, the `getMarksAsArray` method is deprecated.");var result=[],_iteratorNormalCompletion8=!0,_didIteratorError8=!1,_iteratorError8=void 0;try{for(var _step8,_iterator8=this.texts()[Symbol.iterator]();!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=!0){var _ref51=_step8.value,node=slicedToArray(_ref51,1)[0];result.push(node.marks.toArray())}}catch(err){_didIteratorError8=!0,_iteratorError8=err}finally{try{!_iteratorNormalCompletion8&&_iterator8.return&&_iterator8.return()}finally{if(_didIteratorError8)throw _iteratorError8}}return(_ref53=[]).concat.apply(_ref53,result)}},{key:"getRootInlinesAtRangeAsArray",value:function getRootInlinesAtRangeAsArray(range){var _this5=this;return tiny_warning_esm(!1,"As of slate@0.47, the `getRootInlinesAtRangeAsArray` method is deprecated."),(range=this.resolveRange(range)).isUnset?(0,immutable.List)():this.getTextsAtRangeAsArray(range).map((function(text){return _this5.getFurthestInline(text.key)})).filter((function(exists){return exists}))}},{key:"getTextsAsArray",value:function getTextsAsArray(){tiny_warning_esm(!1,"As of slate@0.47, the `getTextsAsArray` method is deprecated.");var iterable=this.texts();return Array.from(iterable,(function(_ref54){return slicedToArray(_ref54,1)[0]}))}},{key:"getTextsAtRangeAsArray",value:function getTextsAtRangeAsArray(range){tiny_warning_esm(!1,"As of slate@0.47, the `getTextsAtRangeAsArray` method is deprecated.");var iterable=this.texts({range});return Array.from(iterable,(function(_ref56){return slicedToArray(_ref56,1)[0]}))}},{key:"getMarksAtPosition",value:function getMarksAtPosition(path,offset){tiny_warning_esm(!1,"As of slate@0.47, the `getMarksAtPosition` method is deprecated."),path=this.resolvePath(path);var currentMarks=this.getDescendant(path).marks;if(0!==offset)return(0,immutable.OrderedSet)(currentMarks);var closestBlock=this.getClosestBlock(path);if(""===closestBlock.text)return(0,immutable.OrderedSet)(currentMarks);var _texts13=this.texts({path,direction:"backward"}),previous=slicedToArray(_texts13,1)[0];if(!previous)return(0,immutable.OrderedSet)();var _previous2=slicedToArray(previous,2),previousText=_previous2[0],previousPath=_previous2[1];return closestBlock.hasDescendant(previousPath)?(0,immutable.OrderedSet)(previousText.marks):(0,immutable.OrderedSet)(currentMarks)}},{key:"getNodesAtRange",value:function getNodesAtRange(range){tiny_warning_esm(!1,"As of slate@0.47, the `getNodesAtRange` method has been renamed to `getDescendantsAtRange`.");var iterable=this.descendants({range}),array=Array.from(iterable,(function(_ref58){return slicedToArray(_ref58,1)[0]}));return(0,immutable.List)(array)}},{key:"isNodeInRange",value:function isNodeInRange(path,range){return tiny_warning_esm(!1,"As of slate@0.47, the `isNodeInRange` method has been renamed to `isInRange`."),this.isInRange(path,range)}},{key:"text",get:function get$$1(){return this.getText()}}]),ElementInterface}(),_loop$1=function _loop(method){ElementInterface.prototype["assert"+method]=function(path){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var ret=this["get"+method].apply(this,[path].concat(args));if(null==ret)throw new Error("`Node.assert"+method+"` could not find node with path or key: "+path);return ret}},_iteratorNormalCompletion9=!0,_didIteratorError9=!1,_iteratorError9=void 0;try{for(var _step9,_iterator9=["Child","Depth","Descendant","Node","Parent","Path"][Symbol.iterator]();!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=!0){_loop$1(_step9.value)}}catch(err){_didIteratorError9=!0,_iteratorError9=err}finally{try{!_iteratorNormalCompletion9&&_iterator9.return&&_iterator9.return()}finally{if(_didIteratorError9)throw _iteratorError9}}memoize(ElementInterface.prototype,["getBlocksAsArray","getBlocksByTypeAsArray","getDecorations","getFragmentAtRange","getInlinesAsArray","getInlinesByTypeAsArray","getInsertMarksAtRange","getLeafBlocksAtRangeAsArray","getLeafBlocksAtRangeAsArray","getLeafInlinesAtRangeAsArray","getMarksAsArray","getMarksAtPosition","getMarksByTypeAsArray","getNextBlock","getNodesAtRange","getNodesToPathsMap","getOffset","getOffsetAtRange","getOrderedMarksBetweenPositions","getPreviousBlock","getRootBlocksAtRange","getRootInlinesAtRangeAsArray","getTextAtOffset","getTextDirection","getTextsAsArray","getTextsBetweenPathPositionsAsArray"]),mixin(ElementInterface,[Block,Document,Inline]);var RangeInterface=function(){function RangeInterface(){classCallCheck(this,RangeInterface)}return createClass(RangeInterface,[{key:"flip",value:function flip(){return this.setPoints([this.focus,this.anchor])}},{key:"moveForward",value:function moveForward(n){return this.updatePoints((function(point){return point.moveForward(n)}))}},{key:"moveBackward",value:function moveBackward(n){return this.updatePoints((function(point){return point.moveBackward(n)}))}},{key:"moveAnchorBackward",value:function moveAnchorBackward(n){return this.setAnchor(this.anchor.moveBackward(n))}},{key:"moveAnchorForward",value:function moveAnchorForward(n){return this.setAnchor(this.anchor.moveForward(n))}},{key:"moveAnchorTo",value:function moveAnchorTo(path,offset){return this.setAnchor(this.anchor.moveTo(path,offset))}},{key:"moveAnchorToStartOfNode",value:function moveAnchorToStartOfNode(node){return this.setAnchor(this.anchor.moveToStartOfNode(node))}},{key:"moveAnchorToEndOfNode",value:function moveAnchorToEndOfNode(node){return this.setAnchor(this.anchor.moveToEndOfNode(node))}},{key:"moveEndBackward",value:function moveEndBackward(n){return this.setEnd(this.end.moveBackward(n))}},{key:"moveEndForward",value:function moveEndForward(n){return this.setEnd(this.end.moveForward(n))}},{key:"moveEndTo",value:function moveEndTo(path,offset){return this.setEnd(this.end.moveTo(path,offset))}},{key:"moveEndToStartOfNode",value:function moveEndToStartOfNode(node){return this.setEnd(this.end.moveToStartOfNode(node))}},{key:"moveEndToEndOfNode",value:function moveEndToEndOfNode(node){return this.setEnd(this.end.moveToEndOfNode(node))}},{key:"moveFocusBackward",value:function moveFocusBackward(n){return this.setFocus(this.focus.moveBackward(n))}},{key:"moveFocusForward",value:function moveFocusForward(n){return this.setFocus(this.focus.moveForward(n))}},{key:"moveFocusTo",value:function moveFocusTo(path,offset){return this.setFocus(this.focus.moveTo(path,offset))}},{key:"moveFocusToStartOfNode",value:function moveFocusToStartOfNode(node){return this.setFocus(this.focus.moveToStartOfNode(node))}},{key:"moveFocusToEndOfNode",value:function moveFocusToEndOfNode(node){return this.setFocus(this.focus.moveToEndOfNode(node))}},{key:"moveStartBackward",value:function moveStartBackward(n){return this.setStart(this.start.moveBackward(n))}},{key:"moveStartForward",value:function moveStartForward(n){return this.setStart(this.start.moveForward(n))}},{key:"moveStartTo",value:function moveStartTo(path,offset){return this.setStart(this.start.moveTo(path,offset))}},{key:"moveStartToStartOfNode",value:function moveStartToStartOfNode(node){return this.setStart(this.start.moveToStartOfNode(node))}},{key:"moveStartToEndOfNode",value:function moveStartToEndOfNode(node){return this.setStart(this.start.moveToEndOfNode(node))}},{key:"moveTo",value:function moveTo(path,offset){return this.updatePoints((function(point){return point.moveTo(path,offset)}))}},{key:"moveToAnchor",value:function moveToAnchor(){return this.setFocus(this.anchor)}},{key:"moveToEnd",value:function moveToEnd(){return this.setStart(this.end)}},{key:"moveToEndOfNode",value:function moveToEndOfNode(node){return this.updatePoints((function(point){return point.moveToEndOfNode(node)}))}},{key:"moveToFocus",value:function moveToFocus(){return this.setAnchor(this.focus)}},{key:"moveToRangeOfNode",value:function moveToRangeOfNode(start){var end=arguments.length>1&&void 0!==arguments[1]?arguments[1]:start,range=this.setPoints([this.anchor.moveToStartOfNode(start),this.focus.moveToEndOfNode(end)]);return range}},{key:"moveToStart",value:function moveToStart(){return this.setEnd(this.start)}},{key:"moveToStartOfNode",value:function moveToStartOfNode(node){return this.updatePoints((function(point){return point.moveToStartOfNode(node)}))}},{key:"normalize",value:function normalize(node){return this.updatePoints((function(point){return point.normalize(node)}))}},{key:"setAnchor",value:function setAnchor(anchor){return this.set("anchor",anchor)}},{key:"setEnd",value:function setEnd(point){return this.isBackward?this.setAnchor(point):this.setFocus(point)}},{key:"setFocus",value:function setFocus(focus){return this.set("focus",focus)}},{key:"setPoints",value:function setPoints(values){var _values=slicedToArray(values,2),anchor=_values[0],focus=_values[1];return this.set("anchor",anchor).set("focus",focus)}},{key:"updatePoints",value:function updatePoints(updater){var anchor=this.anchor,focus=this.focus;return anchor=updater(anchor),focus=updater(focus),this.merge({anchor,focus})}},{key:"setStart",value:function setStart(point){return this.isBackward?this.setFocus(point):this.setAnchor(point)}},{key:"setProperties",value:function setProperties(properties){var _properties=properties=Range.createProperties(properties),anchor=_properties.anchor,focus=_properties.focus,props=objectWithoutProperties(_properties,["anchor","focus"]);return anchor&&(props.anchor=Point.create(anchor)),focus&&(props.focus=Point.create(focus)),this.merge(props)}},{key:"toJSON",value:function toJSON(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},object={object:this.object,anchor:this.anchor.toJSON(options),focus:this.focus.toJSON(options)};return object}},{key:"toRange",value:function toRange(){var properties=Range.createProperties(this);return Range.create(properties)}},{key:"unset",value:function unset(){return this.updatePoints((function(p){return p.unset()}))}},{key:"isCollapsed",get:function get$$1(){return this.anchor===this.focus||this.anchor.key===this.focus.key&&this.anchor.offset===this.focus.offset}},{key:"isExpanded",get:function get$$1(){return!this.isCollapsed}},{key:"isBackward",get:function get$$1(){var isUnset=this.isUnset,anchor=this.anchor,focus=this.focus;return isUnset?null:anchor.key===focus.key?anchor.offset>focus.offset:PathUtils.isBefore(focus.path,anchor.path)}},{key:"isForward",get:function get$$1(){var isBackward=this.isBackward;return null==isBackward?null:!isBackward}},{key:"isUnset",get:function get$$1(){var anchor=this.anchor,focus=this.focus;return anchor.isUnset||focus.isUnset}},{key:"isSet",get:function get$$1(){return!this.isUnset}},{key:"start",get:function get$$1(){return this.isBackward?this.focus:this.anchor}},{key:"end",get:function get$$1(){return this.isBackward?this.anchor:this.focus}}]),RangeInterface}();mixin(RangeInterface,[Annotation,Decoration,Range,Selection])},"./node_modules/slate_legacy/node_modules/debug/src/browser.js":(module,exports,__webpack_require__)=>{"use strict";var process=__webpack_require__("./node_modules/process/browser.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}exports.log=function log(){var _console;return"object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&(_console=console).log.apply(_console,arguments)},exports.formatArgs=function formatArgs(args){if(args[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+args[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff),!this.useColors)return;var c="color: "+this.color;args.splice(1,0,c,"color: inherit");var index=0,lastC=0;args[0].replace(/%[a-zA-Z%]/g,(function(match){"%%"!==match&&(index++,"%c"===match&&(lastC=index))})),args.splice(lastC,0,c)},exports.save=function save(namespaces){try{namespaces?exports.storage.setItem("debug",namespaces):exports.storage.removeItem("debug")}catch(error){}},exports.load=function load(){var r;try{r=exports.storage.getItem("debug")}catch(error){}!r&&void 0!==process&&"env"in process&&(r=process.env.DEBUG);return r},exports.useColors=function useColors(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},exports.storage=function localstorage(){try{return localStorage}catch(error){}}(),exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],module.exports=__webpack_require__("./node_modules/slate_legacy/node_modules/debug/src/common.js")(exports),module.exports.formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}},"./node_modules/slate_legacy/node_modules/debug/src/common.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=function setup(env){function selectColor(namespace){for(var hash=0,i=0;i<namespace.length;i++)hash=(hash<<5)-hash+namespace.charCodeAt(i),hash|=0;return createDebug.colors[Math.abs(hash)%createDebug.colors.length]}function createDebug(namespace){var prevTime;function debug(){if(debug.enabled){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var self=debug,curr=Number(new Date),ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,args[0]=createDebug.coerce(args[0]),"string"!=typeof args[0]&&args.unshift("%O");var index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,(function(match,format){if("%%"===match)return match;index++;var formatter=createDebug.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match})),createDebug.formatArgs.call(self,args);var logFn=self.log||createDebug.log;logFn.apply(self,args)}}return debug.namespace=namespace,debug.enabled=createDebug.enabled(namespace),debug.useColors=createDebug.useColors(),debug.color=selectColor(namespace),debug.destroy=destroy,debug.extend=extend,"function"==typeof createDebug.init&&createDebug.init(debug),createDebug.instances.push(debug),debug}function destroy(){var index=createDebug.instances.indexOf(this);return-1!==index&&(createDebug.instances.splice(index,1),!0)}function extend(namespace,delimiter){return createDebug(this.namespace+(void 0===delimiter?":":delimiter)+namespace)}return createDebug.debug=createDebug,createDebug.default=createDebug,createDebug.coerce=function coerce(val){if(val instanceof Error)return val.stack||val.message;return val},createDebug.disable=function disable(){createDebug.enable("")},createDebug.enable=function enable(namespaces){var i;createDebug.save(namespaces),createDebug.names=[],createDebug.skips=[];var split=("string"==typeof namespaces?namespaces:"").split(/[\s,]+/),len=split.length;for(i=0;i<len;i++)split[i]&&("-"===(namespaces=split[i].replace(/\*/g,".*?"))[0]?createDebug.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):createDebug.names.push(new RegExp("^"+namespaces+"$")));for(i=0;i<createDebug.instances.length;i++){var instance=createDebug.instances[i];instance.enabled=createDebug.enabled(instance.namespace)}},createDebug.enabled=function enabled(name){if("*"===name[name.length-1])return!0;var i,len;for(i=0,len=createDebug.skips.length;i<len;i++)if(createDebug.skips[i].test(name))return!1;for(i=0,len=createDebug.names.length;i<len;i++)if(createDebug.names[i].test(name))return!0;return!1},createDebug.humanize=__webpack_require__("./node_modules/ms/index.js"),Object.keys(env).forEach((function(key){createDebug[key]=env[key]})),createDebug.instances=[],createDebug.names=[],createDebug.skips=[],createDebug.formatters={},createDebug.selectColor=selectColor,createDebug.enable(createDebug.load()),createDebug}},"./node_modules/slate_legacy/node_modules/direction/index.js":module=>{"use strict";var EXPRESSION_LEFT_TO_RIGHT,EXPRESSION_RIGHT_TO_LEFT;EXPRESSION_LEFT_TO_RIGHT=new RegExp("^[^֑-߿יִ-﷽ﹰ-ﻼ]*[A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿]"),EXPRESSION_RIGHT_TO_LEFT=new RegExp("^[^A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿]*[֑-߿יִ-﷽ﹰ-ﻼ]"),module.exports=function direction(value){return value=value.toString(),EXPRESSION_RIGHT_TO_LEFT.test(value)?"rtl":EXPRESSION_LEFT_TO_RIGHT.test(value)?"ltr":"neutral"}}}]);